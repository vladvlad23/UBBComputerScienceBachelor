0	Parse Tree	View	-519	32767	6	4	1	4	22	251	0	1	1024	0	0	0	0	0	2652	"CREATE VIEW sys.column_store_dictionaries
AS
	SELECT d.hobt_id as partition_id,
		d.hobt_id,
		c.rscolid as column_id,
		d.dictionary_id,
		d.version,
		d.type,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then d.last_id else NULL end) as last_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then d.entry_count else NULL end) as entry_count,
		d.on_disk_size
	FROM sys.syscsdictionaries d
	INNER JOIN sys.sysrowsets p ON d.hobt_id = p.rowsetid
	INNER JOIN sys.sysrscols c ON d.hobt_id = c.rsid and d.column_id = c.hbcolid
	WHERE has_access('CO', p.idmajor) = 1
	
	UNION ALL

	SELECT dict.partition_id,
		dict.hobt_id,
		dict.column_id,
		dict.dictionary_id,
		dict.version,
		dict.type,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(dict.object_id) + '.' + OBJECT_NAME(dict.object_id), 'OBJECT', 'SELECT') = 1 then dict.last_id else NULL end) as last_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(dict.object_id) + '.' + OBJECT_NAME(dict.object_id), 'OBJECT', 'SELECT') = 1 then dict.entry_count else NULL end) as entry_count,		
		dict.on_disc_size
	FROM OpenRowset(TABLE HKCS_DICTIONARIES) dict
	WHERE has_access('CO', dict.object_id) = 1
"
1	Parse Tree	View	-150	32767	6	4	1	2	14	251	0	1	1024	0	0	0	0	0	2164	"CREATE VIEW sys.system_parameters$ AS
	SELECT id AS object_id,
		number,
		name collate catalog_default AS name,
		colid AS parameter_id,
		xtype AS system_type_id,
		utype AS user_type_id,
		length AS max_length,
		prec AS precision, scale,
		sysconv(bit, status & 512) AS is_output,
		sysconv(bit, status & 1024) AS is_cursor_ref,
		sysconv(bit, 0) AS has_default_value,
		sysconv(bit, 0) AS is_xml_document,
		convert(sql_variant, null) AS default_value,
		sysconv(int, 0) AS xml_collection_id,
		sysconv(bit, 0) AS is_readonly,
		sysconv(bit, 1 - (status & 1)) AS is_nullable,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) as column_encryption_key_database_name
	FROM sys.syscolpars
	WHERE number > 0 AND (status & 4096) = 4096
		AND (serverproperty('EngineEdition') != 5 OR (status & 0x08000000) != 0)
"
11	Parse Tree	View	-461	32767	6	4	1	20	8	251	0	1	1024	0	0	0	0	0	750	"CREATE VIEW sys.routes AS
	SELECT name,
		route_id = id,
		principal_id = p.indepid,
		remote_service_name = remsvc,
		broker_instance = brkrinst,
		lifetime,
		address = addr,
		mirror_address = miraddr
	FROM sys.sysrts r
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = r.id AND p.class = 49 AND p.depsubid = 0	-- SRC_ROUTEOWNER
	WHERE has_access('RT', r.id) = 1
"
15	Parse Tree	View	-808834573	32767	6	4	1	2	2	251	0	1	1024	0	0	0	0	0	214	"CREATE VIEW sys.dm_tran_current_snapshot AS
	SELECT * 
	FROM OpenRowset(TABLE DM_TRAN_CURRENT_SNAPSHOT)
"
22	Parse Tree	View	-403	32767	6	4	1	2	12	251	0	1	1024	0	0	0	0	0	1536	"CREATE VIEW sys.stats_columns AS
	SELECT s.idmajor AS object_id,
		s.idminor AS stats_id,
		s.subid AS stats_column_id,
		s.intprop AS column_id
	FROM sys.sysiscols s
	WHERE (s.status & 1)  = 1			-- ISC_STATS_COL
		AND has_access('CO', s.idmajor) = 1 
		AND s.idminor NOT IN 
        (
            SELECT t.valnum as stats_id
            FROM tempstatvals t
            WHERE t.valnum < 0x40000
                AND t.subobjid = s.idmajor
        )
    UNION ALL
    SELECT	t.subobjid as object_id,
    		t.valnum as stats_id,
    		v.stats_column_id,
    		v.column_id
    FROM	tempstatvals t   
    		outer apply 
    		OpenRowset(TABLE TEMPSTATS, t.objid, t.subobjid, t.valnum, convert(bit, 1)) v
    WHERE 	has_access('CO', t.subobjid) = 1 
"
23	Parse Tree	View	-749469736	32767	6	4	1	3	6	251	0	1	1024	0	0	0	0	0	288	"
-- add it
create view sys.dm_pdw_nodes_os_buffer_descriptors as
select *, convert(int, null) pdw_node_id from sys.dm_os_buffer_descriptors
"
23	Parse Tree	View	-431797115	32767	6	4	1	5	6	251	0	1	1024	0	0	0	0	0	260	"
-- add it
create view sys.dm_pdw_nodes_clr_appdomains as
select *, convert(int, null) pdw_node_id from sys.dm_clr_appdomains
"
40	Parse Tree	View	-122239902	32767	6	3	1	23	17	251	0	1	1024	0	0	0	0	0	2034	"CREATE VIEW INFORMATION_SCHEMA.COLUMN_PRIVILEGES
AS
SELECT
	USER_NAME(p.grantor_principal_id)	AS GRANTOR,
	USER_NAME(p.grantee_principal_id)	AS GRANTEE,
	DB_NAME()						AS TABLE_CATALOG,
	SCHEMA_NAME(o.schema_id)			AS TABLE_SCHEMA,
	o.name							AS TABLE_NAME,
	c.name							AS COLUMN_NAME,
	convert(varchar(10), CASE p.type
		WHEN 'SL' THEN 'SELECT'
		WHEN 'UP' THEN 'UPDATE'
		WHEN 'RF' THEN 'REFERENCES'
		END)						AS PRIVILEGE_TYPE,
	convert(varchar(3), CASE p.state
		WHEN 'G' THEN 'NO'
		WHEN 'W' THEN 'YES'
		END)						AS IS_GRANTABLE
FROM
    sys.database_permissions p,
    sys.objects o,
    sys.columns c
WHERE
    o.type IN ('U', 'V')
    AND o.object_id = c.object_id
    AND p.class = 1
    AND p.major_id = o.object_id
    AND p.minor_id = c.column_id
    AND p.type IN ('RF','SL','UP')
    AND p.state IN ('G', 'W')
    AND (p.grantee_principal_id = 0
    	OR p.grantee_principal_id = DATABASE_PRINCIPAL_ID()
    	OR p.grantor_principal_id = DATABASE_PRINCIPAL_ID())
"
54	Parse Tree	View	-598	32767	6	4	1	16	9	251	0	1	1024	0	0	0	0	0	1296	"
CREATE VIEW sys.database_automatic_tuning_options AS
SELECT
	adv_opt.advisor_name AS name,
	adv_opt.desired_state,
	spn_des.name AS desired_state_desc,
	adv_opt.actual_state,
	spn_act.name AS actual_state_desc,
	adv_opt.reason,
	spv.name AS reason_desc
FROM
	OpenRowset(TABLE DATABASE_AUTOMATIC_TUNING_ADVISOR_OPTIONS) AS adv_opt
LEFT JOIN sys.syspalnames AS spn_des
	ON spn_des.class = 'ATAT' AND adv_opt.desired_state = spn_des.value
LEFT JOIN sys.syspalnames AS spn_act
	ON spn_act.class = 'ATAT' AND adv_opt.actual_state = spn_act.value
LEFT JOIN sys.syspalvalues AS spv
	ON spv.class = 'ATDR' AND adv_opt.reason = spv.value
"
55	Parse Tree	View	-229	32767	6	4	1	15	16	251	0	1	1024	0	0	0	0	0	1598	"CREATE VIEW sys.via_endpoints AS
	SELECT e.name,
		e.id AS endpoint_id,
		o.indepid AS principal_id,
		e.protocol, p.name AS protocol_desc,
		e.type, t.name AS type_desc,
		convert(tinyint, e.bstat & 3) AS state,	-- BSTAT_STATEMASK
		s.name AS state_desc,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		e.site AS discriminator
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	WHERE e.protocol = 5
		AND has_access('HE', e.id) = 1
"
59	Parse Tree	View	-180698920	32767	6	4	1	21	9	251	0	1	1024	0	0	0	0	0	1344	"
-- add it
create view sys.dm_exec_dms_workers as
select
	execution_id	collate database_default execution_id,
	step_index,
	dms_step_index,
	compute_node_id,
	distribution_id,
	type	collate database_default type,
	status	collate database_default status,
	bytes_per_sec,
	bytes_processed,
	rows_processed,
	start_time,
	end_time,
	total_elapsed_time,
	cpu_time,
	query_time,
	buffers_available,
	dms_cpid,
	sql_spid,
	error_id	collate database_default error_id,
	source_info	collate database_default source_info,
	destination_info	collate database_default destination_info,
	command	collate database_default command
from sys._dm_exec_dms_workers
"
65	Parse Tree	View	-540	32767	6	4	1	4	65	251	0	1	1024	0	0	0	0	0	10958	"CREATE VIEW sys.query_store_runtime_stats AS
	SELECT
		runtime_stats_id,
		plan_id,
		runtime_stats_interval_id,
		execution_type,
		n.name as execution_type_desc,
		first_execution_time,
		last_execution_time,
		count_executions,
		avg_duration,
		last_duration,
		min_duration,
		max_duration,
		CASE WHEN sqdiff_duration >= 0 THEN sqrt(sqdiff_duration) ELSE NULL END as stdev_duration,
		avg_cpu_time,
		last_cpu_time,
		min_cpu_time,
		max_cpu_time,
		CASE WHEN sqdiff_cpu_time >= 0 THEN sqrt(sqdiff_cpu_time) ELSE NULL END as stdev_cpu_time,
		avg_logical_io_reads,
		last_logical_io_reads,
		min_logical_io_reads,
		max_logical_io_reads,
		CASE WHEN sqdiff_logical_io_reads >= 0 THEN sqrt(sqdiff_logical_io_reads) ELSE NULL END as stdev_logical_io_reads,
		avg_logical_io_writes,
		last_logical_io_writes,
		min_logical_io_writes,
		max_logical_io_writes,
		CASE WHEN sqdiff_logical_io_writes >= 0 THEN sqrt(sqdiff_logical_io_writes) ELSE NULL END as stdev_logical_io_writes,
		avg_physical_io_reads,
		last_physical_io_reads,
		min_physical_io_reads,
		max_physical_io_reads,
		CASE WHEN sqdiff_physical_io_reads >= 0 THEN sqrt(sqdiff_physical_io_reads) ELSE NULL END as stdev_physical_io_reads,
		avg_clr_time,
		last_clr_time,
		min_clr_time,
		max_clr_time,
		CASE WHEN sqdiff_clr_time >= 0 THEN sqrt(sqdiff_clr_time) ELSE NULL END as stdev_clr_time,
		avg_dop,
		last_dop,
		min_dop,
		max_dop,
		CASE WHEN sqdiff_dop >= 0 THEN sqrt(sqdiff_dop) ELSE NULL END as stdev_dop,
		avg_query_max_used_memory,
		last_query_max_used_memory,
		min_query_max_used_memory,
		max_query_max_used_memory,
		CASE WHEN sqdiff_query_max_used_memory >= 0 THEN sqrt(sqdiff_query_max_used_memory) ELSE NULL END as stdev_query_max_used_memory,
		avg_rowcount,
		last_rowcount,
		min_rowcount,
		max_rowcount,
		CASE WHEN sqdiff_rowcount >= 0 THEN sqrt(sqdiff_rowcount) ELSE NULL END as stdev_rowcount,
		avg_num_physical_io_reads,
		last_num_physical_io_reads,
		min_num_physical_io_reads,
		max_num_physical_io_reads,
		CASE WHEN sqdiff_num_physical_io_reads >= 0 THEN sqrt(sqdiff_num_physical_io_reads) ELSE NULL END as stdev_num_physical_io_reads,
		avg_log_bytes_used,
		last_log_bytes_used,
		min_log_bytes_used,
		max_log_bytes_used,
		CASE WHEN sqdiff_log_bytes_used >= 0 THEN sqrt(sqdiff_log_bytes_used) ELSE NULL END as stdev_log_bytes_used,
		avg_tempdb_space_used,
		last_tempdb_space_used,
		min_tempdb_space_used,
		max_tempdb_space_used,
		CASE WHEN sqdiff_tempdb_space_used >= 0 THEN sqrt(sqdiff_tempdb_space_used) ELSE NULL END as stdev_tempdb_space_used
	FROM
	(
		SELECT
		*,
		round( convert(float, sumsquare_duration) / count_executions - avg_duration * avg_duration,2) as sqdiff_duration,
		round( convert(float, sumsquare_cpu_time) / count_executions  - avg_cpu_time * avg_cpu_time,2) as sqdiff_cpu_time,
		round( convert(float, sumsquare_logical_io_reads) / count_executions - avg_logical_io_reads * avg_logical_io_reads,2) as sqdiff_logical_io_reads,
		round( convert(float, sumsquare_logical_io_writes) / count_executions - avg_logical_io_writes * avg_logical_io_writes,2) as sqdiff_logical_io_writes,
		round( convert(float, sumsquare_physical_io_reads) / count_executions - avg_physical_io_reads * avg_physical_io_reads,2) as sqdiff_physical_io_reads,
		round( convert(float, sumsquare_clr_time) / count_executions - avg_clr_time * avg_clr_time,2) as sqdiff_clr_time,
		round( convert(float, sumsquare_dop) / count_executions - avg_dop * avg_dop,2) as sqdiff_dop,
		round( convert(float, sumsquare_query_max_used_memory) / count_executions - avg_query_max_used_memory * avg_query_max_used_memory,2) as sqdiff_query_max_used_memory,
		round( convert(float, sumsquare_rowcount) / count_executions - avg_rowcount * avg_rowcount,2) as sqdiff_rowcount,
		round( convert(float, sumsquare_num_physical_io_rea"
67	Parse Tree	View	-229834826	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	192	"
CREATE VIEW sys.trusted_assemblies AS
	SELECT *
	FROM OpenRowSet(TABLE TRUSTED_ASSEMBLIES)
"
73	Parse Tree	View	-181465060	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	268	"
-- add it
create view sys.dm_pdw_nodes_os_cluster_nodes as
select *, convert(int, null) pdw_node_id from sys.dm_os_cluster_nodes
"
76	Parse Tree	View	-482	32767	6	4	1	2	7	251	0	1	1024	0	0	0	0	0	552	"CREATE VIEW sys.fulltext_index_catalog_usages AS
	SELECT r.depid AS object_id,
		f.indid AS index_id,
		r.indepid AS fulltext_catalog_id
	FROM sys.syssingleobjrefs r
	LEFT JOIN sys.sysftinds f ON f.id = r.depid
	WHERE r.class = 39 AND r.depsubid = 0 -- SRC_FTITABTOCAT
"
81	Parse Tree	View	-432635041	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	234	"CREATE VIEW sys.dm_tran_transactions_snapshot AS
	SELECT * 
	FROM OpenRowset(TABLE DM_TRAN_TRANSACTIONS_SNAPSHOT)
"
86	Parse Tree	View	-69842288	32767	1	4	1	3	3	251	0	1	1024	0	0	0	0	0	308	"CREATE FUNCTION sys.dm_exec_plan_attributes(@handle varbinary(64))
RETURNS TABLE
AS
	RETURN SELECT * FROM OPENROWSET(TABLE FNGETPLANATTRIBS, @handle)
"
87	Parse Tree	View	-424	32767	6	4	1	23	19	251	0	1	1024	0	0	0	0	0	2960	"CREATE VIEW sys.assembly_types AS
	SELECT t.name,
		t.xtype AS system_type_id,
		t.id AS user_type_id,
		t.schid AS schema_id,
		pr.indepid AS principal_id,
		t.length AS max_length,
		t.prec AS precision,
		t.scale,
		convert(sysname, collationpropertyfromid(t.collationid, 'name')) AS collation_name,
		sysconv(bit, 1 - (t.status & 1)) AS is_nullable,	-- COL80_NOTNULL
		sysconv(bit, case when t.id > 256 then 1 else 0 end) AS is_user_defined, 	-- x_utypSSNAME
		sysconv(bit, 1) AS is_assembly_type,
		sysconv(int, 0) AS default_object_id,
		sysconv(int, 0) AS rule_object_id,
		r.indepid AS assembly_id,
		convert(sysname, v.name) collate Latin1_General_BIN AS assembly_class,
		sysconv(bit, typepropertyex(t.id,'is_binary_ordered')) AS is_binary_ordered,
		sysconv(bit, typepropertyex(t.id,'is_fixed_length')) AS is_fixed_length,
		convert(nvarchar(40), typepropertyex(t.id,'prog_id')) AS prog_id,
		convert(nvarchar(4000), typepropertyex(t.id,'assembly_qualified_name')) collate Latin1_General_BIN AS assembly_qualified_name,
		sysconv(bit, 0) AS is_table_type
	FROM sys.sysscalartypes t
	JOIN sys.syssingleobjrefs r ON r.depid = t.id AND r.class = 38 AND r.depsubid = 0	-- SRC_TYPETOASM
	LEFT JOIN sys.syssingleobjrefs pr ON pr.depid = t.id AND pr.class = 44 AND pr.depsubid = 0	-- SRC_TYPETOOWNER
	LEFT JOIN sys.sysbinsubobjs v ON v.class = 11 AND v.idmajor = r.indepid AND v.subid = t.id  	-- SOC_ASSEMBLY_TYPE
	WHERE has_access('UT', t.id) = 1
"
98	Parse Tree	View	-816717056	32767	6	4	1	4	6	251	0	1	1024	0	0	0	0	0	268	"
-- add it
create view sys.dm_pdw_nodes_os_memory_clerks as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_clerks
"
99	Parse Tree	View	-42590756	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	202	"CREATE VIEW sys.dm_tran_version_store AS
	SELECT *	
	FROM OpenRowset(TABLE DM_TRAN_VERSION_STORE)
"
99	Parse Tree	View	-675193454	32767	6	4	1	7	3	251	0	1	1024	0	0	0	0	0	180	"CREATE VIEW sys.dm_os_ring_buffers AS
	SELECT *
	FROM OpenRowset(TABLE SYSRINGBUFFERS)
"
101	Parse Tree	View	-245612491	32767	6	4	1	5	6	251	0	1	1024	0	0	0	0	0	300	"
-- add it
create view sys.dm_pdw_nodes_database_encryption_keys as
select *, convert(int, null) pdw_node_id from sys.dm_database_encryption_keys
"
106	Parse Tree	View	-270688537	32767	6	4	1	3	16	251	0	1	1024	0	0	0	0	0	2476	"CREATE VIEW sys.conversation_endpoints$ AS
	SELECT conversation_handle = s.handle,
		conversation_id = s.diagid,
		is_initiator = sysconv(bit, s.initiator),
		service_contract_id = r.contract,
		conversation_group_id = r.convgroup,
		service_id = r.svcid,
		lifetime = r.lifetime,
		state = r.state,
		state_desc = i.name,
		far_service = r.farsvc,
		far_broker_instance = r.farbrkrinst,
		principal_id = r.princid,
		far_principal_id = r.farprincid,
		outbound_session_key_identifier = r.outseskeyid,
		inbound_session_key_identifier = r.inseskeyid,
		security_timestamp = r.dlgopened,
		dialog_timer = r.dlgtimer,
		send_sequence = s.sendseq,
		last_send_tran_id = s.sendxact,
		end_dialog_sequence = r.enddlgseq,
		receive_sequence = r.rcvseq,
		receive_sequence_frag = r.rcvfrag,
		system_sequence = r.sysseq,
		first_out_of_order_sequence = r.firstoorder,
		last_out_of_order_sequence = r.lastoorder,
		last_out_of_order_frag = r.lastoorderfr,
		is_system = sysconv(bit, r.status & 1),
		priority = r.priority
	FROM sys.sysdesend s
	JOIN sys.sysdercv r ON r.handle = s.handle AND r.diagid = s.diagid AND r.initiator = s.initiator
	LEFT JOIN sys.syspalnames i ON i.class = 'CEST' AND i.value = r.state
"
106	Parse Tree	View	-520081761	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	240	"
-- add it
create view sys.dm_pdw_nodes_clr_tasks as
select *, convert(int, null) pdw_node_id from sys.dm_clr_tasks
"
109	Parse Tree	View	-397721966	32767	6	4	1	2	9	251	0	1	1024	0	0	0	0	0	802	"CREATE VIEW sys.services$ AS
	SELECT o.name,
		service_id = o.id,
		principal_id = p.indepid,
		service_queue_id = r.indepid
	FROM sys.sysbinobjs o
	JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 21 AND r.depsubid = 0	-- SRC_SVCTOQUEUE
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 55 AND p.depsubid = 0	-- SRC_SERVICEOWNER
	WHERE o.class = 23 AND o.nsid = 0
"
112	Parse Tree	View	-577292593	32767	6	4	1	3	372	251	0	1	1024	0	0	0	0	0	17076	"create view sys.dm_database_plan_correction_recommendations as

	with expand_is_last as (
		select *, 
		is_last_event = iif(row_number() over(partition by query_id order by event_time desc)=1, 1, 0)
		from OpenRowset(TABLE APRC_EVENT)
	)
	, expand_status as (
		select *
		, status = (select case 
			when e.event_type = 1 and e.regression_corrected = 0 then 'Active'
			when e.event_type = 3 and e.current_plan_id = x.baseline_plan_id then 'Success'
			when e.event_type = 1 and e.regression_corrected = 1 and e.validation_enabled = 0 then 'Success'
			when e.event_type = 1 and e.regression_corrected = 1 and e.validation_enabled = 1 then 'Verifying'
			when e.event_type = 2 and e.backoff_reason in (1,2,10,11,12,13,14,15) then 'Expired'
			when e.event_type = 3 and e.current_plan_id <> x.baseline_plan_id then 'Expired'
			when e.event_type = 2 and e.backoff_reason not in (1,2,10,11,12,13,14,15) then 'Reverted'
			when e.event_type = 4 then 'Reverted'
			when e.event_type = 5 and e.backoff_reason in (8,9)  then 'Reverted'
			when e.event_type = 5 and e.backoff_reason = 0 then 'Success'
			else 'Expired' end
			from expand_is_last e where e.query_id = x.query_id and e.is_last_event = 1)
		from expand_is_last x
	)
	, aprc_events as (
		select *
		, valid_since = (select min(e.event_time) from expand_status e where e.query_id = x.query_id and e.event_type = 1)
		, last_refresh = (select max(e.event_time) from expand_status e where e.query_id = x.query_id and e.event_type = 1)
		, execute_action_start_time = (select max(e.event_time) from expand_status e where e.query_id = x.query_id and ((e.event_type = 1 and e.regression_corrected = 1) or e.event_type = 3) )
		, revert_action_start_time = (select max(e.event_time) from expand_status e where e.query_id = x.query_id and e.event_type IN (2,4))
		-- If event_type is 3 (Forced) or 4 (Unforced) then User has initiated the action.
		, initiated_by = (select iif(e.status = 'Success' or e.status = 'Verifying', iif(e.event_type in (3,4), 'User', 'System'), null) from expand_status e where e.query_id = x.query_id and e.is_last_event = 1)
		, reverted_by = (select iif(e.status = 'Reverted', iif(e.event_type in (3,4), 'User', 'System'), null) from expand_status e where e.query_id = x.query_id and e.is_last_event = 1)
		, status_reason_str = (
			select case
			/* 
			Event types						Back off reasons
			1 - Detection/Correction		 0 - x_backOffNoBackOff
			2 - Back off					 1 - x_backOffSchemaChanged
			3 - User forced plan			 2 - x_backOffStatisticsChanged
			4 - User unforced plan			 3 - x_backOffForcingFailed
			5 - Validation completed		 4 - x_backOffOptionRecompile
											 5 - x_backOffPlanLoadFailed
											 6 - x_backOffAutomaticTuningOptionDisabled
											 7 - x_backOffUnsupportedStatementType
											 8 - x_backOffVerificationAborted
											 9 - x_backOffVerificationForcedQueryRecompile
											 10- x_backOffTempTableChanged
											 11- x_backOffDatabaseVersionChanged
											 12- x_backOffBrowsePermissionChanged
											 13- x_backOffParametrizedPlanFlushed
											 14- x_backOffRemoteRowsetChanged
											 15- x_backOffMpiViewChanged
			*/
			when e.event_type = 2 and e.backoff_reason = 1 then 'SchemaChanged'
			when e.event_type = 2 and e.backoff_reason = 2 then 'StatisticsChanged'
			when e.event_type = 2 and e.backoff_reason = 3 then 'ForcingFailed'
			when e.event_type = 2 and e.backoff_reason = 4 then 'OptionRecompile'
			when e.event_type = 2 and e.backoff_reason = 5 then 'PlanLoadFailed'
			when e.event_type = 2 and e.backoff_reason = 6 then 'AutomaticTuningOptionDisabled'
			when e.event_type = 2 and e.backoff_reason = 7 then 'UnsupportedStatementType'
			when e.event_type = 2 and e.backoff_reason = 10 then 'TempTableChanged'
			when e.event_type = 2 and e.backoff_reason = 11 then 'Da"
118	Parse Tree	View	-443856819	32767	6	4	1	1	4	251	0	1	1024	0	0	0	0	0	272	"
-- add it
create view sys.dm_pdw_nodes_os_spinlock_stats as
select *, convert(int, null) pdw_node_id from sys.dm_os_spinlock_stats
"
120	Parse Tree	View	-250	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	644	"CREATE VIEW sys.server_event_session_fields AS
	SELECT 
		event_session_id = v.objid,
		object_id		 = v.subobjid,
		name			 = convert(sysname, v.imageval) collate catalog_default,
		value			 = v.value
	FROM master.sys.sysobjvalues v
	WHERE v.valclass = 59 		 -- SVC_XE_SESSION_FIELD
	AND has_access ('ES', 0) = 1
"
122	Parse Tree	View	-382525183	32767	6	4	1	6	12	251	0	1	1024	0	0	0	0	0	244	"
-- add it
create view sys.dm_pdw_nodes_os_workers as
select *, convert(int, null) pdw_node_id from sys.dm_os_workers
"
130	Parse Tree	View	-561	32767	6	4	1	8	6	251	0	1	1024	0	0	0	0	0	830	"CREATE VIEW sys.periods AS
	SELECT 
		convert(sysname, v.value) collate catalog_default as name,
		convert(tinyint, 1) as period_type,
		convert(nvarchar(60), 'SYSTEM_TIME_PERIOD') collate Latin1_General_CI_AS_KS_WS as period_type_desc,
		v.objid as object_id,
		v.subobjid as start_column_id,
		v.valnum as end_column_id
	FROM sys.sysobjvalues v
	WHERE v.valclass = 113 AND has_access('CO', v.objid) = 1
"
130	Parse Tree	View	-596345951	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	570	"
-- add it
create view sys.pdw_loader_run_stages as
select
	run_id,
	stage	collate database_default stage,
	request_id	collate database_default request_id,
	status	collate database_default status,
	start_time,
	end_time,
	total_elapsed_time
from sys._pdw_loader_run_stages
"
131	Parse Tree	View	-192	32767	6	4	1	8	16	251	0	1	1024	0	0	0	0	0	1996	"CREATE VIEW sys.sysaltfiles AS
	SELECT fileid = convert(smallint, f.fileid & 0x7fff),
		groupid = convert(smallint, f.grpid),
		f.size, f.maxsize, f.growth,
		status = convert(int,
					case f.filetype when 1 then 66 else 2 end   -- x_eft_SQLLog, FCB_LOG_DEVICE, FCB_DSK_DEVICE
					+ (f.status & 8) * 2 -- FCB_READONLY_MEDIA
					+ (f. status & 16) * 256 -- FCB_READONLY
					+ case when f.filestate in (1, 2, 3, 6) then 268435456 else 0 end -- OFFLINE, FCB_OFFLINE
					+ (f.status & 256) * 2097152 -- FCB_SPARSE_FILE
					+ (f.status & 32) * 32768 -- FCB_PERCENT_GROWTH
					+ (f.status & 2048) / 2048), -- FCB_PMM_METADATA
		perf = convert(int, 0),
		dbid = convert(smallint, f.dbid),
		name = f.lname,
		CASE WHEN SERVERPROPERTY('pathseparator') = '/' THEN CAST (replace(f.pname,'C:\binn\', '') AS nvarchar(260)) 
		ELSE f.pname END AS filename
	FROM sys.sysbrickfiles f
	WHERE f.filetype IN (0, 1) AND has_access('MF', 1) = 1 -- x_eft_SQLData, x_eft_SQLLog (bwkcmpt types)
"
136	Compiled Plan	Adhoc	103396615	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.change_tracking_tables t
136	Compiled Plan	Adhoc	103396615	6	0	-2	2	2	18	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.change_tracking_tables t
141	Parse Tree	View	-503	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	454	"CREATE VIEW sys.fulltext_index_fragments AS
	SELECT cprelid as table_id, fragid as fragment_id, fragobjid as fragment_object_id, ts as timestamp, status, datasize as data_size, rowcnt as row_count
	FROM sys.syscompfragments
"
142	Parse Tree	View	-134	32767	6	4	1	2	34	251	0	1	1024	0	0	0	0	0	5744	"CREATE VIEW sys.sysindexes AS
	SELECT i.id,
		status = convert(int,
			case i.indid when 1 then 16 else 0 end	-- (is_clustered * 16)
			+ (i.status & 8)/4		-- IS_IND_UNIQUE (is_unique * 2)
			+ (i.status & 4)/4		-- IS_IND_DPKEYS (ignore_dup_key * 1)
			+ (i.status & 32)*64	-- IS_IND_PRIMARY (is_primary_key * 2048)
			+ (i.status & 64)*64	-- IS_IND_UNIQUE_CO (is_unique_constraint * 4096)
			+ (i.status & 16)*16	-- IS_IND_PADINDEX (is_padded * 256)
			+ (i.status & 256)/8		-- IS_IND_ITWINDEX (is_hypothetical * 32)
			+ (1-(i.status & 1))*64	-- IS_INDEX
			+ (i.status & 8192)*1024	-- IS_STATS_AUTO_CRT (auto_created * 0x800000)
			+ (i.status & 16384)*1024),	-- IS_STATS_NORECOMP (no_recompute * 0x1000000)
		first = case when i.rowset > 0 then p.first end,
		indid = convert(smallint, i.indid),
		root = case when i.rowset > 0 then p.root end,
		minlen = convert(smallint, case when i.status & 1 = 0 then 0 else indexproperty(i.id, i.name, 'minlen') end),
		keycnt = convert(smallint, indexproperty(i.id, i.name, 'keycnt80')),
		groupid = convert(smallint, case
			when (i.status & 1) = 0 then 0
			when (i.status & 256) <> 0 then 0
			when d.indepid is null then 1
			when d.indepid < 32768 then d.indepid end),
		dpages = convert(int, case when i.status & 1 = 0 then 0 else p.data_pages end),
		reserved = convert(int, case when i.status & 1 = 0 then 0 else p.total_pages end),
		used = convert(int, case when i.status & 1 = 0 then 0 else p.used_pages end),
		rowcnt = convert(bigint, case when i.status & 1 = 0 then 0 else p.rows end),
		rowmodctr = convert(int, indexproperty(i.id, i.name, 'rowmodcnt80')),
		reserved3 = convert(tinyint, 0),
		reserved4 = convert(tinyint, 0),
		xmaxlen = convert(smallint, case when i.status & 1 = 0 then 0 else indexproperty(i.id, i.name, 'maxlen') end),
		p.maxirow,
		OrigFillFactor = convert(tinyint, (i.status & 1)*fillfact),	-- fill_factor
		StatVersion = convert(tinyint, 0),
		reserved2 = convert(int, 0),
		FirstIAM = case when i.rowset > 0 then p.FirstIAM end,
		impid = convert(smallint, 0),
		lockflags = convert(smallint, (i.status & 512)/512 + (i.status & 1024)/512),	-- no_row_locks + no_page_locks*2
		pgmodctr = convert(int, 0),
		keys = convert(varbinary(1088), null),
		name = i.name,
		statblob = convert (image, null),
		maxlen = convert(int, 8000),
		rows = convert(int,  case when i.status & 1 = 0 then 0 else 0x7FFFFFFF & p.rows end)
	FROM sys.sysidxstats i OUTER APPLY OpenRowset(TABLE INDEXPROP, i.id, i.indid, i.rowset) p
	LEFT JOIN sys.syssingleobjrefs d ON d.depid = i.id AND d.class = 7 AND d.depsubid = i.indid	-- SRC_INDEXTODS	
	INNER JOIN sys.sysschobjs$ obj ON obj.id = i.id
	WHERE i.indid < 256000
		AND has_access('CO', i.id) = 1
		AND obj.status2 & 0x00000008 = 0		-- OBJTAB2_HEKATON
		AND (i.status & 0x04000000) = 0			-- !IS_IND_RESUMABLE
"
144	Parse Tree	View	-979629760	32767	6	4	1	24	17	251	0	1	1024	0	0	0	0	0	2072	"CREATE VIEW sys.dm_exec_requests AS
	SELECT 
		session_id, request_id, start_time, status, command, 
		sql_handle, statement_start_offset, statement_end_offset, plan_handle, database_id, 
		user_id, connection_id, blocking_session_id, wait_type, wait_time, 
		last_wait_type, wait_resource, open_transaction_count, open_resultset_count, transaction_id,
		context_info, percent_complete, estimated_completion_time, cpu_time, total_elapsed_time,
		scheduler_id, task_address, reads, writes, logical_reads, text_size,
		language, date_format, date_first, quoted_identifier, arithabort,
		ansi_null_dflt_on, ansi_defaults, ansi_warnings, ansi_padding, ansi_nulls,
		concat_null_yields_null, transaction_isolation_level, lock_timeout, deadlock_priority, row_count,
		prev_error, nest_level, granted_query_memory, executing_managed_code, group_id, query_hash, query_plan_hash, statement_sql_handle, statement_context_id,
		dop, parallel_worker_count, external_script_request_id, is_resumable
	FROM OpenRowset(TABLE SYSREQUESTS)
"
144	Parse Tree	View	-666781024	32767	6	3	1	29	8	251	0	1	1024	0	0	0	0	0	904	"CREATE VIEW INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS
AS
SELECT
	DB_NAME()			AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(o.schema_id)	AS CONSTRAINT_SCHEMA,
	o.name				AS CONSTRAINT_NAME,
	DB_NAME()			AS DOMAIN_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS DOMAIN_SCHEMA,
	t.name				AS DOMAIN_NAME,
	'NO'				AS IS_DEFERRABLE,
	'NO'				AS INITIALLY_DEFERRED
FROM
	sys.types t
	JOIN sys.objects o ON o.object_id = t.rule_object_id
WHERE
	t.user_type_id > 256
"
147	Parse Tree	View	-588755688	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	206	"CREATE VIEW sys.dm_server_memory_dumps AS
	SELECT *
	FROM OpenRowset(TABLE DM_SERVER_MEMORY_DUMPS) 
"
149	Parse Tree	View	-811139055	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	206	"CREATE VIEW sys.dm_logpool_hashentries AS
	SELECT * 
	FROM OpenRowSet(TABLE DM_LOGPOOL_HASHENTRIES)
"
152	Parse Tree	View	-445	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	426	"CREATE VIEW sys.service_contract_usages AS
	SELECT service_id = depid,
		service_contract_id = indepid
	FROM sys.sysmultiobjrefs
	WHERE class = 19 AND depsubid = 0 AND indepsubid = 0	--MRC_SVC_CONTRACT_USAGE
"
163	Parse Tree	View	-387	32767	6	4	1	15	10	187	0	1	1024	0	0	0	0	0	838	"CREATE VIEW sys.views AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc,
		create_date, modify_date,
		is_ms_shipped, is_published, is_schema_published,
		is_replicated, has_replication_filter, has_opaque_metadata,
		has_unchecked_assembly_data, with_check_option,
		is_auto_dropped as is_date_correlation_view,
		is_tracked_by_cdc
	FROM sys.objects$
	WHERE type = 'V'
"
170	Parse Tree	View	-266402733	32767	6	3	1	10	5	251	0	1	1024	0	0	0	0	0	536	"CREATE VIEW INFORMATION_SCHEMA.CHECK_CONSTRAINTS
AS
SELECT
	DB_NAME()						AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(schema_id)			AS CONSTRAINT_SCHEMA,
	name							AS CONSTRAINT_NAME,
	convert(nvarchar(4000), definition)	AS CHECK_CLAUSE
FROM
	sys.check_constraints
"
177	Parse Tree	View	-151215274	32767	6	4	1	9	10	251	0	1	1024	0	0	0	0	0	162	"CREATE VIEW sys.dm_os_workers AS
	SELECT *
	FROM OpenRowSet(TABLE SYSWORKERS)
"
190	Parse Tree	View	-497551896	32767	6	4	1	27	8	251	0	1	1024	0	0	0	0	0	1352	"
-- add it
create view sys.pdw_loader_backup_runs as
select
	run_id,
	name	collate database_default name,
	submit_time,
	start_time,
	end_time,
	total_elapsed_time,
	operation_type	collate database_default operation_type,
	mode	collate database_default mode,
	database_name	collate database_default database_name,
	table_name	collate database_default table_name,
	principal_id,
	session_id	collate database_default session_id,
	request_id	collate database_default request_id,
	status	collate database_default status,
	progress,
	command	collate database_default command,
	rows_processed,
	rows_rejected,
	rows_inserted
from sys._pdw_loader_backup_runs
"
195	Parse Tree	View	-582	32767	6	4	1	4	3	251	0	1	1024	0	0	0	0	0	530	"CREATE VIEW sys.database_scoped_configurations AS
	SELECT id as configuration_id,
		name,
		convert(sql_variant, value) as value,
		convert(sql_variant, value_for_secondary) as value_for_secondary,
		is_value_default
	FROM OpenRowset(TABLE DB_SCOPED_CONFIG)
"
196	Parse Tree	View	-213	32767	1	4	1	2	154	251	0	1	1024	0	0	0	0	0	22104	"CREATE VIEW sys.databases AS
	SELECT d.name, 
		d.id AS database_id,
		r.indepid AS source_database_id,
		d.sid AS owner_sid,
		d.crdate AS create_date,
		d.cmptlevel AS compatibility_level,
		-- coll.value = null means that a collation was not specified for the DB and the server default is used instead
		convert(sysname, case when serverproperty('EngineEdition') = 5 AND d.id = 1 then serverproperty('collation')
                                 else CollationPropertyFromID(convert(int, isnull(coll.value, p.cid)), 'name') end) AS collation_name,
		iif ((serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x10000000) = 1), cast (3 as tinyint), p.user_access) AS user_access,
		iif ((serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x10000000) = 1), 'NO_ACCESS', ua.name) AS user_access_desc,
		sysconv(bit, d.status & 0x400) AS is_read_only,			-- DBR_RDONLY
		sysconv(bit, d.status & 1) AS is_auto_close_on,			-- DBR_CLOSE_ON_EXIT
		sysconv(bit, d.status & 0x400000) AS is_auto_shrink_on,		-- DBR_AUTOSHRINK
		case when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000020) = 1) then cast (1 as tinyint) -- RESTORING
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000080) = 1) then cast (7 as tinyint) -- COPYING
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000100) = 1) then cast (4 as tinyint) -- SUSPECT
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x08000000) = 1) then cast (8 as tinyint) -- QUORUM_RECOVERY_PENDING
  			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x04000000) = 1) then cast (9 as tinyint) -- CREATING
			 else p.state 
			 end AS state, -- 7 is COPYING and 4 is SUSPECT state for database copy (UNDO: Need to have a clean way to set states in dbtable for a user db)
		case when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000020) = 1) then 'RESTORING' 
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000080) = 1) then 'COPYING' 
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000100) = 1) then 'SUSPECT'
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x08000000) = 1) then CONVERT(nvarchar(60), N'QUORUM_RECOVERY_PENDING')
  			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x04000000) = 1) then 'CREATING'
			 else st.name 
			 end AS state_desc,
		sysconv(bit, d.status & 0x200000) AS is_in_standby,		-- DBR_STANDBY
		case when serverproperty('EngineEdition') = 5 then convert(bit, 0) else p.is_cleanly_shutdown end AS is_cleanly_shutdown,
		sysconv(bit, d.status & 0x80000000) AS is_supplemental_logging_enabled,	-- DBR_SUPPLEMENT_LOG
        case when (serverproperty('EngineEdition') = 5) then sysconv(tinyint, sysconv(bit,(d.status & 0x00100000)))
             else p.snapshot_isolation_state end AS snapshot_isolation_state,
        case when (serverproperty('EngineEdition') = 5) and (sysconv(bit, d.status & 0x00100000) = 1) then 'ON'
             when (serverproperty('EngineEdition') = 5) and (sysconv(bit, d.status & 0x00100000) = 0) then 'OFF'
             else si.name end AS snapshot_isolation_state_desc,		
		sysconv(bit, d.status & 0x800000) AS is_read_committed_snapshot_on,		-- DBR_READCOMMITTED_SNAPSHOT
        case when (serverproperty('EngineEdition') = 5) 
	         then case 
	         		when sysconv(bit,(d.status & 0x00000008)) = 1
	        	 		then cast(3 as tinyint)
	        	  	when sysconv(bit,(d.status & 0x00000004)) = 1
	        	 		then cast(2 as tinyint)
	        	 	else
	        	 		cast(1 as tinyint)
	          	   end	
              else p.recovery_model 
        end AS recovery_model,
		case when (serverproperty('EngineEdition') = 5) 
	     "
196	Parse Tree	View	-213	32767	6	4	1	47	153	251	0	1	1024	0	0	0	0	0	22104	"CREATE VIEW sys.databases AS
	SELECT d.name, 
		d.id AS database_id,
		r.indepid AS source_database_id,
		d.sid AS owner_sid,
		d.crdate AS create_date,
		d.cmptlevel AS compatibility_level,
		-- coll.value = null means that a collation was not specified for the DB and the server default is used instead
		convert(sysname, case when serverproperty('EngineEdition') = 5 AND d.id = 1 then serverproperty('collation')
                                 else CollationPropertyFromID(convert(int, isnull(coll.value, p.cid)), 'name') end) AS collation_name,
		iif ((serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x10000000) = 1), cast (3 as tinyint), p.user_access) AS user_access,
		iif ((serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x10000000) = 1), 'NO_ACCESS', ua.name) AS user_access_desc,
		sysconv(bit, d.status & 0x400) AS is_read_only,			-- DBR_RDONLY
		sysconv(bit, d.status & 1) AS is_auto_close_on,			-- DBR_CLOSE_ON_EXIT
		sysconv(bit, d.status & 0x400000) AS is_auto_shrink_on,		-- DBR_AUTOSHRINK
		case when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000020) = 1) then cast (1 as tinyint) -- RESTORING
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000080) = 1) then cast (7 as tinyint) -- COPYING
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000100) = 1) then cast (4 as tinyint) -- SUSPECT
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x08000000) = 1) then cast (8 as tinyint) -- QUORUM_RECOVERY_PENDING
  			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x04000000) = 1) then cast (9 as tinyint) -- CREATING
			 else p.state 
			 end AS state, -- 7 is COPYING and 4 is SUSPECT state for database copy (UNDO: Need to have a clean way to set states in dbtable for a user db)
		case when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000020) = 1) then 'RESTORING' 
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000080) = 1) then 'COPYING' 
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x00000100) = 1) then 'SUSPECT'
			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x08000000) = 1) then CONVERT(nvarchar(60), N'QUORUM_RECOVERY_PENDING')
  			 when (serverproperty('EngineEdition') = 5) AND (sysconv(bit, d.status & 0x04000000) = 1) then 'CREATING'
			 else st.name 
			 end AS state_desc,
		sysconv(bit, d.status & 0x200000) AS is_in_standby,		-- DBR_STANDBY
		case when serverproperty('EngineEdition') = 5 then convert(bit, 0) else p.is_cleanly_shutdown end AS is_cleanly_shutdown,
		sysconv(bit, d.status & 0x80000000) AS is_supplemental_logging_enabled,	-- DBR_SUPPLEMENT_LOG
        case when (serverproperty('EngineEdition') = 5) then sysconv(tinyint, sysconv(bit,(d.status & 0x00100000)))
             else p.snapshot_isolation_state end AS snapshot_isolation_state,
        case when (serverproperty('EngineEdition') = 5) and (sysconv(bit, d.status & 0x00100000) = 1) then 'ON'
             when (serverproperty('EngineEdition') = 5) and (sysconv(bit, d.status & 0x00100000) = 0) then 'OFF'
             else si.name end AS snapshot_isolation_state_desc,		
		sysconv(bit, d.status & 0x800000) AS is_read_committed_snapshot_on,		-- DBR_READCOMMITTED_SNAPSHOT
        case when (serverproperty('EngineEdition') = 5) 
	         then case 
	         		when sysconv(bit,(d.status & 0x00000008)) = 1
	        	 		then cast(3 as tinyint)
	        	  	when sysconv(bit,(d.status & 0x00000004)) = 1
	        	 		then cast(2 as tinyint)
	        	 	else
	        	 		cast(1 as tinyint)
	          	   end	
              else p.recovery_model 
        end AS recovery_model,
		case when (serverproperty('EngineEdition') = 5) 
	     "
207	Parse Tree	View	-766196453	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	224	"CREATE VIEW sys.dm_tran_global_transactions_log AS
	SELECT *
	FROM OpenRowset(TABLE GLOBAL_TRANSACTIONS_LOG)
"
214	Parse Tree	View	-178544899	32767	6	4	1	6	11	251	0	1	1024	0	0	0	0	0	2258	"CREATE VIEW sys.dm_hadr_automatic_seeding AS
	SELECT 
		start_time as start_time,
		completion_time as completion_time,
		ag_id as ag_id,
		ag_db_id as ag_db_id,
		ag_remote_replica_id as ag_remote_replica_id,
		operation_id as operation_id,
		is_source as is_source,
		current_state as current_state,
		performed_seeding as performed_seeding,
		failure_state as failure_state,
		failure_state_desc as failure_state_desc,
		error_code as error_code,
		number_of_attempts as number_of_attempts
	FROM OpenRowset(TABLE DM_HADR_AUTOMATIC_SEEDING)
	UNION
	SELECT 
		start_time as start_time,
		completion_time as completion_time,
		ag_id as ag_id,
		ag_db_id as ag_db_id,
		ag_remote_replica_id as ag_remote_replica_id,
		operation_id as operation_id,
		is_source as is_source,
		current_state collate database_default as current_state,
		performed_seeding as performed_seeding,
		failure_state as failure_state,
		failure_state_desc collate database_default as failure_state_desc,
		error_code as error_code,
		number_of_attempts as number_of_attempts
	FROM msdb.dbo.dm_hadr_automatic_seeding_history
"
217	Parse Tree	View	-466	32767	6	4	1	13	21	251	0	1	1024	0	0	0	0	0	2252	"CREATE VIEW sys.crypt_properties AS
	SELECT						-- objects
		k.class AS class,
		un.name AS class_desc,
		s.id AS major_id,
		k.thumbprint AS thumbprint,
		k.type AS crypt_type,
		ct.name AS crypt_type_desc,
		k.crypto AS crypt_property
	FROM sys.sysschobjs$ s
	JOIN sys.sysobjkeycrypts k ON k.class = 1 AND k.id = s.id
	LEFT JOIN sys.syspalvalues un ON un.class = 'UNCL' AND un.value = k.class
	LEFT JOIN sys.syspalnames ct ON ct.class = 'CRTY' AND ct.value = k.type
	WHERE s.nsclass = 0 -- x_eonc_Standard
		AND s.pclass = 1 -- x_eunc_Object
		AND k.type <> 'INCP'
		AND has_access('SQ', s.id, s.pid, 0) = 1
	UNION
	SELECT						-- assemblies
		k.class AS class,
		un.name AS class_desc,
		s.assembly_id AS major_id,
		k.thumbprint AS thumbprint,
		k.type AS crypt_type,
		ct.name AS crypt_type_desc,
		k.crypto AS crypt_property
	FROM sys.assemblies s
	JOIN sys.sysobjkeycrypts k ON k.class = 5 AND k.id = s.assembly_id
	LEFT JOIN sys.syspalvalues un ON un.class = 'UNCL' AND un.value = k.class
	LEFT JOIN sys.syspalnames ct ON ct.class = 'CRTY' AND ct.value = k.type
	WHERE k.type <> 'INCP'
"
228	Parse Tree	View	-408	32767	6	4	1	16	10	251	0	1	1024	0	0	0	0	0	906	"CREATE VIEW sys.default_constraints AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc, create_date, modify_date,
		is_ms_shipped, is_published, is_schema_published,
		property AS parent_column_id,
		object_definition(object_id) AS definition,
		is_system_named
	FROM sys.objects$
	WHERE type = 'D ' AND 
		(parent_object_id > 0 OR 
		(parent_object_id & 0xe0000000 = 0xa0000000)) -- IsLocalTempObjectId
"
231	Parse Tree	View	-66559004	32767	6	4	1	12	4	251	0	1	1024	0	0	0	0	0	174	"CREATE VIEW sys.dm_xe_packages AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_PACKAGES) 
"
240	Parse Tree	View	-967901234	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	342	"
-- add it
create view sys.pdw_distributions as
select
	distribution_id,
	pdw_node_id,
	name	collate database_default name,
	position
from sys._pdw_distributions
"
261	Parse Tree	View	-234	32767	6	4	1	10	9	251	0	1	1024	0	0	0	0	0	1284	"CREATE VIEW sys.server_events AS
	SELECT ee.object_id AS object_id,
		ee.event_id AS type,
		ee.event_desc AS type_desc,
		sysconv(bit, 71 - e.valclass) AS is_trigger_event,
		ee.group_id AS event_group_type,
		ee.group_desc AS event_group_type_desc
	FROM master.sys.sysobjvalues e
	CROSS APPLY openrowset( TABLE EXPAND_EVENTS, e.objid, e.subobjid,
	       case when (e.valclass = 70 AND convert(int, e.value) & 4 != 4) OR e.valclass = 71  -- is user created trigger? 
			then 1 else 0 end) ee
	WHERE e.valclass in (70,71) AND e.valnum = 100	-- x_eunc_Server
		AND has_access('CO', e.objid) = 1	-- SVC_EXTTRIGEVT, SVC_ASYNTRGEVT
"
271	Parse Tree	View	-545	32767	6	4	1	2	42	187	0	1	1024	0	0	0	0	0	11632	"CREATE VIEW sys.plan_persist_query_merged AS
	SELECT 
		Q.query_id as query_id,
		Q.query_text_id as query_text_id,
		Q.context_settings_id as context_settings_id,
		Q.object_id as object_id,
		Q.status as status,
		Q.batch_sql_handle as batch_sql_handle,
		Q.query_hash as query_hash,
		Q.is_internal_query as is_internal_query,
		Q.query_param_type as query_param_type,
		Q.initial_compile_start_time as initial_compile_start_time,
		IIF(QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_compile_start_time, QM.last_compile_start_time) as last_compile_start_time,
		IIF(QM.last_execution_time is NULL, Q.last_execution_time, IIF(Q.last_execution_time is not NULL OR QM.last_execution_time <= Q.last_execution_time,Q.last_execution_time, QM.last_execution_time)) as last_execution_time,
		IIF(QM.last_compile_batch_sql_handle is NULL OR QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_compile_batch_sql_handle, QM.last_compile_batch_sql_handle) as last_compile_batch_sql_handle,
		IIF(QM.last_compile_batch_offset_start is NULL OR QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_compile_batch_offset_start, QM.last_compile_batch_offset_start) as last_compile_batch_offset_start,
		IIF(QM.last_compile_batch_offset_end is NULL OR QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_compile_batch_offset_end, QM.last_compile_batch_offset_end) as last_compile_batch_offset_end,
		IIF(QM.compile_count is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.compile_count, Q.compile_count + QM.compile_count) as compile_count,
		IIF(QM.total_compile_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.total_compile_duration, Q.total_compile_duration + QM.total_compile_duration) as total_compile_duration,
		IIF(QM.last_compile_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_compile_duration, QM.last_compile_duration) as last_compile_duration,
		IIF(QM.total_parse_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.total_parse_duration, Q.total_parse_duration + QM.total_parse_duration) as total_parse_duration,
		IIF(QM.last_parse_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_parse_duration, QM.last_parse_duration) as last_parse_duration,
		IIF(QM.total_parse_cpu_time is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.total_parse_cpu_time, Q.total_parse_cpu_time + QM.total_parse_cpu_time) as total_parse_cpu_time,
		IIF(QM.last_parse_cpu_time is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_parse_cpu_time, QM.last_parse_cpu_time) as last_parse_cpu_time,
		IIF(QM.total_bind_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.total_bind_duration, Q.total_bind_duration + QM.total_bind_duration) as total_bind_duration,
		IIF(QM.last_bind_duration is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.last_bind_duration, QM.last_bind_duration) as last_bind_duration,
		IIF(QM.total_bind_cpu_time is NULL or QM.last_compile_start_time is NULL or QM.last_compile_start_time <= Q.last_compile_start_time, Q.total_bind_cpu_time, Q.total_bind_cpu_time + QM.total_bind_cpu_time) as total_bind_cpu_time,
		IIF(QM.last_bind_cpu_time is NULL or QM.last_compile_start_time is NULL or QM.last"
274	Parse Tree	View	-480947380	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	656	"CREATE VIEW sys.dm_io_pending_io_requests AS
	SELECT
		io_completion_request_address,
		io_type,
		io_pending_ms_ticks,
		io_pending,
		io_completion_routine_address,
		io_user_data_address,
		scheduler_address,
		io_handle,
		io_offset,
		trim_path(io_handle_path) as io_handle_path
	FROM OpenRowSet(TABLE SYSIOS)
"
278	Parse Tree	View	-806439612	32767	6	4	1	1	7	251	0	1	1024	0	0	0	0	0	982	"CREATE FUNCTION sys.dm_io_virtual_file_stats
	(
	@DatabaseId Int = null,
	@FileId Int = null
	)
RETURNS TABLE
as
	RETURN SELECT 
			database_id,
			file_id,
			sample_ms,
			num_of_reads,
			num_of_bytes_read,
			io_stall_read_ms,
			io_stall_queued_read_ms,
			num_of_writes,
			num_of_bytes_written,
			io_stall_write_ms,
			io_stall_queued_write_ms,
			io_stall,
			size_on_disk_bytes,
			file_handle
		FROM OpenRowset(TABLE VIRTUALFILESTATS, @DatabaseId, @FileId)
"
282	Parse Tree	View	-487	32767	6	4	1	2	22	251	0	1	1024	0	0	0	0	0	4170	"CREATE VIEW sys.system_internals_partition_columns AS
	SELECT c.rsid AS partition_id,
		c.rscolid AS partition_column_id,
		c.rcmodified AS modified_count,
		case c.maxinrowlen when 0 then p.length
			else c.maxinrowlen end AS max_inrow_length,
		convert(bit, c.status & 1) AS is_replicated,				--RSC_REPLICATED
		convert(bit, c.status & 4) AS is_logged_for_replication,	--RSC_LOG_FOR_REPL
		convert(bit, c.status & 2) AS is_dropped,				--RSC_DROPPED
		p.xtype AS system_type_id,
		p.length AS max_length,
		p.prec AS precision,
		p.scale AS scale,
		convert(sysname, CollationPropertyFromId(c.cid, 'name')) AS collation_name,
		convert(bit, c.status & 32) AS is_filestream,			--RSC_FILESTREAM
		c.ordkey AS key_ordinal,
		convert(bit, 1 - (c.status & 128)/128) AS is_nullable,		-- RSC_NOTNULL		
		convert(bit, c.status & 8) AS is_descending_key,		--RSC_DESC_KEY
		convert(bit, c.status & 16) AS is_uniqueifier,			--RSC_UNIQUIFIER
		convert(smallint, convert(binary(2), c.offset & 0xffff)) AS leaf_offset,
		convert(smallint, substring(convert(binary(4), c.offset), 1, 2)) AS internal_offset,
		convert(tinyint, c.bitpos & 0xff) AS leaf_bit_position,
		convert(tinyint, c.bitpos/0x100) AS internal_bit_position,
		convert(smallint, convert(binary(2), c.nullbit & 0xffff)) AS leaf_null_bit,
		convert(smallint, substring(convert(binary(4), c.nullbit), 1, 2)) AS internal_null_bit,
		convert(bit, c.status & 64) AS is_anti_matter,			--RSC_ANTIMATTER
		convert(uniqueidentifier, c.colguid) AS partition_column_guid,
		sysconv(bit, c.status & 0x00000100) AS is_sparse,	--RSC_SPARSE
		sysconv(bit, case when ov.value is NULL then 0 else 1 end) AS has_default,
		ov.value AS default_value
	FROM
		sys.sysrscols c OUTER APPLY
		OpenRowset(TABLE RSCPROP, c.ti) p LEFT OUTER JOIN -- It simply decodes ti into individual properties
		sys.sysseobjvalues ov ON
		(
			ov.valclass = 1 AND -- SEVC_OUT_OF_ROW_DEFAULT
			ov.id = c.rsid AND
			ov.subid = c.hbcolid AND
			ov.valnum = 0 -- SE_VALNUM_DEFAULT 
		)
	JOIN sys.sysrowsets rs ON c.rsid = rs.rowsetid
"
284	Parse Tree	View	-120687274	32767	6	4	1	5	12	251	0	1	1024	0	0	0	0	0	1114	"CREATE VIEW sys.dm_db_script_level AS
	SELECT 
		d.database_id AS database_id,
		s.script_id AS script_id,
		s.script_name AS script_name,
		s.version AS version,
		s.script_level AS script_level,
		s.downgrade_start_level AS downgrade_start_level,
		s.downgrade_target_level AS downgrade_target_level,
		s.upgrade_start_level AS upgrade_start_level,
		s.upgrade_target_level AS upgrade_target_level
	FROM sys.databases d CROSS APPLY OpenRowset(TABLE DBSCRIPTLEVEL, d.database_id) s
	WHERE d.database_id < 0x7fff
		AND has_access('DL', 0) = 1
"
284	Parse Tree	View	-5261819	32767	6	4	1	22	7	251	0	1	1024	0	0	0	0	0	244	"
-- add it
create view sys.dm_pdw_nodes_tran_locks as
select *, convert(int, null) pdw_node_id from sys.dm_tran_locks
"
290	Parse Tree	View	-185224994	32767	6	4	1	23	18	251	0	1	1024	0	0	0	0	0	3366	"
CREATE VIEW sys.dm_db_tuning_recommendations AS
	(SELECT
		[RecommendationName] AS [name],
		[AdvisorName] AS [type],
		[RecommendationReason] AS [reason],
		[ValidSince] AS [valid_since],
		[LastRefresh] AS [last_refresh],
		[State] AS [state],
		[IsExecutableAction] AS [is_executable_action],
		[IsRevertableAction] AS [is_revertable_action],
		[ExecuteActionStartTime] AS [execute_action_start_time],
		[ExecuteActionDuration] AS [execute_action_duration],
		[ExecuteActionInitiatedBy] AS [execute_action_initiated_by],
		[ExecuteActionInitiatedTime] AS [execute_action_initiated_time],
		[RevertActionStartTime] AS [revert_action_start_time],
		[RevertActionDuration] AS [revert_action_duration],
		[RevertActionInitiatedBy] AS [revert_action_initiated_by],
		[RevertActionInitiatedTime] AS [revert_action_initiated_time],
		[Score] AS [score],
		[Details] AS [details]
	FROM OpenRowset(TABLE DATABASE_TUNING_RECOMMENDATIONS)
	CROSS APPLY
		OPENJSON([json] Collate Database_Default) WITH (
			[RecommendationName] nvarchar(4000), [AdvisorName] nvarchar(4000), [RecommendationReason] nvarchar(4000), [ValidSince] datetime2, [LastRefresh] datetime2,
			[State] nvarchar(4000), [IsExecutableAction] bit, [IsRevertableAction] bit, [ExecuteActionStartTime] datetime2,
			[ExecuteActionDuration] time, [ExecuteActionInitiatedBy] nvarchar(4000), [ExecuteActionInitiatedTime] datetime2, [RevertActionStartTime] datetime2,
			[RevertActionDuration] time, [RevertActionInitiatedBy] nvarchar(4000), [RevertActionInitiatedTime] datetime2, [Score] int, [Details] nvarchar(max)
		))
	UNION ALL
		(SELECT * FROM sys.dm_database_plan_correction_recommendations)
"
293	Parse Tree	View	-429	32767	6	4	1	22	11	187	0	1	1024	0	0	0	0	0	1238	" CREATE VIEW sys.database_permissions AS
	SELECT p.class,
		class_desc = n.name,
		major_id = p.id,
		minor_id = p.subid,
		grantee_principal_id = p.grantee,
		grantor_principal_id = p.grantor,
		p.type,
		permission_name = permission_name(p.class, p.type),
		p.state,
		state_desc = s.name
	FROM sys.sysprivs p
	LEFT JOIN sys.syspalvalues n ON n.class = 'UNCL' AND n.value = p.class
	LEFT JOIN sys.syspalnames s ON s.class = 'PRST' AND s.value = p.state
	WHERE (p.state <> 'R' OR p.subid <> 0) AND p.class < 100
		AND (has_access('US', p.grantee, p.grantor) = 1 OR has_access('CT', p.class, p.id) = 1)
"
295	Compiled Plan	Adhoc	508307726	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	56	SELECT t.* FROM sys.routes t
305	Parse Tree	View	-905518681	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	640	"CREATE VIEW sys.dm_tran_top_version_generators AS
	SELECT TOP 256 database_id, rowset_id, SUM(record_length_first_part_in_bytes + record_length_second_part_in_bytes) aggregated_record_length_in_bytes 
	FROM sys.dm_tran_version_store
	GROUP BY database_id, rowset_id
	ORDER BY aggregated_record_length_in_bytes desc
"
315	Parse Tree	View	-464069102	32767	6	3	1	21	11	251	0	1	1024	0	0	0	0	0	942	"CREATE VIEW INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE
AS
SELECT
	DB_NAME()					AS DOMAIN_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS DOMAIN_SCHEMA,
	t.name						AS DOMAIN_NAME,
	DB_NAME()					AS TABLE_CATALOG,
	SCHEMA_NAME(o.schema_id)	AS TABLE_SCHEMA,
	o.name						AS TABLE_NAME,
	c.name						AS COLUMN_NAME
FROM
	sys.objects o JOIN sys.columns c ON c.object_id = o.object_id
	JOIN sys.types t ON t.user_type_id = c.user_type_id
WHERE
	c.user_type_id > 256	-- UDT
"
326	Parse Tree	View	-255	32767	6	4	1	4	12	251	0	1	1024	0	0	0	0	0	2358	"CREATE VIEW sys.resource_governor_resource_pools
AS
    -- ISSUE - VSTS 83011
    -- Use isnull() below because Algebrizer doesn't properly
    -- determine these columns are non-nullable.
    SELECT
        pool_id             = co.id,
        name                = co.name,
        min_cpu_percent     = isnull( co.status            % 0x100, 0),
        max_cpu_percent     = isnull((co.status/0x100)     % 0x100, 0),
        min_memory_percent  = isnull((co.status/0x10000)   % 0x100, 0),
        max_memory_percent  = isnull((co.status/0x1000000) % 0x100, 0),
        cap_cpu_percent     = isnull( co.intprop % 0x100, 0),
        min_iops_per_volume = isnull(convert(int, convert(bigint, ov.value) % 0x100000000), 0),
        max_iops_per_volume = isnull(convert(int, convert(bigint, ov.value) / 0x100000000), 0)
    FROM
        master.sys.sysclsobjs co LEFT JOIN
        master.sys.sysobjvalues ov ON
        (
            co.id = ov.objid AND
            ov.valclass = 101 AND -- SVC_RG_POOL
            ov.subobjid = 0 AND
            ov.valnum = 1
        )
    WHERE 
        co.class = 54 AND -- SOC_RG_POOL
        has_access('RG', 0) = 1 
"
328	Parse Tree	View	-118208564	32767	6	4	1	16	6	251	0	1	1024	0	0	0	0	0	828	"
-- add it
create view sys.dm_pdw_waits as
select
	wait_id,
	session_id	collate database_default session_id,
	type	collate database_default type,
	object_type	collate database_default object_type,
	object_name	collate database_default object_name,
	request_id	collate database_default request_id,
	request_time,
	acquire_time,
	state	collate database_default state,
	priority
from sys._dm_pdw_waits
"
336	Parse Tree	View	-566	32767	6	4	1	29	7	251	0	1	1024	0	0	0	0	0	1200	"
CREATE VIEW sys.external_file_formats AS
	SELECT
		seff.file_format_id AS file_format_id,
		seff.name AS name,
		seff.format_type AS format_type,
		seff.field_terminator AS field_terminator,
		seff.string_delimiter AS string_delimiter,
		seff.date_format AS date_format,
		sysconv(bit, seff.use_type_default & 0x1) AS use_type_default,
		seff.serde_method AS serde_method,
		seff.row_terminator AS row_terminator,
		seff.encoding AS encoding,
		seff.data_compression AS data_compression
	FROM sys.sysextfileformats seff
	WHERE has_access('EF', DB_ID()) = 1 -- catalog security check
"
337	Parse Tree	View	-197	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	370	"CREATE VIEW sys.syscurconfigs AS
	SELECT value,
		convert(smallint, id) AS config,
		description AS comment,
		convert(smallint, status) AS status
	FROM OpenRowset(TABLE CFGPROP)
"
338	Parse Tree	View	-506864465	32767	6	4	1	102	38	251	0	1	1024	0	0	0	0	0	8536	"CREATE VIEW sys.objects$ AS
	SELECT
		o.name,
		o.id AS object_id,
		r.indepid AS principal_id,
		o.nsid AS schema_id,
		o.pid AS parent_object_id,
		convert(char(2), case o.type when 'ET' then 'U' else o.type end) AS type,
		n.name AS type_desc,
		o.intprop AS property,
		o.created AS create_date,
		o.modified AS modify_date,
		sysconv(bit, o.status & 1) AS is_ms_shipped,				-- OBJALL_MSSHIPPED
		sysconv(bit, o.status & 2) AS is_auto_dropped,				-- OBJALL_AUTODROP
		sysconv(bit, o.status & 4) AS is_system_named,			-- OBJALL_SYSNAMED
		sysconv(bit, o.status & 16) AS is_published,				-- OBJALL_RPL_PUBLISHED
		sysconv(bit, o.status & 64) AS is_schema_published,			-- OBJALL_RPL_PUB_SCHONLY
		convert(bit, o.status & 0x100) AS is_cycling,				-- OBJSEQ_IS_CYCLING
		sysconv(bit, o.status & 256) AS lock_on_bulk_load,			-- OBJTAB_BCPTABLOCK
		sysconv(bit, o.status & 256) AS is_disabled,				-- OBJCST_DISABLED
		sysconv(bit, o.status & 256) AS is_auto_executed,			-- OBJPRC_STARTUP
		sysconv(bit, o.status & 256) AS is_activation_enabled,		-- OBJSQ_ACTIVATIONON
		sysconv(bit, o.status & 256) AS is_enabled,					-- OBJSECPOL_ENABLED
		sysconv(bit, o.status & 512) AS has_opaque_metadata,		-- OBJVW_OPAQUEBMM
		sysconv(bit, o.status & 512) AS is_not_for_replication,		-- OBJCST_NOTFORREPL, OBJSECPOL_NOTFORREPL
		sysconv(bit, o.status & 512) AS is_receive_enabled,			-- OBJSQ_RECEIVEON
		convert(bit, o.status & 0x200) AS is_cached,				-- OBJSEQ_IS_CACHED
		sysconv(bit, o.status & 1024) AS is_not_trusted,			-- OBJCST_NOTRUST
		sysconv(bit, o.status & 1024) AS is_enqueue_enabled,		-- OBJSQ_ENQUEUEON
		sysconv(bit, o.status & 1024) AS with_check_option,		-- OBJVW_WITHCHECK
		sysconv(bit, o.status & 2048) AS is_retention_enabled,		-- OBJSQ_RETENTIONON
		sysconv(bit, o.status & 2048) AS has_unchecked_assembly_data,	-- OBJTAB_HAS_UNCHKED_ASM_DATA
		convert(tinyint, (o.status/4096) & 3) AS update_referential_action,		-- ERefAct/OBJREF_UPDACTMASK
		convert(tinyint, (o.status/16384) & 3) AS delete_referential_action,	-- ERefAct/OBJREF_DELACTMASK
		sysconv(bit, o.status & 0x1000) AS is_replicated,			-- OBJTAB_REPLICATE
		sysconv(bit, o.status & 0x1000) AS is_execution_replicated,	-- OBJPRC_PROC_EXEC
		sysconv(bit, o.status & 0x2000) AS has_replication_filter,		-- OBJTAB_HAS_FILT_PROC
		sysconv(bit, o.status & 0x2000) AS is_repl_serializable_only,	-- OBJPRC_PROC_SER_ONLY
		sysconv(bit, o.status & 0x4000) AS is_merge_published,			-- OBJTAB_MERGE_PUBL
		sysconv(bit, o.status & 0x4000) AS skips_repl_constraints,		-- OBJPRC_NO_REPL_CNST
		sysconv(bit, o.status & 0x8000) AS is_sync_tran_subscribed,		-- OBJTAB_SYNCTRAN_SUB
		sysconv(bit, o.status & 0x40000) AS uses_ansi_nulls,			-- OBJMOD_ANSINULLS
		sysconv(bit, o.status & 0x200000) AS null_on_null_input, 		-- OBJMOD_NULLONNULL
		sysconv(bit, o.status & 0x100000) AS uses_database_collation,	-- OBJMOD_ANSINULLS
		sysconv(bit, o.status & 0x01000000) AS is_tracked_by_cdc,			-- OBJTAB_CDC_TRACKED
		sysconv(bit, o.status & 0x02000000) AS large_value_types_out_of_row,	-- OBJTAB_LARGETYPE_OUTOFROW
		sysconv(tinyint, (o.status & 0x30000000)/0x10000000) AS lock_escalation_option,
		sysconv(bit, o.status & 0x04000000) AS is_poison_message_handling_enabled,	-- OBJSQ_POISONMSGON
		sysconv(bit, o.status2 & 0x00000002) AS is_filetable,	-- OBJTAB2_FILETABLE
		sysconv(bit, o.status2 & 0x00000020) AS is_catalog_hidden,	-- OBJALL2_CATALOG_HIDDEN
		sysconv(bit, o.status2 & 0x00000008) AS is_memory_optimized,	-- OBJTAB2_HEKATON
		sysconv(tinyint, (o.status2 & 0x40)/0x40) AS durability_option,	--OBJTAB2_DURABILITY_SCHEMA_ONLY
		sysconv(bit, case o.type when 'ET' then 1 else 0 end) AS is_external,
		~(sysconv(bit, o.status & 1024)) AS is_security_policy_schema_bound,	-- OBJSECPOL_NOTSCHEMABOUND
		sysconv(bit, o.status2 & 0x00000100) AS is_node, -- OBJTAB2_GRAPHNODE
		sysconv(bit, o."
346	Parse Tree	View	-660186913	32767	6	4	1	9	6	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_xtp_consumer_memory_usage
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_MM_CONSUMER)
"
348	Parse Tree	View	-139	32767	6	4	1	8	11	251	0	1	1024	0	0	0	0	0	2080	"CREATE VIEW sys.systypes AS
	SELECT
		name,
		xtype = system_type_id,
		status = convert(tinyint, 1 - is_nullable),
		xusertype = convert(smallint, user_type_id),
		length = max_length,
		xprec = precision,
		xscale = scale,
		tdefault = default_object_id,
		domain = rule_object_id,
		uid = convert(smallint, schema_id),
		reserved = convert(smallint, 0),
		collationid = convert(int, collationproperty(collation_name, 'collationid')),
		usertype = convert(smallint, typepropertyex(user_type_id, 'oldusertype')),
		variable = sysconv(bit,	-- nvarchar, varchar or varbinary
			case when system_type_id in (165, 167, 231) then 1 else 0 end),
		allownulls = is_nullable,
		type = xtypetotds(system_type_id, 0),
		printfmt = convert(varchar(255), null),
		prec = convert(smallint,	-- ntext, image or text
			case when system_type_id not in (34, 35, 99) then typepropertyex(user_type_id, 'precision') end),
		scale = convert(tinyint, typepropertyex(user_type_id, 'scale')),
		collation = collation_name
	FROM sys.types
"
357	Parse Tree	View	-157756449	32767	6	3	1	16	7	251	0	1	1024	0	0	0	0	0	676	"CREATE VIEW INFORMATION_SCHEMA.TABLES
AS 
SELECT
	DB_NAME()			AS TABLE_CATALOG,
	s.name				AS TABLE_SCHEMA,
	o.name				AS TABLE_NAME,
	CASE o.type
		WHEN 'U' THEN 'BASE TABLE'
		WHEN 'V' THEN 'VIEW'
	END				AS TABLE_TYPE
FROM
	sys.objects o LEFT JOIN sys.schemas s
	ON s.schema_id = o.schema_id
WHERE
	o.type IN ('U', 'V')
"
358	Parse Tree	View	-450	32767	6	4	1	2	6	251	0	1	1024	0	0	0	0	0	580	"CREATE VIEW sys.xml_schema_namespaces AS
	SELECT xml_collection_id = n.depid,
		name = q.name,
		xml_namespace_id = n.depsubid
	FROM sys.syssingleobjrefs n
	LEFT JOIN sys.sysqnames q ON n.indepid = q.nid
	WHERE n.class = 80	-- SRC_XMLXSDTOQNS
		AND has_access('XC', 0, n.depid) = 1
"
361	Parse Tree	View	-258663724	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	566	"CREATE VIEW sys.dm_tran_session_transactions AS
	SELECT 
		session_id,
		transaction_id,
		transaction_descriptor,
		enlist_count,
		is_user_transaction,
		is_local,
		is_enlisted,
		is_bound,
		open_transaction_count
	FROM OpenRowset(TABLE dm_tran_session_transactions)
"
362	Compiled Plan	Adhoc	641851111	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_fts_outstanding_batches t
369	Parse Tree	View	-392	32767	1	4	1	2	12	251	0	1	1024	0	0	0	0	0	1770	"CREATE VIEW sys.system_columns AS
	SELECT object_id, name collate catalog_default AS name,
		column_id, system_type_id, user_type_id,
		max_length, precision, scale,
		convert(sysname, ColumnPropertyEx(object_id, name, 'collation')) AS collation_name,
		is_nullable, is_ansi_padded, is_rowguidcol,
		is_identity, is_computed, is_filestream,
		is_replicated, is_non_sql_subscribed,
		is_merge_published, is_dts_replicated,
		is_xml_document, xml_collection_id,
		default_object_id, rule_object_id,
		is_sparse, is_column_set,
		generated_always_type,
		generated_always_type_desc,
		encryption_type, encryption_type_desc, 
		encryption_algorithm_name, column_encryption_key_id,
		column_encryption_key_database_name collate catalog_default as column_encryption_key_database_name,
		is_hidden,
		is_masked,
		graph_type,
		graph_type_desc
	FROM sys.system_columns$
"
369	Parse Tree	View	-1055124494	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	196	"CREATE VIEW sys.dm_os_memory_brokers AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_MEMORY_BROKERS)
"
369	Parse Tree	View	-392	32767	6	4	1	24	12	251	0	1	1024	0	0	0	0	0	1770	"CREATE VIEW sys.system_columns AS
	SELECT object_id, name collate catalog_default AS name,
		column_id, system_type_id, user_type_id,
		max_length, precision, scale,
		convert(sysname, ColumnPropertyEx(object_id, name, 'collation')) AS collation_name,
		is_nullable, is_ansi_padded, is_rowguidcol,
		is_identity, is_computed, is_filestream,
		is_replicated, is_non_sql_subscribed,
		is_merge_published, is_dts_replicated,
		is_xml_document, xml_collection_id,
		default_object_id, rule_object_id,
		is_sparse, is_column_set,
		generated_always_type,
		generated_always_type_desc,
		encryption_type, encryption_type_desc, 
		encryption_algorithm_name, column_encryption_key_id,
		column_encryption_key_database_name collate catalog_default as column_encryption_key_database_name,
		is_hidden,
		is_masked,
		graph_type,
		graph_type_desc
	FROM sys.system_columns$
"
370	Parse Tree	View	-171377020	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	194	"create view sys.trace_subclass_values as select * from OpenRowset(TABLE SYSTRACESUBCLASSVALUES)
"
392	Parse Tree	View	-428028999	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	224	"CREATE VIEW sys.dm_os_memory_cache_hash_tables AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMORYCACHEHASHTABLES)
"
396	Parse Tree	View	-641734695	32767	6	4	1	6	16	251	0	1	1024	0	0	0	0	0	2838	"CREATE VIEW sys.dm_resource_governor_resource_pools AS
 	SELECT
 		pool_id,
 		name,
 		statistics_start_time,
 		total_cpu_usage_ms,
 		cache_memory_kb,
 		compile_memory_kb,
 		used_memgrant_kb,
 		total_memgrant_count,
 		total_memgrant_timeout_count,
 		active_memgrant_count,
 		active_memgrant_kb,
 		memgrant_waiter_count,
 		max_memory_kb,
 		used_memory_kb,
 		target_memory_kb,
 		out_of_memory_count,
 		min_cpu_percent,
 		max_cpu_percent,
 		isnull(cast(min_memory_percent as int), 0) min_memory_percent,
 		isnull(cast(max_memory_percent as int), 0) max_memory_percent,
 		cap_cpu_percent,
 		min_iops_per_volume,
 		max_iops_per_volume,
 		read_io_queued_total,
 		read_io_issued_total,
 		read_io_completed_total,
 		read_io_throttled_total,
 		read_bytes_total,
 		read_io_stall_total_ms,
 		read_io_stall_queued_ms,
 		write_io_queued_total,
 		write_io_issued_total,
 		write_io_completed_total,
 		write_io_throttled_total,
 		write_bytes_total,
 		write_io_stall_total_ms,
 		write_io_stall_queued_ms,
 		io_issue_violations_total,
 		io_issue_delay_total_ms,
 		io_issue_ahead_total_ms,
 		reserved_io_limited_by_volume_total,
 		io_issue_delay_non_throttled_total_ms,
 		total_cpu_delayed_ms,
 		total_cpu_active_ms,
 		total_cpu_violation_delay_ms,
 		total_cpu_violation_sec,
		total_cpu_usage_preemptive_ms
	FROM OpenRowSet(TABLE DM_RG_POOLS)
"
397	Parse Tree	View	-39745214	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	190	"CREATE VIEW sys.dm_os_windows_info AS
	SELECT *
	FROM OpenRowset(TABLE DM_OS_WINDOWS_INFO) 
"
401	Parse Tree	View	-587	32767	6	4	1	10	12	251	0	1	1024	0	0	0	0	0	1466	"CREATE VIEW sys.index_resumable_operations AS
	SELECT 
		r.object_id,
		r.index_id,
		r.name,
		r.sql_text,
		r.last_max_dop_used,
		r.partition_number,
		r.state,
		val.name as state_desc,
		r.start_time,
		r.last_pause_time,
		r.total_execution_time,
		r.percent_complete,
		r.page_count
	FROM sys.sysidxstats i
			CROSS APPLY OpenRowset(TABLE INDEX_RESUMABLE_OPERATIONS, i.id, i.indid) r
			LEFT JOIN sys.syspalvalues val ON val.class = 'RIBS' AND val.value = r.state
	WHERE (i.status & 1) = 1 -- IS_INDEX
		AND has_access('CO', i.id) = 1
		AND (i.status & 0x04000000) = 0x04000000 -- IS_IND_RESUMABLE
		AND i.indid != 254 -- exclude mapping index
		AND i.indid != 896254 -- exclude resumable mapping index
"
402	Parse Tree	View	-218	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	526	"CREATE VIEW sys.server_role_members AS
	SELECT role_principal_id = indepid,
		member_principal_id = depid
	FROM master.sys.sysmultiobjrefs
	WHERE class = 26 AND depsubid = 0 AND indepsubid = 0	-- MRC_SRVROLEMEMBER
		AND has_access('SM', depid, indepid) = 1
"
402	Parse Tree	View	-218	32767	1	4	1	8	5	251	0	1	1024	0	0	0	0	0	526	"CREATE VIEW sys.server_role_members AS
	SELECT role_principal_id = indepid,
		member_principal_id = depid
	FROM master.sys.sysmultiobjrefs
	WHERE class = 26 AND depsubid = 0 AND indepsubid = 0	-- MRC_SRVROLEMEMBER
		AND has_access('SM', depid, indepid) = 1
"
409	Parse Tree	View	-427423982	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	606	"CREATE VIEW sys.availability_databases_cluster AS
	SELECT 
		group_id = agdbs.group_id,
		group_database_id = agdbs.group_database_id,
		database_name = CONVERT(sysname, agdbs.database_name),
		truncation_lsn = agdbs.truncation_lsn
	FROM OpenRowset(TABLE DM_AVAILABILITY_DATABASES_CLUSTER) agdbs
"
423	Parse Tree	View	-1021262241	32767	6	4	1	12	6	251	0	1	1024	0	0	0	0	0	188	"CREATE VIEW sys.dm_os_memory_objects AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMORYOBJECTS)
"
424	Parse Tree	View	-102	32767	6	4	1	11	16	251	0	1	1024	0	0	0	0	0	2252	"CREATE VIEW sys.all_views AS
	SELECT o.name, o.id AS object_id,
		r.indepid AS principal_id, o.nsid AS schema_id,
		o.pid AS parent_object_id,
		o.type, n.name AS type_desc,
		o.created AS create_date, o.modified AS modify_date,
		convert(bit, o.status & 1) AS is_ms_shipped,
		convert(bit, o.status & 16) AS is_published,
		convert(bit, o.status & 64) AS is_schema_published,
		convert(bit, o.status & 0x1000) AS is_replicated,
		convert(bit, o.status & 0x2000) AS has_replication_filter,
		convert(bit, o.status & 512) AS has_opaque_metadata,
		convert(bit, o.status & 2048) AS has_unchecked_assembly_data,
		convert(bit, o.status & 1024) AS with_check_option,
		convert(bit, o.status & 2) AS is_date_correlation_view,
		convert(bit, o.status & 0x01000000) AS is_tracked_by_cdc
	FROM sys.sysschobjs$ o		
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 97 AND r.depsubid = 0	-- SRC_OBJOWNER
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	WHERE o.nsclass = 0 -- x_eonc_Standard
		AND o.pclass = 1 AND type = 'V' -- x_eunc_Object
		AND has_access('AO', o.id) = 1
"
432	Parse Tree	View	-62495753	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	230	"CREATE VIEW sys.fulltext_semantic_languages AS
	SELECT lcid, name 
	FROM OpenRowSet(TABLE SYSSEMANTICLANGUAGES)
"
434	Parse Tree	View	-413	32767	6	4	1	14	20	251	0	1	1024	0	0	0	0	0	2320	"CREATE VIEW sys.event_notifications AS
	SELECT o.name,
		object_id = o.id,
		parent_class = o.pclass,
		parent_class_desc = pc.name,
		parent_id = o.pid,
		create_date = o.created,
		modify_date = o.modified,
		service_name = convert(nvarchar(256), v.value) COLLATE Latin1_General_BIN,
		broker_instance = convert(sysname, sb.value) COLLATE Latin1_General_BIN,
		creator_sid = convert(varbinary(85), cs.value),
		principal_id = r.indepid
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 97 AND r.depsubid = 0	-- SRC_OBJOWNER
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 72 AND v.objid = o.id AND v.subobjid = 0 AND v.valnum = 0		-- SVC_ASYNTRGSVCNAME
	LEFT JOIN sys.sysobjvalues sb ON sb.valclass = 74 AND sb.objid = o.id AND sb.subobjid = 0 AND sb.valnum = 0	-- SVC_ASYNTRGBRKRINST
	LEFT JOIN sys.sysobjvalues cs ON cs.valclass = 75 AND cs.objid = o.id AND cs.subobjid = 0 AND cs.valnum = 0	-- SVC_ASYNTRGCTRSID
	LEFT JOIN sys.syspalvalues pc ON pc.class = 'UNCL' AND pc.value = o.pclass
	WHERE o.type = 'EN' AND o.pclass <> 100 -- x_eunc_Server
		AND has_access('TR', o.id, o.pid, o.nsclass) = 1
"
451	Parse Tree	View	-836153001	32767	6	4	1	14	3	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_db_missing_index_details AS
	SELECT *
	FROM OpenRowset(TABLE MISSING_IDX_DETAILS)
"
458	Parse Tree	View	-733506488	32767	6	4	1	8	7	251	0	1	1024	0	0	0	0	0	840	"
-- add it
create view sys.dm_exec_compute_node_status as
select
	compute_node_id,
	process_id,
	process_name	collate database_default process_name,
	allocated_memory,
	available_memory,
	process_cpu_usage,
	total_cpu_usage,
	thread_count,
	handle_count,
	total_elapsed_time,
	is_available,
	sent_time,
	received_time,
	error_id	collate database_default error_id
from sys._dm_exec_compute_node_status
"
467	Parse Tree	View	-239	32767	6	4	1	8	16	251	0	1	1024	0	0	0	0	0	1910	"CREATE VIEW sys.server_assembly_modules AS
	SELECT object_id = o.id,
		assembly_id = asm.indepid,
		assembly_class = convert(sysname, v.value) collate Latin1_General_BIN,
		assembly_method = convert(sysname, m.value) collate Latin1_General_BIN,
		execute_as_principal_id = x.indepid
	FROM sys.sysschobjs$ o
	JOIN sys.syssingleobjrefs asm ON asm.depid = o.id AND asm.class = 11 AND asm.depsubid = 0 	-- SRC_MODULETOASM
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 11 AND v.objid = o.id AND v.subobjid = 0 AND v.valnum = 1 	-- SVC_OBJASMENTRY,ASMENTRY_CLASS
	LEFT JOIN sys.sysobjvalues m ON m.valclass = 11 AND m.objid = o.id AND m.subobjid = 0 AND m.valnum = 2 	-- SVC_OBJASMENTRY,ASMENTRY_METHOD
	LEFT JOIN sys.syssingleobjrefs x ON x.depid = o.id AND x.class = 23 AND x.depsubid = 0	-- SRC_OBJEXECASLOGIN
	WHERE o.type = 'TA' AND o.nsclass = 20 AND o.pclass = 100	-- x_eonc_TrgOnServer:x_eunc_Server
		AND has_access('SQ', o.id, 0, 20) = 1
"
477	Parse Tree	View	-550	32767	6	4	1	8	6	251	0	1	1024	0	0	0	0	0	768	"CREATE VIEW sys.selective_xml_index_namespaces AS
	SELECT s.objid AS object_id,
		s.subobjid AS index_id,
		convert(bit, case when s.value is null then 1 else 0 end) as is_default_uri,
		convert(nvarchar(4000), s.imageval) as uri,
		convert(sysname, s.value) as prefix
	FROM sys.sysobjvalues s
	WHERE s.valclass = 109	-- SVC_SXI_NAMESPACE
		AND has_access('CO', s.objid) = 1
"
487	Parse Tree	View	-663312131	32767	6	4	1	2	2	251	0	1	1024	0	0	0	0	0	204	"CREATE VIEW sys.dm_db_missing_index_groups AS
	SELECT *
	FROM OpenRowset(TABLE MISSING_IDX_GROUPS)
"
499	Parse Tree	View	-434	32767	6	4	1	5	6	251	0	1	1024	0	0	0	0	0	700	"CREATE VIEW sys.partition_parameters AS
	SELECT idmajor AS function_id,
		subid AS parameter_id,
		xtype AS system_type_id,
		length AS max_length,
		prec AS precision,
		scale AS scale,
		convert(sysname, CollationPropertyFromID(collationid, 'name')) AS collation_name,
		utype AS user_type_id
	FROM sys.systypedsubobjs
	WHERE class = 30
"
521	Parse Tree	View	-89629108	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	338	"
-- add it
create view sys.pdw_health_component_groups as
select
	group_id,
	group_name	collate database_default group_name
from sys._pdw_health_component_groups
"
526	Parse Tree	View	-245973352	32767	6	4	1	1	4	251	0	1	1024	0	0	0	0	0	278	"CREATE FUNCTION sys.dm_exec_sql_text(@handle varbinary(64))
RETURNS TABLE
AS
	RETURN SELECT * FROM OPENROWSET(TABLE FNGETSQL, @handle)
"
526	Parse Tree	View	-245973352	32767	1	4	1	3	4	251	0	1	1024	0	0	0	0	0	278	"CREATE FUNCTION sys.dm_exec_sql_text(@handle varbinary(64))
RETURNS TABLE
AS
	RETURN SELECT * FROM OPENROWSET(TABLE FNGETSQL, @handle)
"
532	Parse Tree	View	-260	32767	6	4	1	25	22	251	0	1	1024	0	0	0	0	0	2880	"CREATE VIEW sys.server_file_audits AS
	SELECT
		au.audit_id,
		au.name,
		au.audit_guid,
		au.create_date,
		au.modify_date,
		au.principal_id,
		au.type,
		au.type_desc,	
		au.on_failure,
		au.on_failure_desc,
		au.is_state_enabled,
		au.queue_delay,
		au.predicate,
		convert(bigint, ms.value) AS max_file_size,
		convert(int, mr.value) AS max_rollover_files,
		convert(int, mf.value) AS max_files,
		sysconv(bit, au.status & 0x10000) AS reserve_disk_space,
		convert(nvarchar(260), pt.value) AS log_file_path,
		convert(nvarchar(260), nm.value) AS log_file_name
	FROM sys.server_audits$ au
	LEFT JOIN master.sys.sysobjvalues ms ON ms.valclass = 38 AND ms.objid = au.audit_id AND ms.subobjid = 0 AND ms.valnum = 50 -- SVC_AUDITPROPS/AUDIT_FL_MAX_SIZE
	LEFT JOIN master.sys.sysobjvalues mr ON mr.valclass = 38 AND mr.objid = au.audit_id AND mr.subobjid = 0 AND mr.valnum = 51 -- SVC_AUDITPROPS/AUDIT_FL_MAX_ROLLOVER
	LEFT JOIN master.sys.sysobjvalues nm ON nm.valclass = 38 AND nm.objid = au.audit_id AND nm.subobjid = 0 AND nm.valnum = 53 -- SVC_AUDITPROPS/AUDIT_FL_NAME
	LEFT JOIN master.sys.sysobjvalues pt ON pt.valclass = 38 AND pt.objid = au.audit_id AND pt.subobjid = 0 AND pt.valnum = 54 -- SVC_AUDITPROPS/AUDIT_FL_PATH
	LEFT JOIN master.sys.sysobjvalues mf ON mf.valclass = 38 AND mf.objid = au.audit_id AND mf.subobjid = 0 AND mf.valnum = 55 -- SVC_AUDITPROPS/AUDIT_FL_MAX_FILES
	WHERE au.type = 'FL'
"
536	Parse Tree	View	-112737190	32767	6	4	1	6	2	251	0	1	1024	0	0	0	0	0	204	"create view sys.dm_io_cluster_shared_drives
as
	select * from OpenRowset(TABLE SERVERSHAREDDRIVES)
"
542	Parse Tree	View	-571	32767	6	4	1	31	25	251	0	1	1024	0	0	0	0	0	5306	"CREATE VIEW sys.masked_columns AS
	SELECT object_id = id,
		name = c.name,
		column_id = colid,
		system_type_id = xtype,
		user_type_id = utype,
		max_length = length,
		precision = prec,
		scale = scale,
		collation_name = convert(sysname,CollationPropertyFromId(collationid,'name')),
		is_nullable = sysconv(bit, 1 - (status & 1)), 		-- CPM_NOTNULL
		is_ansi_padded = sysconv(bit, status & 2), 		-- CPM_NOTRIM
		is_rowguidcol = sysconv(bit, status & 8), 		-- CPM_ROWGUIDCOL
		is_identity = sysconv(bit, status & 4), 		-- CPM_IDENTCOL
		is_filestream = sysconv(bit, status & 32), 		-- CPM_FILESTREAM
		is_replicated = sysconv(bit, status & 0x20000), 	-- CPM_REPLICAT
		is_non_sql_subscribed = sysconv(bit, status & 0x40000),	-- CPM_NONSQSSUB
		is_merge_published = sysconv(bit, status & 0x80000), 	-- CPM_MERGEREPL
		is_dts_replicated = sysconv(bit, status & 0x100000), 	-- CPM_REPLDTS
		is_xml_document = sysconv(bit, status & 2048),		-- CPM_XML_DOC 		
		xml_collection_id = xmlns,
		default_object_id = dflt,
		rule_object_id = chk,
		definition = object_definition(id, colid),
		uses_database_collation = sysconv(bit, status & 128),		-- CPM_USESDBCOLL
		is_persisted = sysconv(bit, status & 64),			-- CPM_PERSISTEDCC	
		is_computed = sysconv(bit, status & 16),			-- CPM_COMPUTED	
		sysconv(bit, 0) as is_sparse,
		sysconv(bit, 0) as is_column_set,
		convert(tinyint, 0) AS generated_always_type,
		convert(nvarchar(60), 'NOT_APPLICABLE') collate Latin1_General_CI_AS_KS_WS AS generated_always_type_desc,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) collate catalog_default as column_encryption_key_database_name,
		sysconv(bit, 0) as is_hidden,
		sysconv(bit, status & 0x40000000) AS is_masked,			-- CPM_DATAMASKED
		convert(nvarchar(4000), columnpropertyex(id, c.name, 'maskingfunction')) collate Latin1_General_CI_AS_KS_WS AS masking_function,
		convert(int, sov1.value) as graph_type,
		convert(nvarchar(60), v1.name) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues sov1 ON sov1.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ and sov1.objid = id and sov1.subobjid = colid and sov1.valnum = 0
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'EGCT' AND v1.value = convert(int, sov1.value)
	WHERE number = 0
		AND (status & 0x40000000) = 0x40000000			-- CPM_DATAMASKED
		AND has_access('CO', id) = 1
"
543	Parse Tree	View	-202	32767	6	4	1	6	17	251	0	1	1024	0	0	0	0	0	1578	"CREATE VIEW sys.sysdatabases AS
	SELECT name, dbid = convert(smallint, id),
		sid,
		mode = convert(smallint, 0),
		status = convert(int, dbprop((case when serverproperty('EngineEdition') = 5 then DB_ID() else id end), 'status80')),
		status2 = convert(int,status2 & 0x77937C00),
		crdate,
		reserved = convert(datetime, 0),
		category = convert(int,category & 0x37),
		cmptlevel,
		filename = convert(nvarchar(260), case when serverproperty('EngineEdition') = 5 then NULL else dbprop(id, 'primaryfilename') end),
		version = convert(smallint, dbprop((case when serverproperty('EngineEdition') = 5 then DB_ID() else id end), 'Version'))
	FROM sys.sysdbreg
	WHERE id < 0x7fff AND has_access('DB', (case when serverproperty('EngineEdition') = 5 then DB_ID() else id end)) = 1 
"
551	Parse Tree	View	-422060983	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	228	"CREATE VIEW sys.dm_resource_governor_configuration AS
	SELECT *
	FROM OpenRowSet(TABLE DM_RG_CONFIGURATION, 0)
"
553	Parse Tree	View	-513	32767	6	4	1	5	8	251	0	1	1024	0	0	0	0	0	744	"CREATE VIEW sys.registered_search_property_lists AS
	SELECT 
		o.id AS property_list_id,
		o.name AS name,
		o.created AS create_date,
		o.modified AS modify_date,
		p.indepid as principal_id 
	FROM sys.sysclsobjs o 
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 102 AND p.depsubid = 0	
	where o.class = 66
		AND has_access ('FP', o.id) = 1
"
560	Parse Tree	View	-523344064	32767	6	4	1	20	7	251	0	1	1024	0	0	0	0	0	1048	"
-- add it
create view sys.dm_pdw_exec_requests as
select
	request_id	collate database_default request_id,
	session_id	collate database_default session_id,
	status		collate database_default status,
	submit_time,
	start_time,
	end_compile_time,
	end_time,
	total_elapsed_time,
	label		collate database_default label,
	error_id	collate database_default error_id,
	database_id,
	command		collate database_default command,
	resource_class	collate database_default resource_class
from sys._dm_pdw_exec_requests
"
564	Parse Tree	View	-455	32767	6	4	1	26	21	251	0	1	1024	0	0	0	0	0	2276	"CREATE VIEW sys.xml_schema_model_groups AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id,
		c.enum AS compositor,
		p.name AS compositor_desc
	FROM sys.sysxmlcomponent c
	LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	LEFT JOIN sys.sysbinpals p ON p.class = 'XGCO' AND p.value = c.enum
	WHERE c.symspace = 'M'
		AND has_access('XC', c.id, c.xsdid) = 1
"
575	Parse Tree	View	-397	32767	6	4	1	21	30	251	0	1	1024	0	0	0	0	0	5266	"CREATE VIEW sys.indexes AS
	SELECT i.id AS object_id,
		i.name AS name,
		i.indid AS index_id,
		i.type,
		n.name AS type_desc,
		sysconv(bit, i.status & 0x8) AS is_unique,			-- IS_IND_UNIQUE
		case when obj.status2 & 0x00000008 != 0 			-- OBJTAB2_HEKATON
 		  then 0 
 		  else isnull(ds.indepid, 1 - (i.status & 0x100)/0x100) 
		end AS data_space_id,	-- IS_IND_ITWINDEX
		sysconv(bit, i.status & 0x4) AS ignore_dup_key,			-- IS_IND_DPKEYS
		sysconv(bit, i.status & 0x20) AS is_primary_key,		-- IS_IND_PRIMARY
		sysconv(bit, i.status & 0x40) AS is_unique_constraint,		-- IS_IND_UNIQUE_CO
		i.fillfact AS fill_factor,
		sysconv(bit, i.status & 0x10) AS is_padded,			-- IS_IND_PADINDEX
		sysconv(bit, i.status & 0x80) AS is_disabled,			-- IS_IND_OFFLINE
		sysconv(bit, i.status & 0x100) AS is_hypothetical,		-- IS_IND_ITWINDEX
		sysconv(bit, i.status & 0x02000000) AS is_ignored_in_optimization,	-- IS_IND_IGNORE_IN_OPTIMIZATION
		case when obj.status2 & 0x00000008 != 0 			-- OBJTAB2_HEKATON
 		  then sysconv(bit, 0) 
		  else sysconv(bit, 1 - (i.status & 512)/512)			-- IS_IND_NO_ROWLOCK
		end as allow_row_locks,
		case when obj.status2 & 0x00000008 != 0 			-- OBJTAB2_HEKATON
 		  then sysconv(bit, 0)
		  else sysconv(bit, 1 - (i.status & 1024)/1024)			-- IS_IND_NO_PAGELOCK
		end AS allow_page_locks,
		sysconv(bit, i.status & 0x20000) AS has_filter,			-- IS_HAS_FILTER
		case when (i.status & 0x20000) != 0 then object_definition(i.id, i.indid, 7) else NULL end AS filter_definition, -- x_euncIndex
		case when (i.type = 5 or i.type = 6) and objval.value is null
			then 
				case when obj.status2 & 0x00000008 != 0 -- OBJTAB2_HEKATON
					then 60 -- default for HEKATON
					else 0 -- default for disk based columnstore indexes
				end
			else cast(objval.value as int) 
		end as compression_delay, -- compression_delay
		sysconv(bit, i.status & 0x1000000) AS suppress_dup_key_messages,	-- IS_IND_DPKEYMSG
		sysconv(bit, i.status & 0x08000000) AS auto_created	-- IS_IND_AUTO_CREATED
	FROM sys.sysidxstats i
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = i.id AND ds.class = 7 AND ds.depsubid = i.indid	-- SRC_INDEXTODS
	LEFT JOIN sys.syspalvalues n ON n.class = 'IDXT' and n.value = i.type
	INNER JOIN sys.sysschobjs$ obj ON obj.id = i.id
	LEFT JOIN sys.sysobjvalues objval ON objval.valclass = 124 AND i.id = objval.objid AND i.indid = objval.subobjid AND objval.valnum = 0 -- SVC_COLUMNSTORE_INDEX_ATTRIBUTES = 124; VALNUM_COMPRESSION_DELAY = 0
	WHERE (i.status & 1) <> 0
		AND has_access('CO', i.id) = 1		-- IS_INDEX
		AND (i.status & 0x04000000) = 0		-- !IS_IND_RESUMABLE
"
576	Parse Tree	View	-169782400	32767	1	4	1	1	5	251	0	1	1024	0	0	0	0	0	622	"CREATE VIEW sys.dm_os_performance_counters AS
	SELECT
		object_name, counter_name, instance_name, cntr_value, cntr_type
	FROM OpenRowSet(TABLE SYS_PERFORMANCE_COUNTERS)
	UNION All
	SELECT
		object_name, counter_name, instance_name, cntr_value, cntr_type
	FROM OpenRowset(TABLE XTP_PERFORMANCE_COUNTERS)
"
576	Parse Tree	View	-169782400	32767	6	4	1	10	5	251	0	1	1024	0	0	0	0	0	622	"CREATE VIEW sys.dm_os_performance_counters AS
	SELECT
		object_name, counter_name, instance_name, cntr_value, cntr_type
	FROM OpenRowSet(TABLE SYS_PERFORMANCE_COUNTERS)
	UNION All
	SELECT
		object_name, counter_name, instance_name, cntr_value, cntr_type
	FROM OpenRowset(TABLE XTP_PERFORMANCE_COUNTERS)
"
580	Parse Tree	View	-958234993	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	424	"CREATE view sys.dm_repl_tranhash
as
	SELECT 
		[buckets]
		,[hashed_trans]
		,[completed_trans]
		,[compensated_trans]
		,[first_begin_lsn]
		,[last_commit_lsn]
	FROM OpenRowset(TABLE DM_REPL_TRANHASH)
"
582	Parse Tree	View	-1042966623	32767	6	4	1	2	10	251	0	1	1024	0	0	0	0	0	256	"
-- add it
create view sys.dm_pdw_nodes_os_schedulers as
select *, convert(int, null) pdw_node_id from sys.dm_os_schedulers
"
587	Parse Tree	View	-142535607	32767	6	4	1	10	5	251	0	1	1024	0	0	0	0	0	676	"
-- add it
create view sys.dm_pdw_exec_connections as
select
	session_id		collate database_default session_id,
	connect_time,
	encrypt_option	collate database_default encrypt_option,
	auth_scheme		collate database_default auth_scheme,
	client_id		collate database_default client_id,
	sql_spid
from sys._dm_pdw_exec_connections
"
594	Parse Tree	View	-441193657	32767	1	4	1	4	9	251	0	1	1024	0	0	0	0	0	1318	"CREATE VIEW sys.configurations$ AS
	SELECT p.id AS configuration_id,
		p.name,
		v.value,
		convert(sql_variant, p.minval) AS minimum,
		convert(sql_variant, p.maxval) AS maximum,
		convert(sql_variant, p.value) AS value_in_use,
		p.description,
		sysconv(bit, p.status & 1) AS is_dynamic,	-- x_eco_Dynamic
		sysconv(bit, p.status & 2) AS is_advanced,	-- x_eco_Advanced
		sysconv(bit, p.status & 4) AS is_not_use,	-- x_ecio_NotSupported or x_ecio_Deprecated
		p.defval as default_value
	FROM OpenRowset(TABLE CFGPROP) p
	LEFT JOIN master.sys.sysobjvalues v ON v.valclass = 50 AND v.objid = p.id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_CONFIG
"
595	Parse Tree	View	-657753107	32767	6	4	1	16	93	251	0	1	1024	0	0	0	0	0	16120	"
CREATE VIEW sys.dm_db_uncontained_entities
AS
	-- The class values correspond to the UNC classes defined in sys.syspalvalues.
	SELECT V.class, U.name as class_desc, V.major_id, V.statement_line_number, V.statement_offset_begin, V.statement_offset_end, V.statement_type, V.feature_name, V.feature_type_name
	FROM
	(
		-- Check for breachings features in USER_TABLES (and its computed columns), CHECK_CONSTRAINTS, DEFAULT CONSTRAINTS (skipping old-style defaults) and TYPE_TABLE.
		-- class = 1: OBJECT_OR_COLUMN
		SELECT 1 AS class, X.object_id AS major_id, DMV.statement_line_number, DMV.statement_offset_begin, DMV.statement_offset_end, DMV.statement_type, DMV.feature_name, DMV.feature_type_name
		FROM
		(
			SELECT Obj.object_id FROM sys.objects Obj WHERE (Obj.type = 'U' OR Obj.type = 'C' OR ( Obj.type = 'D' AND Obj.parent_object_id <> 0) OR Obj.type ='TT')			
		) X
		CROSS APPLY OPENROWSET(TABLE DM_DB_MODULE_CONTAINMENT_BREACHING_FEATURES, X.object_id, 0, 0) DMV
	
		UNION ALL

		-- Add Hekaton tables and procs.
		-- Hekaton is only available on 64 bit versions of the server, and requires the processor to support the interlock_exchange_128 operation. 
		-- CDBs do not (yet) have a way to express the requirement that the server meets architectural requirements. Therefore, using Hekaton breaches 
		-- containment, and all Hekaton objects are marked as uncontained.
		SELECT 1 AS class, Tlb.object_id AS major_id, NULL, NULL, NULL, NULL, N'MemoryOptimizedTable' COLLATE Latin1_General_CI_AS_KS_WS, N'Memory optimized table' COLLATE Latin1_General_CI_AS_KS_WS
		FROM sys.tables Tlb INNER JOIN sys.objects Obj ON Tlb.object_id=Obj.object_id WHERE Tlb.is_memory_optimized=1
		UNION ALL
		SELECT 1 AS class, Tlb.object_id AS major_id, NULL, NULL, NULL, NULL, N'NativelyCompiledProc' COLLATE Latin1_General_CI_AS_KS_WS, N'Natively compiled stored procedure' COLLATE Latin1_General_CI_AS_KS_WS
		FROM sys.sql_modules Tlb INNER JOIN sys.objects Obj ON Tlb.object_id=Obj.object_id WHERE Tlb.uses_native_compilation=1
        
		UNION ALL

		-- modules, excluding database level DDL triggers
		-- Collation of the class_desc column follows collation of the name column in sys.syspalvalues table 
		-- since these class names are stored there.
		-- 
		SELECT 1 AS class, X.object_id AS major_id, DMV.statement_line_number, DMV.statement_offset_begin, DMV.statement_offset_end, DMV.statement_type, DMV.feature_name, DMV.feature_type_name
		FROM
		(
			-- Ignore database level DDL triggers by joining with sys.objects. We will handle them below
			-- since they are a different UNC class
			SELECT Mod.object_id, CASE Obj.type WHEN 'P ' THEN 1 ELSE 0 END AS subobjid 
			FROM sys.sql_modules Mod INNER JOIN sys.objects Obj ON Mod.object_id=Obj.object_id
		) X
		CROSS APPLY OPENROWSET(TABLE DM_DB_MODULE_CONTAINMENT_BREACHING_FEATURES, X.object_id, X.subobjid, 0) DMV

		UNION ALL

		-- Check for breaching features in non-schemabound security policy predicate definitions.
		SELECT 1 AS class, X.object_id AS major_id, DMV.statement_line_number, DMV.statement_offset_begin, DMV.statement_offset_end, DMV.statement_type, DMV.feature_name, DMV.feature_type_name
		FROM
		(
			SELECT Secpol.object_id, Secpreds.security_predicate_id as subobjid
			FROM sys.security_policies Secpol INNER JOIN sys.security_predicates Secpreds on Secpol.object_id = Secpreds.object_id where Secpol.is_schema_bound = 0
		) X
		CROSS APPLY OPENROWSET(TABLE DM_DB_MODULE_CONTAINMENT_BREACHING_FEATURES, X.object_id, X.subobjid, 0) DMV

		UNION ALL

		-- T-SQL DDL triggers
		-- class = 12: DATABASE_DDL_TRIGGER
		SELECT 12, T.object_id, DMV.statement_line_number, DMV.statement_offset_begin, DMV.statement_offset_end, DMV.statement_type, DMV.feature_name, DMV.feature_type_name
		FROM sys.triggers T 
		CROSS APPLY OPENROWSET(TABLE DM_DB_MODULE_CONTAINMENT_BR"
605	Parse Tree	View	-895863199	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	314	"CREATE VIEW sys.trigger_event_types AS
	SELECT type, type_name, parent_type
	FROM OpenRowset(TABLE event_notification_event_types)
	WHERE is_trigger = 1
"
606	Parse Tree	View	-708092877	32767	6	4	1	27	9	251	0	1	1024	0	0	0	0	0	272	"CREATE VIEW sys.dm_filestream_non_transacted_handles AS
    SELECT *
    FROM OpenRowset(TABLE DM_FILESTREAM_NON_TRANSACTED_HANDLES)
"
607	Parse Tree	View	-592	32767	6	4	1	2	9	251	0	1	1024	0	0	0	0	0	1918	"
-- add it
-- In SQL FE sys.pdw_index_mappings has union of two queries:
	-- 1. non-clustered index mapping stored in sys.sysobjvalues.
	-- 2. clustered index mapping stored in sys.indexes.
-- For DW Service this view is only used for memo generation purposes and
-- in SQL FE this view will also return data.
-- The view definition remains the same with 3 fields:
		-- Object_id int
		-- Index_id int
		-- physical_name sysname
create view sys.pdw_index_mappings as
select		
	si.object_id,
	si.index_id,
case so.valclass
		when 126 then  si.name				-- clustered index
		else convert(sysname, so.value)		-- non-clustered index
end
	collate database_default physical_name 
from
	sys.indexes si
join 
	sys.sysobjvalues so
on 
	so.objid = si.object_id
where
	so.valclass = 126 and so.valnum = 2 and si.index_id = 1	-- Clustered index of MPP table. 
or
	so.valclass = 133 and si.index_id > 1					-- Non-Clustered index of MPP table.
"
608	Parse Tree	View	-223	32767	6	4	1	17	13	251	0	1	1024	0	0	0	0	0	1584	"CREATE VIEW sys.sql_logins AS
	SELECT p.name,
		p.id AS principal_id,
		p.sid, p.type,
		n.name AS type_desc,
		sysconv(bit, p.status & 0x80) AS is_disabled,
		p.crdate AS create_date,
		p.modate AS modify_date,
		p.dbname AS default_database_name,
		p.lang AS default_language_name,
		r.indepid AS credential_id,
		sysconv(bit, p.status & 0x10000) AS is_policy_checked,
		sysconv(bit, p.status & 0x20000) AS is_expiration_checked,
		convert(varbinary(256), LoginProperty(p.name, 'PasswordHash')) AS password_hash
	FROM master.sys.sysxlgns p
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = p.id AND r.class = 63 AND r.depsubid = 0	-- SRC_LOGIN_CREDENTIAL
	LEFT JOIN sys.syspalnames n ON n.class = 'LGTY' AND n.value = p.type
	WHERE type = 'S'
		AND has_access('LG', id) = 1
"
616	Parse Tree	View	-272238489	32767	6	4	1	12	6	251	0	1	1024	0	0	0	0	0	848	"
-- add it
create view sys.dm_exec_distributed_sql_requests as
select
	execution_id	collate database_default execution_id,
	step_index,
	compute_node_id,
	distribution_id,
	status	collate database_default status,
	error_id	collate database_default error_id,
	start_time,
	end_time,
	total_elapsed_time,
	row_count,
	spid,
	command	collate database_default command
from sys._dm_exec_distributed_sql_requests
"
629	Parse Tree	View	-476	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	380	"CREATE VIEW sys.column_xml_schema_collection_usages AS
	SELECT id AS object_id,
		colid AS column_id,
		xmlns AS xml_collection_id
	FROM sys.syscolpars
	WHERE number = 0 AND xmlns > 0
"
630	Parse Tree	View	-107	32767	6	4	1	4	22	251	0	1	1024	0	0	0	0	0	2982	"CREATE VIEW sys.all_sql_modules AS
	SELECT *
	FROM sys.system_sql_modules

	UNION ALL

	SELECT object_id = o.id,
		definition = object_definition(o.id),
		uses_ansi_nulls = convert(bit, o.status & 0x40000), 			-- OBJMOD_ANSINULLS
		uses_quoted_identifier = convert(bit, o.status & 0x80000), 		-- OBJMOD_QUOTEDIDENT
		is_schema_bound = convert(bit, o.status & 0x20000), 			-- OBJMOD_SCHEMABOUND
		uses_database_collation = convert(bit, o.status & 0x100000), 	-- OBJMOD_USESDBCOLL
		is_recompiled = convert(bit, o.status & 0x400000), 				-- OBJMOD_NOCACHE
		null_on_null_input = convert(bit, o.status & 0x200000), 		-- OBJMOD_NULLONNULL
		execute_as_principal_id = x.indepid,
		uses_native_compilation = sysconv(bit, CASE WHEN (o.type = 'P') THEN o.status & 0x00000200	-- OBJPRC_HEKATON
												WHEN (o.type = 'FN') THEN o.status & 0x00000200		-- OBJPRC_HEKATON
												WHEN (o.type = 'TR') THEN o.status & 0x00001000		-- OBJTRG_HEKATON
												WHEN (o.type = 'IF') THEN o.status & 0x00000200		-- OBJPRC_HEKATON
												ELSE 0
												END)			
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs x ON x.depid = o.id AND x.class = 22 AND x.depsubid = 0 -- SRC_OBJEXECASOWNER
	WHERE o.pclass <> 100 -- x_eunc_Server
		AND ((o.type = 'TR' AND has_access('TR', o.id, o.pid, o.nsclass) = 1)
			OR (type IN ('P','V','FN','IF','TF','RF','IS') AND has_access('AO', o.id) = 1)
			OR (type IN ('R','D') AND o.pid = 0))
		AND has_access('CO', o.id) = 1
"
640	Parse Tree	View	-418	32767	6	4	1	6	6	251	0	1	1024	0	0	0	0	0	644	"CREATE VIEW sys.numbered_procedures AS
	SELECT object_id = v.objid,
		procedure_number = convert(smallint, v.subobjid),
		definition = object_definition(v.objid, v.subobjid)
	FROM sys.sysobjvalues v
	WHERE v.valclass = 1 AND v.subobjid > 1 AND v.valnum = 0 	-- SVC_OBJECTSQLEXPR
		AND has_access('CO', v.objid) = 1
"
645	Parse Tree	View	-367613366	32767	6	4	1	12	4	251	0	1	1024	0	0	0	0	0	434	"CREATE VIEW sys.dm_clr_tasks AS
	SELECT
		task_address,
		sos_task_address,
		appdomain_address,
		state,
		abort_state,
		type,
		affinity_count,
		forced_yield_count
	FROM OpenRowset(TABLE DM_CLR_TASKS) 
"
650	Parse Tree	View	-986174672	32767	6	3	1	54	32	251	0	1	1024	0	0	0	0	0	4932	"CREATE VIEW INFORMATION_SCHEMA.ROUTINE_COLUMNS
AS
SELECT
	DB_NAME()						AS TABLE_CATALOG,
	SCHEMA_NAME(o.schema_id)			AS TABLE_SCHEMA,
	o.name							AS TABLE_NAME,
	c.name							AS COLUMN_NAME,
	c.column_id						AS ORDINAL_POSITION,
	convert(nvarchar(4000),
		OBJECT_DEFINITION(c.default_object_id))			AS COLUMN_DEFAULT,
	convert(varchar(3),
		CASE WHEN c.is_nullable = 1 THEN 'YES'
		ELSE 'NO' END)				AS IS_NULLABLE,
	ISNULL(TYPE_NAME(c.system_type_id), t.name)		AS DATA_TYPE,
	COLUMNPROPERTY(c.object_id, c.name, 'charmaxlen')	AS CHARACTER_MAXIMUM_LENGTH,
	COLUMNPROPERTY(c.object_id, c.name, 'octetmaxlen')	AS CHARACTER_OCTET_LENGTH,
	convert(tinyint, CASE -- int/decimal/numeric/real/float/money
		WHEN c.system_type_id IN (48, 52, 56, 59, 60, 62, 106, 108, 122, 127) THEN c.precision
		END)										AS NUMERIC_PRECISION,
	convert(smallint, CASE	-- int/money/decimal/numeric
		WHEN c.system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
		WHEN c.system_type_id IN (59, 62) THEN 2 END)	AS NUMERIC_PRECISION_RADIX, -- real/float
	convert(int, CASE	-- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN NULL
		ELSE ODBCSCALE(c.system_type_id, c.scale) END)	AS NUMERIC_SCALE,
	convert(smallint, CASE -- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN ODBCSCALE(c.system_type_id, c.scale) END)	AS DATETIME_PRECISION,
	convert( sysname, null)					AS CHARACTER_SET_CATALOG,
	convert( sysname, null) collate catalog_default			AS CHARACTER_SET_SCHEMA,
	convert( sysname, CASE
		WHEN c.system_type_id IN (35, 167, 175)	-- char/varchar/text
		THEN COLLATIONPROPERTY(c.collation_name, 'sqlcharsetname')
		WHEN c.system_type_id IN (99, 231, 239)	-- nchar/nvarchar/ntext
		THEN N'UNICODE'	END)				AS CHARACTER_SET_NAME,
	convert(sysname, null)					AS COLLATION_CATALOG,
	convert(sysname, null) collate catalog_default		AS COLLATION_SCHEMA,
	c.collation_name					AS COLLATION_NAME,
	convert(sysname,
		CASE WHEN c.user_type_id > 256
		THEN DB_NAME() END)				AS DOMAIN_CATALOG,
	convert(sysname,
		CASE WHEN c.user_type_id > 256 THEN
		SCHEMA_NAME(t.schema_id) END)			AS DOMAIN_SCHEMA,
	convert(sysname,
		CASE WHEN c.user_type_id > 256 THEN
		TYPE_NAME(c.user_type_id) END)			AS DOMAIN_NAME
FROM
	sys.objects o JOIN sys.columns c ON c.object_id = o.object_id
	LEFT JOIN sys.types t ON c.user_type_id = t.user_type_id
WHERE
	o.type IN ('TF','IF', 'FT')
"
663	Parse Tree	View	-212971808	32767	6	4	1	9	23	251	0	1	1024	0	0	0	0	0	2814	"CREATE VIEW sys.dm_exec_procedure_stats AS
	SELECT 
		database_id,
		object_id,
		type,
		n.name AS type_desc,
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,	
		max_worker_time,
		total_physical_reads,
		last_physical_reads,
		min_physical_reads,
		max_physical_reads,
		total_logical_writes,
		last_logical_writes,
		min_logical_writes,
		max_logical_writes,
		total_logical_reads,
		last_logical_reads,
		min_logical_reads,
		max_logical_reads,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time,
		total_spills,
		last_spills,
		min_spills,
		max_spills
	FROM OpenRowset (TABLE PROC_STATS) o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' 
		AND n.value = o.type
	UNION ALL
	SELECT 
		database_id,
		object_id,
		CAST ('P' AS CHAR(2)),
		CAST ('SQL_STORED_PROCEDURE' AS NVARCHAR(60)),
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,	
		max_worker_time,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time,
		NULL,
		NULL,
		NULL,
		NULL
	FROM OpenRowset (TABLE XTP_PROC_STATS, ASCII('P') + (ASCII(' ') * 256))
"
673	Parse Tree	View	-244	32767	6	4	1	1	29	251	0	1	1024	0	0	0	0	0	3194	"CREATE VIEW sys.sac_state AS
	SELECT component_name,
		convert(sysname, N'mssqlsystemresource') collate catalog_default AS database_name,
		schema_name collate catalog_default AS schema_name,
		object_name collate catalog_default AS object_name,
		state, type
	FROM sys.obd_state
	UNION ALL
	SELECT convert(sysname, c.name) AS component_name,
		convert(sysname, N'master') collate catalog_default AS database_name,
		s.name collate catalog_default AS schema_name,
		o.name collate catalog_default AS object_name,
		convert(tinyint, convert(int, c.value) & 1) AS state,
		o.type
	FROM master.sys.sysobjkeycrypts k
	JOIN master.sys.sysschobjs$ o ON o.id = k.id
	JOIN master.sys.sysxlgns l ON l.type = 'M' AND substring(l.sid, 13, 28) = k.thumbprint
	JOIN master.sys.configurations c ON c.name = substring(l.name, 3, len(l.name) - 4)
	LEFT JOIN master.sys.schemas s ON s.schema_id = o.nsid
	WHERE k.class = 1 AND k.type = 'INCP'
	UNION ALL
	SELECT convert(sysname, c.name) AS component_name,
		convert(sysname, N'msdb') collate catalog_default AS database_name,
		s.name collate catalog_default AS schema_name,
		o.name collate catalog_default AS object_name,
		convert(tinyint, convert(int, c.value) & 1) AS state,
		o.type
	FROM msdb.sys.sysobjkeycrypts k
	JOIN msdb.sys.sysschobjs$ o ON o.id = k.id
	JOIN master.sys.sysxlgns l ON l.type = 'M' AND substring(l.sid, 13, 28) = k.thumbprint
	JOIN master.sys.configurations c ON c.name = substring(l.name, 3, len(l.name) - 4)
	LEFT JOIN msdb.sys.schemas s ON s.schema_id = o.nsid
	WHERE k.class = 1 AND k.type = 'INCP'
"
685	Parse Tree	View	-611131535	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	710	"CREATE VIEW sys.dm_external_script_requests AS
 	SELECT 
		external_script_request_id,
		[language] = 
			CAST (CASE script_type
				WHEN 0 THEN 'Test'
				WHEN 1 THEN 'R'
				WHEN 2 THEN 'Python'
				ELSE 'Not Supported'
			END AS nvarchar(128)),
		degree_of_parallelism,
		external_user_name

	FROM OpenRowSet(TABLE DM_EXTSCRIPT_REQUESTS)
"
690	Parse Tree	View	-758722827	32767	6	4	1	17	7	251	0	1	1024	0	0	0	0	0	1204	"CREATE VIEW sys.availability_groups AS
	SELECT 
		group_id = ags.group_id,
		name = CONVERT(sysname, ags.name),
		resource_id = CAST(ags.resource_id AS nvarchar(40)),
		resource_group_id = CAST(ags.resource_group_id AS nvarchar(40)),
		failure_condition_level,
		health_check_timeout,
		automated_backup_preference,
		automated_backup_preference_desc,
		version,
		basic_features,
		dtc_support,
		db_failover,
		is_distributed,
		cluster_type,
		cluster_type_desc,
		required_synchronized_secondaries_to_commit,
		sequence_number
	FROM OpenRowset(TABLE DM_AVAILABILITY_GROUPS) ags
"
691	Parse Tree	View	-551361778	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	220	"CREATE VIEW sys.dm_os_memory_broker_clerks AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_MEMORY_BROKER_CLERKS)
"
694	Parse Tree	View	-497	32767	6	4	1	17	22	251	0	1	1024	0	0	0	0	0	3658	"CREATE VIEW sys.spatial_indexes AS
	SELECT i.id AS object_id,
		i.name AS name,
		i.indid AS index_id,
		i.type,
		n.name AS type_desc,
		sysconv(bit, i.status & 0x8) AS is_unique,			-- IS_IND_UNIQUE
		isnull(ds.indepid, 1) AS data_space_id,
		sysconv(bit, i.status & 0x4) AS ignore_dup_key,		-- IS_IND_DPKEYS
		sysconv(bit, i.status & 0x20) AS is_primary_key,		-- IS_IND_PRIMARY
		sysconv(bit, i.status & 0x40) AS is_unique_constraint,	-- IS_IND_UNIQUE_CO
		i.fillfact AS fill_factor,
		sysconv(bit, i.status & 0x10) AS is_padded,				-- IS_IND_PADINDEX
		sysconv(bit, i.status & 0x80) AS is_disabled,			-- IS_IND_OFFLINE
		sysconv(bit, i.status & 0x100) AS is_hypothetical,		-- IS_IND_ITWINDEX
		sysconv(bit, i.status & 0x02000000) AS is_ignored_in_optimization,	-- IS_IND_IGNORE_IN_OPTIMIZATION
		sysconv(bit, 1 - (i.status & 512)/512) AS allow_row_locks,		-- IS_IND_NO_ROWLOCK
		sysconv(bit, 1 - (i.status & 1024)/1024) AS allow_page_locks,	-- IS_IND_NO_PAGELOCK
		i.intprop AS spatial_index_type,
		ei.name AS spatial_index_type_desc,
		tes.name AS tessellation_scheme,
		sysconv(bit, 0) AS has_filter,
		convert(nvarchar(max), NULL) AS filter_definition,
		sysconv(bit, i.status & 0x08000000) AS auto_created	-- IS_IND_AUTO_CREATED
	FROM sys.sysidxstats i
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = i.id AND ds.class = 7 AND ds.depsubid = i.indid	-- SRC_INDEXTODS	
	LEFT JOIN sys.syspalvalues n ON n.class = 'IDXT' and n.value = i.type
	LEFT JOIN sys.syspalvalues ei ON ei.class = 'EITP' and ei.value = i.intprop
	LEFT JOIN sys.syspalvalues tes ON tes.class = 'EISP' and tes.value = i.intprop
	WHERE i.indid >= 384000 and i.indid < 512000 --indid greater and equal than x_MDIndexStatsId_MinExtended(384000) and less than x_MDIndexStatsId_MinTemp(512000)
		AND has_access('CO', i.id) = 1
"
698	Parse Tree	View	-331951768	32767	6	4	1	6	12	251	0	1	1024	0	0	0	0	0	916	"
-- add it
create view sys.dm_pdw_exec_queryplan_profiles as
select
   	convert(int, null) pdw_node_id,
	*
from
	(select session_id, sql_handle, plan_handle from sys.dm_exec_query_profiles group by session_id, sql_handle, plan_handle) T1
	cross apply
	(select text from sys.dm_exec_sql_text(T1.sql_handle) QueryText) T2
	cross apply
	(select cast(query_plan as nvarchar(max)) as query_plan from sys.dm_exec_query_plan(T1.plan_handle) PlanXml) T3
"
705	Parse Tree	View	-439	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	456	"CREATE VIEW sys.destination_data_spaces AS
	SELECT depid AS partition_scheme_id,
		depsubid AS destination_id,
		indepid AS data_space_id
	FROM sys.syssingleobjrefs
	WHERE class = 30 AND indepsubid = 0 -- SRC_PRTSCHDSLIST
"
717	Parse Tree	View	-1039848107	32767	6	4	1	14	4	251	0	1	1024	0	0	0	0	0	234	"CREATE VIEW sys.dm_xe_session_object_columns AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_SESSION_OBJECT_COLUMNS,0) 
"
726	Parse Tree	View	-951091328	32767	6	4	1	9	3	251	0	1	1024	0	0	0	0	0	186	"CREATE view sys.dm_hadr_cluster 
as
	SELECT 
	*
	FROM OpenRowset(TABLE DM_HADR_CLUSTER)
"
731	Parse Tree	View	-495130372	32767	6	4	1	7	30	251	0	1	1024	0	0	0	0	0	5462	"CREATE VIEW sys.dm_db_partition_stats AS
	WITH partition_stats_rowstore(
		partition_id, object_id, index_id, partition_number,
		in_row_data_page_count, in_row_used_page_count, in_row_reserved_page_count,
		lob_used_page_count, lob_reserved_page_count,
		row_overflow_used_page_count, row_overflow_reserved_page_count,
		used_page_count, reserved_page_count, row_count)
	AS
	(
	SELECT
		c.partition_id,	i.object_id, i.index_id, c.partition_number,
		c.in_row_data_page_count, c.in_row_used_page_count, c.in_row_reserved_page_count,
		c.lob_used_page_count, c.lob_reserved_page_count,
		c.row_overflow_used_page_count, c.row_overflow_reserved_page_count,
		c.used_page_count, c.reserved_page_count, c.row_count
	FROM sys.indexes$ i CROSS APPLY OpenRowSet(TABLE PARTITIONCOUNTS, i.object_id, i.index_id, i.rowset) c
	WHERE i.type NOT IN (5, 6) -- Exclude columnstore indexes
		AND (i.index_id != 0
			OR OBJECTPROPERTY(i.[object_id], 'TableIsMemoryOptimized') = 0) -- Hiding heap index for hekaton tables
	)
	
	-- Result is a union of rowstore and columnstore partitions.
	
	SELECT * from partition_stats_rowstore
	
	UNION ALL

	-- For columnstore the total rows in a partition is sum of the rows in
	-- compressed row groups, deltastores, minus the rows in delete buffer and delete bitmap.
	SELECT
		MAX(CASE WHEN sip.ownertype = 1 THEN sip.partition_id ELSE CAST(0 AS bigint) END)
				AS partition_id,
		sip.object_id AS object_id,
		sip.index_id AS index_id,
		sip.partition_number AS partition_number,
		SUM(c.in_row_data_page_count) AS in_row_data_page_count,
		SUM(c.in_row_used_page_count) AS in_row_used_page_count,
		SUM(c.in_row_reserved_page_count) AS in_row_reserved_page_count,
		SUM(c.lob_used_page_count) AS lob_used_page_count,
		SUM(c.lob_reserved_page_count) AS lob_reserved_page_count,
		SUM(c.row_overflow_used_page_count) AS row_overflow_used_page_count,
		SUM(c.row_overflow_reserved_page_count) AS row_overflow_reserved_page_count,
		SUM(c.used_page_count) AS used_page_count,
		SUM(c.reserved_page_count) AS reserved_page_count,
		SUM(CASE -- ownertype 2 corresponds to delete bitmaps and 4 to delete buffers
			WHEN ownertype IN (2,4) THEN -(c.row_count) -- Flip sign of deleted bitmaps and delete buffers
			ELSE c.row_count -- delta stores are ownertype 3 and included here.
			END)
			AS row_count
		FROM sys.system_internals_partitions sip CROSS APPLY OpenRowSet(TABLE PARTITIONCOUNTS, sip.object_id, sip.index_id, sip.partition_id) c
		WHERE sip.ownertype IN (2,3,4) OR (sip.ownertype = 1 and sip.is_columnstore = 1)-- delete bitmaps, delta stores, delete buffers and compressed row groups
	GROUP BY sip.object_id, sip.index_id, sip.partition_number
"
735	Parse Tree	View	-463391397	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	268	"
-- add it
create view sys.dm_pdw_nodes_os_waiting_tasks as
select *, convert(int, null) pdw_node_id from sys.dm_os_waiting_tasks
"
738	Parse Tree	View	-265	32767	6	4	1	8	6	251	0	1	1024	0	0	0	0	0	568	"CREATE VIEW sys.database_filestream_options AS
	SELECT d.id as database_id, p.non_transacted_access, p.non_transacted_access_desc, p.directory_name
	FROM master.sys.sysdbreg d 
		CROSS APPLY OpenRowset(TABLE DATABASE_FILESTREAM_OPTIONS, d.id) p
	WHERE has_access('DB', d.id) = 1
"
741	Compiled Plan	Adhoc	862694377	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_tran_current_transaction t
749	Parse Tree	View	-207	32767	6	4	1	5	7	251	0	1	1024	0	0	0	0	0	744	"CREATE VIEW sys.sysoledbusers AS
	SELECT
		rmtsrvid = convert(smallint, r.server_id),
		rmtloginame = r.remote_name,
		rmtpassword = convert(sysname, null),
		loginsid = p.sid,
		status = convert(smallint, r.uses_self_credential),
		changedate = r.modify_date
	FROM sys.linked_logins r
	LEFT JOIN sys.server_principals p ON r.local_principal_id = p.principal_id
"
759	Parse Tree	View	-518	32767	6	4	1	3	40	251	0	1	1024	0	0	0	0	0	5642	"CREATE VIEW sys.column_store_segments
AS
	SELECT s.hobt_id as partition_id,
		s.hobt_id,
		c.rscolid as column_id,
		s.segment_id,
		s.version,
		s.encoding_type,
		s.row_count,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then sysconv(bit, s.status & 1) else NULL end) as has_nulls,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then s.base_id else NULL end) as base_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then s.magnitude else NULL end) as magnitude,
		s.primary_dictionary_id,
		s.secondary_dictionary_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then s.min_data_id else NULL end) as min_data_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then s.max_data_id else NULL end) as max_data_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(p.idmajor) + '.' + OBJECT_NAME(p.idmajor), 'OBJECT', 'SELECT') = 1 then s.null_value else NULL end) as null_value,
		s.on_disk_size
	FROM sys.syscscolsegments s
	INNER JOIN sys.sysrowsets p ON s.hobt_id = p.rowsetid
	INNER JOIN sys.sysrscols c ON s.hobt_id = c.rsid and s.column_id = c.hbcolid
	WHERE has_access('CO', p.idmajor) = 1	
	
	UNION ALL
	
	SELECT sg.partition_id,
		sg.hobt_id,
		sg.column_id,
		sg.segment_id,
		sg.version,
		sg.encoding_type,
		sg.row_count,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.has_nulls else NULL end) as has_nulls,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.base_id else NULL end) as base_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.magnitude else NULL end) as magnitude,
		sg.primary_dictionary_id,
		sg.secondary_dictionary_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.min_data_id else NULL end) as min_data_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.max_data_id else NULL end) as max_data_id,
		(case when has_perms_by_name(OBJECT_SCHEMA_NAME(sg.object_id) + '.' + OBJECT_NAME(sg.object_id), 'OBJECT', 'SELECT') = 1 then sg.null_value else NULL end) as null_value,				
		sg.on_disk_size
	FROM OpenRowset(TABLE HKCS_SEGMENTS) sg
	WHERE has_access('CO', sg.object_id) = 1
"
760	Parse Tree	View	-149	32767	1	4	1	2	19	251	0	1	1024	0	0	0	0	0	3316	"CREATE VIEW sys.system_columns$ AS
	SELECT id AS object_id, name, colid AS column_id,
		xtype AS system_type_id, utype AS user_type_id,
		length AS max_length, prec AS precision, scale,
		sysconv(bit, 1 - (status & 1)) AS is_nullable,
		sysconv(bit, status & 2) AS is_ansi_padded,
		sysconv(bit, 0) AS is_rowguidcol,
		sysconv(bit, 0) AS is_identity,
		sysconv(bit, 0) AS is_computed,
		sysconv(bit, 0) AS is_filestream,
		sysconv(bit, 0) AS is_replicated,
		sysconv(bit, 0) AS is_non_sql_subscribed,
		sysconv(bit, 0) AS is_merge_published,
		sysconv(bit, 0) AS is_dts_replicated,
		sysconv(bit, 0) AS is_xml_document,
		sysconv(int, 0) AS xml_collection_id,
		sysconv(int, 0) AS default_object_id,
		sysconv(int, 0) AS rule_object_id,
		sysconv(bit, 0) AS is_sparse,
		sysconv(bit, 0) AS is_column_set,
		convert(tinyint, 0) AS generated_always_type,
		convert(nvarchar(60), 'NOT_APPLICABLE') COLLATE Latin1_General_CI_AS_KS_WS AS generated_always_type_desc,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) as column_encryption_key_database_name,
		sysconv(bit, 0) AS is_hidden,
		sysconv(bit, 0) AS is_masked,
		convert(int, NULL) AS graph_type,
		convert(nvarchar(60), NULL) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars
	WHERE number = 0 AND (status & 4096) = 4096
		  AND (serverproperty('EngineEdition') != 5 OR (status & 0x08000000) != 0)
"
760	Parse Tree	View	-149	32767	6	4	1	3	19	251	0	1	1024	0	0	0	0	0	3316	"CREATE VIEW sys.system_columns$ AS
	SELECT id AS object_id, name, colid AS column_id,
		xtype AS system_type_id, utype AS user_type_id,
		length AS max_length, prec AS precision, scale,
		sysconv(bit, 1 - (status & 1)) AS is_nullable,
		sysconv(bit, status & 2) AS is_ansi_padded,
		sysconv(bit, 0) AS is_rowguidcol,
		sysconv(bit, 0) AS is_identity,
		sysconv(bit, 0) AS is_computed,
		sysconv(bit, 0) AS is_filestream,
		sysconv(bit, 0) AS is_replicated,
		sysconv(bit, 0) AS is_non_sql_subscribed,
		sysconv(bit, 0) AS is_merge_published,
		sysconv(bit, 0) AS is_dts_replicated,
		sysconv(bit, 0) AS is_xml_document,
		sysconv(int, 0) AS xml_collection_id,
		sysconv(int, 0) AS default_object_id,
		sysconv(int, 0) AS rule_object_id,
		sysconv(bit, 0) AS is_sparse,
		sysconv(bit, 0) AS is_column_set,
		convert(tinyint, 0) AS generated_always_type,
		convert(nvarchar(60), 'NOT_APPLICABLE') COLLATE Latin1_General_CI_AS_KS_WS AS generated_always_type_desc,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) as column_encryption_key_database_name,
		sysconv(bit, 0) AS is_hidden,
		sysconv(bit, 0) AS is_masked,
		convert(int, NULL) AS graph_type,
		convert(nvarchar(60), NULL) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars
	WHERE number = 0 AND (status & 4096) = 4096
		  AND (serverproperty('EngineEdition') != 5 OR (status & 0x08000000) != 0)
"
770	Parse Tree	View	-460	32767	6	4	1	7	10	251	0	1	1024	0	0	0	0	0	1162	"CREATE VIEW sys.remote_service_bindings AS
	SELECT name = r.name,
		remote_service_binding_id = r.id,
		principal_id = p.indepid,
		remote_service_name = r.remsvc,
		service_contract_id = r.scid,
		remote_principal_id = m.indepid,
		is_anonymous_on = sysconv(bit, r.status & 1)		--RSB_ANON_ACCESS
	FROM sys.sysremsvcbinds r
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = r.id AND p.class = 48 AND p.depsubid = 0	-- SRC_RSBOWNER
	LEFT JOIN sys.syssingleobjrefs m ON m.depid = r.id AND m.class = 24 AND m.depsubid = 0	-- SRC_RSB_REMUSER
	WHERE has_access('RS', r.id) = 1
"
779	Parse Tree	View	-732648222	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	190	"CREATE VIEW sys.dm_server_registry AS
	SELECT *
	FROM OpenRowset(TABLE DM_SERVER_REGISTRY) 
"
779	Parse Tree	View	-643693676	32767	6	4	1	17	5	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_broker_forwarded_messages AS
	SELECT * FROM OpenRowset (TABLE SBFORWARDEDMESSAGES)
"
780	Parse Tree	View	-188220393	32767	6	4	1	35	11	251	0	1	1024	0	0	0	0	0	1590	"CREATE view sys.dm_repl_traninfo
as
	SELECT 
		[fp2p_pub_exists]
		,[db_ver]
		,[comp_range_address]
		,[textinfo_address]
		,[fsinfo_address]
		,[begin_lsn]
		,[commit_lsn]
		,[dbid]
		,[rows]
		,[xdesid]
		,[artcache_table_address]
		,[server]
		,[server_len_in_bytes]
		,[database]
		,[db_len_in_bytes]
		,[originator]
		,[originator_len_in_bytes]
		,[orig_db]
		,[orig_db_len_in_bytes]
		,[cmds_in_tran]
		,[is_boundedupdate_singleton]
		,[begin_update_lsn]
		,[delete_lsn]
		,[last_end_lsn]
		,[fcomplete]
		,[fcompensated]
		,[fprocessingtext]
		,[max_cmds_in_tran]
        ,[begin_time]
        ,[commit_time]
        ,[session_id]
        ,[session_phase]
        ,[is_known_cdc_tran]
        ,[error_count]
	FROM OpenRowset(TABLE DM_REPL_TRANINFO)
"
781	Parse Tree	View	-402	32767	6	4	1	8	19	251	0	1	1024	0	0	0	0	0	2942	"CREATE VIEW sys.stats AS
	SELECT id AS object_id, name,
		indid AS stats_id,
		sysconv(bit, status & 0x2000) AS auto_created,	-- IS_STATS_AUTO_CRT
		sysconv(bit, case when (status & 0x2001) = 0 then 1 else 0 end) AS user_created,
	  	sysconv(bit, status & 0x4000) AS no_recompute,	-- IS_STATS_NORECOMP
		sysconv(bit, status & 0x20000) AS has_filter,	-- IS_HAS_FILTER
		case when (status & 0x20000) != 0 then object_definition(id, indid, 9) else NULL end AS filter_definition, -- x_euncStats
		convert(bit, 0) as is_temporary,
		sysconv(bit, status & 0x800000) AS is_incremental
	FROM sys.sysidxstats s 
	WHERE (status & 2)  = 2			-- IS_STATS
		AND has_access('CO', id) = 1
		AND indid NOT IN 
        (
            SELECT t.valnum as stats_id
            FROM tempstatvals t
            WHERE t.valnum < 0x40000
                AND t.subobjid = s.id
        )
        AND (s.status & 0x04000000) = 0 -- !IS_IND_RESUMABLE
    UNION ALL
    SELECT	t.subobjid as object_id,
    		v.name COLLATE catalog_default AS name,
    		t.valnum as stats_id,
    		v.auto_created, 
    		v.user_created,
    		v.no_recompute,
    		convert(bit, 0) as has_filter,
    		'' as filter_definition,
    		convert(bit, 1) as is_temporary,
    		convert(bit, 0) as is_incremental
    FROM	tempstatvals t   
    		OUTER APPLY 
    		OPENROWSET(TABLE TEMPSTATS, t.objid, t.subobjid, t.valnum, convert(bit, 0)) v 
    WHERE 	has_access('CO', t.subobjid) = 1 
"
783	Parse Tree	View	-430121581	32767	6	4	1	1	4	251	0	1	1024	0	0	0	0	0	294	"CREATE FUNCTION sys.dm_exec_query_plan(@handle varbinary(64))
RETURNS TABLE
AS
	RETURN SELECT * FROM OPENROWSET(TABLE FNGETQUERYPLAN, @handle)
"
803	Compiled Plan	Adhoc	948100266	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_exec_external_operations t
807	Parse Tree	View	-91395306	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	312	"
-- add it
create view sys.dm_pdw_nodes_os_memory_node_access_stats as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_node_access_stats
"
814	Parse Tree	View	-228	32767	6	4	1	15	17	251	0	1	1024	0	0	0	0	0	1824	"CREATE VIEW sys.tcp_endpoints AS
	SELECT e.name,
		e.id AS endpoint_id,
		o.indepid AS principal_id,
		e.protocol, p.name AS protocol_desc,
		e.type, t.name AS type_desc,
		convert(tinyint, e.bstat & 3) AS state,	-- BSTAT_STATEMASK
		s.name AS state_desc,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		e.port1 AS port,
		sysconv(bit, e.pstat & 1) AS is_dynamic_port,	-- PSTAT_TCP_DYNAMICPORT
		convert(varchar(45), e.site) AS ip_address
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	WHERE e.protocol = 2
		AND has_access('HE', e.id) = 1
"
819	Parse Tree	View	-215103612	32767	6	4	1	24	10	251	0	1	1024	0	0	0	0	0	158	"CREATE VIEW sys.dm_os_sys_info AS
	SELECT *
	FROM OpenRowset(TABLE SYSINFO)
"
821	Parse Tree	View	-623441214	32767	6	4	1	12	5	251	0	1	1024	0	0	0	0	0	870	"
-- add it
create view sys.dm_pdw_component_health_active_alerts as
select
	pdw_node_id,
	component_id,
	component_instance_id	collate database_default component_instance_id,
	alert_id,
	alert_instance_id	collate database_default alert_instance_id,
	current_value	collate database_default current_value,
	previous_value	collate database_default previous_value,
	create_time
from sys._dm_pdw_component_health_active_alerts
"
824	Parse Tree	View	-539	32767	6	4	1	5	7	251	0	1	1024	0	0	0	0	0	1686	"CREATE VIEW sys.query_store_query_text AS
	SELECT
		qt.query_text_id,
		qt.query_sql_text,
		CAST(qt.statement_sql_handle AS VARBINARY(44)) AS statement_sql_handle,
		qt.is_part_of_encrypted_module,
		qt.has_restricted_text
	FROM sys.plan_persist_query_text qt WITH (NOLOCK) -- NOTE - in order to prevent potential deadlock between QDS_STATEMENT_STABILITY LOCK and index locks
	LEFT OUTER JOIN (
		SELECT TOP 0 
			query_text_id,
			query_sql_text,
			CAST(statement_sql_handle AS VARBINARY(44)) AS statement_sql_handle,
			is_part_of_encrypted_module,
			has_restricted_text
		FROM sys.plan_persist_query_text_in_memory) qt_in_mem ON	-- NOTE - join with STVF will enable view to have same security definitions as STVF
	qt_in_mem.query_text_id = qt.query_text_id						--        but plan will remove it since it is empty table
"
827	Parse Tree	View	-526177689	32767	6	4	1	7	4	251	0	1	1024	0	0	0	0	0	248	"CREATE VIEW sys.dm_filestream_file_io_requests AS
    SELECT *
    FROM OpenRowset(TABLE DM_FILESTREAM_FILE_IO_REQUESTS)
"
835	Parse Tree	View	-481	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	368	"CREATE VIEW sys.service_queue_usages AS
	SELECT depid AS service_id,
		indepid AS service_queue_id
	FROM sys.syssingleobjrefs
	WHERE class = 21 AND depsubid = 0	-- SRC_SVCTOQUEUE
"
839	Parse Tree	View	-212661765	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	338	"
-- add it
create view sys.dm_exec_dms_services as
select
	dms_core_id,
	compute_node_id,
	status	collate database_default status
from sys._dm_exec_dms_services
"
839	Parse Tree	View	-392289513	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	164	"create view sys.trace_columns as select * from OpenRowset(TABLE SYSTRACECOLUMNS)
"
841	Parse Tree	View	-1011912861	32767	6	4	1	13	8	251	0	1	1024	0	0	0	0	0	984	"CREATE VIEW sys.dm_audit_class_type_map AS
	SELECT reverse(convert(char(2), convert(binary(2), class_type))) as [class_type],
		(SELECT spt.name 
			from master.dbo.spt_values spt where spt.type='EOD' AND spt.number = CONVERT(smallint, cl.class_type)) as [class_type_desc],
		(SELECT spt.name 
			from master.dbo.spt_values spt where spt.type='EOD' AND spt.number = CONVERT(smallint, cl.securable_class_id)) as [securable_class_desc]
	FROM OpenRowset(TABLE DM_AUDIT_CLASS_TYPE_MAP) cl
"
846	Parse Tree	View	-423	32767	6	4	1	27	15	187	0	1	1024	0	0	0	0	0	2060	"CREATE VIEW sys.types AS
	SELECT t.name AS name,
		t.xtype AS system_type_id,
		t.id AS user_type_id,
		t.schid AS schema_id,
		o.indepid AS principal_id,
		t.length AS max_length,
		t.prec AS precision,
		t.scale AS scale,
		convert(sysname, collationpropertyfromid(t.collationid, 'name')) AS collation_name,
		sysconv(bit, 1 - (t.status & 1)) AS is_nullable,	-- TYPE_NOTNULL
		sysconv(bit, case when t.id > 256 then 1 else 0 end) AS is_user_defined,	-- x_utypSSNAME
		sysconv(bit, case when t.xtype = 240 then 1 else 0 end) AS is_assembly_type,	-- XVT_UDT
		t.dflt AS default_object_id,
		t.chk AS rule_object_id,
		sysconv(bit, case when t.xtype = 243 then 1 else 0 end) AS is_table_type	-- XVT_TABLETYPE
	FROM sys.sysscalartypes t
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = t.id AND o.class = 44 AND o.depsubid = 0	-- SRC_TYPETOOWNER
	LEFT JOIN sys.syssingleobjrefs sor ON sor.depid = t.id AND sor.class = 36 AND sor.depsubid = 0	-- SRC_TYPETOTABLE 
	WHERE (t.id <= 256 OR has_access('UT', t.id) = 1) 
"
849	Parse Tree	View	-726468467	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	304	"
-- add it
create view sys.dm_pdw_nodes_exec_query_optimizer_info as
select *, convert(int, null) pdw_node_id from sys.dm_exec_query_optimizer_info
"
852	Parse Tree	View	-772557003	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	194	"CREATE VIEW sys.dm_os_spinlock_stats AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_SPINLOCKSTATS)
"
872	Parse Tree	View	-987659372	32767	6	3	1	20	5	251	0	1	1024	0	0	0	0	0	840	"CREATE VIEW INFORMATION_SCHEMA.SCHEMATA
AS
SELECT
	DB_NAME()			AS CATALOG_NAME,
	name				AS SCHEMA_NAME,
	USER_NAME(principal_id)		AS SCHEMA_OWNER,
	convert(sysname, null)		AS DEFAULT_CHARACTER_SET_CATALOG,
	convert(sysname, null) collate catalog_default	AS DEFAULT_CHARACTER_SET_SCHEMA,
	convert(sysname, DATABASEPROPERTYEX(DB_NAME(), 'sqlcharsetname'))
					AS DEFAULT_CHARACTER_SET_NAME
FROM
	sys.schemas
"
879	Parse Tree	View	-249	32767	6	4	1	16	10	251	0	1	1024	0	0	0	0	0	1456	"CREATE VIEW sys.server_event_session_events AS
	SELECT 
		event_session_id = v.objid,
		event_id		 = v.subobjid,
		name			 = convert(sysname, v.value) collate catalog_default,
		package			 = convert(sysname, p.name) collate catalog_default,
		module			 = convert(sysname, m.name) collate catalog_default,
		predicate		 = convert(nvarchar(3000), v.imageval) collate catalog_default,
		predicate_xml	 = pred.predicate_xml
	FROM master.sys.sysobjvalues v
	LEFT JOIN master.sys.sysqnames p ON p.nid = v.valnum
	LEFT JOIN master.sys.sysqnames m ON m.nid = p.qid
	OUTER APPLY OpenRowset(TABLE FN_XE_PREDICATE_XML, v.objid, v.subobjid) pred
	WHERE v.valclass = 56			-- SVC_XE_SESSION_EVENT
	AND has_access ('ES', 0) = 1
"
889	Parse Tree	View	-560	32767	6	4	1	6	13	251	0	1	1024	0	0	0	0	0	3540	"CREATE VIEW sys.memory_optimized_tables_internal_attributes AS
	SELECT 
		CASE 
			WHEN depr.class IS NULL THEN r.indepid
			ELSE depr.indepid
			END
		AS object_id,
			-- depr.class is NULL for tables that are not internal history tables. In that case we return the table's ID.
			-- If it's null, we return the current table's ID (retrieved in the JOIN).
		r.depid AS xtp_object_id,
		CASE 
			WHEN depr.class IS NULL THEN 
				CASE
					WHEN r.class = 119 /* SRC_OFFROW_DATA_HKTABLEID */ THEN 5 /* Off-row table type */
					ELSE r.indepsubid 
					END
			ELSE depr.indepsubid
			END
		AS type,
		pv.name AS type_desc,
		CASE
			WHEN r.class = 119 /* SRC_OFFROW_DATA_HKTABLEID */ THEN r.indepsubid
			ELSE 0
			END
		AS minor_id
	FROM sys.syssingleobjrefs r	
		-- A specific case for this view is to show internal in memory history tables for Hekaton-Temporal tables.
		-- This relation is preserved as a link in sys.syssingleobjrefs that has class 118 - SRC_TEMPORAL_IN_MEMORY_HISTORY_INTERNAL_TABLE;
		-- the self join below is retrieving the information for internal in memory history tables.
	LEFT JOIN sys.syssingleobjrefs depr ON depr.depid = r.indepid AND depr.class = 118 /* SRC_TEMPORAL_IN_MEMORY_HISTORY_INTERNAL_TABLE */
	JOIN sys.syspalvalues pv ON 
		   (r.class = 85 /* SRC_HKTABLEID_TO_OBJECTID */ AND depr.class IS NULL AND pv.class = 'HKCS' AND pv.value = r.indepsubid)
		OR (r.class = 119 /* SRC_OFFROW_DATA_HKTABLEID */ AND depr.class IS NULL AND pv.class = 'HKOD' AND pv.value = 0)
		OR (depr.class = 118 /* SRC_TEMPORAL_IN_MEMORY_HISTORY_INTERNAL_TABLE */ AND pv.class = 'ITTY' AND pv.value = depr.indepsubid)
	WHERE r.class = 85 /* SRC_HKTABLEID_TO_OBJECTID */ or r.class = 119 /* SRC_OFFROW_DATA_HKTABLEID */
"
900	Parse Tree	View	-502	32767	6	4	1	16	12	251	0	1	1024	0	0	0	0	0	1916	"CREATE VIEW sys.database_audit_specification_details AS
	SELECT
		database_specification_id	= asp.id,
		audit_action_id 			= saa.type, -- EDiskAuditActionType
		audit_action_name 			= convert(nvarchar(60), 
											audit_action_property('name', saa.class, saa.type)),
		class 						= saa.class, -- EMDPermissionClass
		class_desc				 	= n.name,
		major_id				 	= saa.id,
		minor_id				 	= saa.subid,
		audited_principal_id		= saa.grantee,
		audited_result			 	= convert(nvarchar(60), 'SUCCESS AND FAILURE'),
		is_group				 	= sysconv(bit, 
										audit_action_property('is_group', saa.class, saa.type))
	FROM
		sys.sysclsobjs asp INNER JOIN 
		sys.sysaudacts saa ON
			(
				saa.audit_spec_id = asp.id
			) LEFT JOIN
		sys.syspalvalues n ON 
			(
				n.class = 'UNCL' AND
				n.value = saa.class
			)
	WHERE
		asp.class = 65 AND -- SOC_SECAUDITSPEC
		asp.type = 'DA'
		AND has_access('DA', 0) = 1 -- catalog security check
"
901	Parse Tree	View	-133	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	364	"CREATE VIEW sys.sysfulltextcatalogs AS
	SELECT ftcatid = convert(smallint, fulltext_catalog_id),
		name, status = convert(smallint, is_default), path
	FROM sys.fulltext_catalogs
"
901	Compiled Plan	Adhoc	849144689	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.database_mirroring t
903	Parse Tree	View	-812293857	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	264	"CREATE VIEW sys.dm_resource_governor_external_resource_pool_affinity AS
	SELECT *
	FROM OpenRowSet(TABLE DM_RG_EXTPOOL_AFFINITY)
"
905	Parse Tree	View	-363680901	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	372	"CREATE FUNCTION sys.fn_ftcatcomponents(@dumpsystem int, @dbid int, @fileid int)
RETURNS TABLE
AS
	RETURN SELECT * FROM OpenRowset(TABLE FTCATCOMPONENTS, @dumpsystem, @dbid, @fileid)
"
909	Compiled Plan	Adhoc	926428742	6	0	-2	2	2	36	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.symmetric_keys t
911	Parse Tree	View	-444	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	316	"CREATE VIEW sys.services AS
	SELECT name,
		service_id,
		principal_id,
		service_queue_id
	FROM sys.services$
	WHERE has_access('SV', service_id) = 1
"
911	Parse Tree	View	-1000261946	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	218	"create view sys.dm_io_cluster_valid_path_names
as
	select * from OpenRowset(TABLE SERVERSHAREDVALIDPATHS)
"
916	Parse Tree	View	-723800187	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	158	"CREATE VIEW sys.dm_os_stacks AS
	SELECT *
	FROM OpenRowSet(TABLE SYSSTACKS)
"
922	Parse Tree	View	-231667132	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	172	"CREATE view sys.dm_fts_memory_pools
AS
	SELECT * FROM OpenRowset(TABLE FTMEMPOOLS)
"
922	Parse Tree	View	-386	32767	6	4	1	41	104	187	0	1	1024	0	0	0	0	0	6972	"CREATE VIEW sys.tables AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		isnull(ds.indepid, 0) AS lob_data_space_id,
		rfs.indepid AS filestream_data_space_id,
		o.property AS max_column_id_used,
		o.lock_on_bulk_load, o.uses_ansi_nulls, o.is_replicated, o.has_replication_filter,
		o.is_merge_published, o.is_sync_tran_subscribed, o.has_unchecked_assembly_data,
		lob.intprop AS text_in_row_limit,
		o.large_value_types_out_of_row,
		o.is_tracked_by_cdc,
		o.lock_escalation_option AS lock_escalation,
		ts.name AS lock_escalation_desc,
		o.is_filetable,
		o.is_memory_optimized,
		o.durability_option as durability,
		d.name as durability_desc,
		convert(tinyint, case when ct.indepid IS NOT NULL then 2 when ht.depid IS NOT NULL then 1 else 0 end) as temporal_type,
		convert(nvarchar(60), case when ct.indepid IS NOT NULL then 'SYSTEM_VERSIONED_TEMPORAL_TABLE' when ht.depid IS NOT NULL then 'HISTORY_TABLE' else 'NON_TEMPORAL_TABLE' end) collate Latin1_General_CI_AS_KS_WS as temporal_type_desc,
		ct.depid as history_table_id,
		convert(bit, CASE WHEN EXISTS (SELECT 1 FROM sys.sysmultiobjrefs WHERE depid = o.object_id AND class = 27 /*MRC_STRETCH_REMOTE_DATABASE*/) THEN 1 ELSE 0 END) AS is_remote_data_archive_enabled,
		o.is_external,
		convert(int,
			case when ct.indepid IS NOT NULL -- temporal system_versioned current table
				then ISNULL((select value from sys.sysobjvalues where valclass = 123 and objid = o.object_id and valnum = 0), -1)
			else NULL
				end
		) as history_retention_period,
		convert(int,
			case when ct.indepid IS NOT NULL -- temporal system_versioned current table
				then ISNULL((select value from sys.sysobjvalues where valclass = 123 and objid = o.object_id and valnum = 1), -1)
			else NULL
				end
		) as history_retention_period_unit,
		convert(nvarchar(10),
			case when ct.indepid IS NOT NULL -- temporal system_versioned current table
			then
				case when exists (select value from sys.sysobjvalues where valclass = 123 and objid = o.object_id and valnum = 1)
				then 
					case (select ISNULL(value, -1) from sys.sysobjvalues where valclass = 123 and objid = o.object_id and valnum = 1)
						when -1 then 'INFINITE'
						when 0 then 'SECOND'
						when 1 then 'MINUTE'
						when 2 then 'HOUR'
						when 3 then 'DAY'
						when 4 then 'WEEK'
						when 5 then 'MONTH'
						when 6 then 'YEAR'
						else 'UNDEFINED'
						end
				else
					'INFINITE'
				end
			else NULL
			end
			) collate Latin1_General_CI_AS_KS_WS as history_retention_period_unit_desc,
		o.is_node,
		o.is_edge
	FROM sys.objects$ o
	LEFT JOIN sys.sysidxstats lob ON lob.id = o.object_id AND lob.indid <= 1
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = o.object_id AND ds.class = 8 AND ds.depsubid <= 1	-- SRC_INDEXTOLOBDS	
	LEFT JOIN sys.syssingleobjrefs rfs ON rfs.depid = o.object_id AND rfs.class = 42 AND rfs.depsubid = 0	-- SRC_OBJTOFSDS
	LEFT JOIN sys.syssingleobjrefs ct ON ct.indepid = o.object_id AND ct.class = 112 -- SRC_HISTORY_TABLE
	LEFT JOIN sys.syssingleobjrefs ht ON ht.depid = o.object_id AND ht.class = 112 -- SRC_HISTORY_TABLE
	LEFT JOIN sys.syspalvalues ts ON ts.class = 'LEOP' AND ts.value = o.lock_escalation_option
	LEFT JOIN sys.syspalvalues d ON d.class = 'DOPT' AND d.value = o.durability_option
	WHERE o.type = 'U'
"
930	Parse Tree	View	-322655018	32767	6	4	1	1	5	251	0	1	1024	0	0	0	0	0	476	"
-- add it
create view sys.pdw_loader_backup_run_details as
select
	run_id,
	pdw_node_id,
	status	collate database_default status,
	start_time,
	end_time,
	total_elapsed_time,
	progress
from sys._pdw_loader_backup_run_details
"
934	Parse Tree	View	-103402673	32767	6	4	1	4	12	251	0	1	1024	0	0	0	0	0	2304	"CREATE VIEW sys.dm_db_fts_index_physical_stats AS
	SELECT
		it.parent_object_id AS object_id,
		SUM( CASE
				WHEN it.internal_type IN
							(211, -- ITT_FTAvdl
							 212, -- ITT_FTCompFragment
							 213, -- ITT_FTDocidStatus
							 214, -- ITT_FTIndexedDocid
							 215, -- ITT_FTDocidFilter
							 216) -- ITT_FTIndDocidMap
				THEN p.used_page_count
				ELSE 0
				END ) AS fulltext_index_page_count, 
		SUM( CASE
				WHEN it.internal_type = 222 -- ITT_SEMPLTTagIndex
				THEN p.used_page_count
				ELSE 0
				END ) AS keyphrase_index_page_count,
		SUM( CASE
				WHEN it.internal_type = 221 -- ITT_SEMPLTDocumentIndex
				THEN p.used_page_count
				ELSE 0
				END ) AS similarity_index_page_count
	FROM
			sys.internal_tables it
		JOIN
			sys.dm_db_partition_stats p
		ON
			p.object_id = it.object_id
	WHERE it.internal_type IN
			(211, -- ITT_FTAvdl
			 212, -- ITT_FTCompFragment
			 213, -- ITT_FTDocidStatus
			 214, -- ITT_FTIndexedDocid
			 215, -- ITT_FTDocidFilter
			 216, -- ITT_FTIndDocidMap
			 221, -- ITT_SEMPLTDocumentIndex
			 222) -- ITT_SEMPLTTagIndex
	GROUP BY it.parent_object_id
"
950	Parse Tree	View	-969682500	32767	6	4	1	2	7	251	0	1	1024	0	0	0	0	0	580	"CREATE VIEW sys.dm_tran_commit_table AS
	SELECT commit_ts, xdes_id, commit_lbn, commit_csn, commit_time
			FROM sys.syscommittab WITH (READCOMMITTEDLOCK)
	UNION
	SELECT commit_ts, xdes_id, commit_lbn, commit_csn, commit_time 
			FROM OpenRowset (table SYSCOMMITTABLE, db_id (), 0, 0)
"
955	Parse Tree	View	-212	32767	6	4	1	30	16	251	0	1	1024	0	0	0	0	0	3010	"CREATE VIEW sys.sysservers AS SELECT
	srvid = convert(smallint, server_id),
	srvstatus = convert(smallint,
		is_remote_login_enabled + is_publisher * 2
		+ is_subscriber * 4 + is_distributor * 8
		+ is_linked * 32 + is_rpc_out_enabled * 64
		+ is_data_access_enabled * 128 + is_collation_compatible * 256
		+ is_system * 512 + uses_remote_collation * 1024
		+ lazy_schema_validation * 2048 + is_nonsql_subscriber * 4096),
	srvname = name,
	srvproduct = product,
	providername = case when UPPER(provider) = N'SQLNCLI' then N'SQLOLEDB' else provider end,
	datasource = data_source,
	location,
	providerstring = provider_string,
	schemadate = modify_date,
	topologyx = convert(int, 0),
	topologyy = convert(int, 0),
	catalog,
	srvcollation = convert(sysname, collationproperty(collation_name, 'collationid')),
	connecttimeout = connect_timeout,
	querytimeout = query_timeout,
	srvnetname = convert(char(30), case when (product = N'SQL Server') then data_source end),
	isremote = sysconv(bit, 1 - is_linked),
	rpc = is_remote_login_enabled,
	pub = is_publisher,
	sub = is_subscriber,
	dist = is_distributor,
	dpub = sysconv(bit, is_distributor & is_publisher),
	rpcout = is_rpc_out_enabled,
	dataaccess = is_data_access_enabled,
	collationcompatible = is_collation_compatible,
	system = is_system,
	useremotecollation = uses_remote_collation,
	lazyschemavalidation = lazy_schema_validation,
	collation = collation_name,
	nonsqlsub = is_nonsql_subscriber
FROM sys.servers
"
965	Parse Tree	View	-174643308	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	188	"CREATE view sys.dm_fts_population_ranges
AS
	SELECT * FROM OpenRowset(TABLE FTCRAWLRANGES)
"
973	Parse Tree	View	-683019598	32767	6	4	1	12	18	251	0	1	1024	0	0	0	0	0	4476	"CREATE VIEW sys.dm_hadr_availability_group_states AS
	SELECT 
		ags.group_id,
		primary_replica = CAST (ags.primary_replica AS NVARCHAR(128)),
		primary_recovery_health = CASE
			WHEN ags.local_replica_role = 1 THEN ars.recovery_health_aggr
			ELSE NULL END,
		primary_recovery_health_desc = CASE
			WHEN (ags.local_replica_role = 1 AND ars.recovery_health_aggr = 0) THEN CAST ('ONLINE_IN_PROGRESS' AS NVARCHAR(60))
			WHEN (ags.local_replica_role = 1 AND ars.recovery_health_aggr > 0) THEN CAST ('ONLINE' AS NVARCHAR(60))
			ELSE CAST (NULL AS NVARCHAR(60)) END,
		secondary_recovery_health = CASE
			WHEN ags.local_replica_role = 2 THEN ars.recovery_health_aggr
			ELSE NULL END,
		secondary_recovery_health_desc = CASE
			WHEN (ags.local_replica_role = 2 AND ars.recovery_health_aggr = 0) THEN CAST ('ONLINE_IN_PROGRESS' AS NVARCHAR(60))
			WHEN (ags.local_replica_role = 2 AND ars.recovery_health_aggr > 0) THEN CAST ('ONLINE' AS NVARCHAR(60))
			ELSE CAST (NULL AS NVARCHAR(60)) END,
		synchronization_health = CASE
			WHEN ars.synchronization_health_aggr IS NULL THEN CAST (0 AS TINYINT)			-- NOT_HEALTHY
			WHEN (ags.local_replica_role = 1 AND ags.configured_replica_count > ars.replica_count) THEN CAST (0 AS TINYINT)	-- NOT_HEALTHY (one or more replicas/DBs not joined)
			ELSE CAST (ars.synchronization_health_aggr AS TINYINT) END,
		synchronization_health_desc = CASE
			WHEN ars.synchronization_health_aggr IS NULL THEN CAST ('NOT_HEALTHY' AS NVARCHAR(60))
			WHEN (ags.local_replica_role = 1 AND ags.configured_replica_count > ars.replica_count) THEN CAST ('NOT_HEALTHY' AS NVARCHAR(60))
			WHEN ars.synchronization_health_aggr = 2 THEN CAST ('HEALTHY' AS NVARCHAR(60))
			WHEN ars.synchronization_health_aggr = 1 THEN CAST ('PARTIALLY_HEALTHY' AS NVARCHAR(60))
			ELSE CAST ('NOT_HEALTHY' AS NVARCHAR(60)) END
	FROM
		sys.dm_hadr_internal_availability_group_states ags
		LEFT OUTER JOIN
		(
			SELECT 
				group_id,
				replica_count = COUNT (*),
				recovery_health_aggr = MAX (recovery_health),
				synchronization_health_aggr = MIN (synchronization_health)
			FROM 
				sys.dm_hadr_availability_replica_states 
			GROUP BY group_id
		)
		AS ars
		ON ags.group_id = ars.group_id
"
976	Parse Tree	View	-465	32767	6	4	1	8	11	251	0	1	1024	0	0	0	0	0	1070	"CREATE VIEW sys.key_encryptions AS
	SELECT s.id AS key_id,
		case when (k.type = 'ESKP' OR k.type = 'ESP2' OR k.type = 'ESP3') then NULL else k.thumbprint end as thumbprint,
		k.type AS crypt_type,
		ct.name AS crypt_type_desc,
		(case when has_access('OE', s.id) = 1 then k.crypto else NULL end) AS crypt_property
	FROM sys.sysclsobjs s
	JOIN sys.sysobjkeycrypts k ON k.class = 24 AND k.id = s.id
	LEFT JOIN sys.syspalnames ct ON ct.class = 'CRTY' AND ct.value = k.type
	WHERE s.class = 56
		AND has_access('OK', s.id) = 1
"
987	Parse Tree	View	-407	32767	6	4	1	18	10	251	0	1	1024	0	0	0	0	0	852	"CREATE VIEW sys.check_constraints AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc, create_date, modify_date,
		is_ms_shipped, is_published, is_schema_published,
		is_disabled, is_not_for_replication, is_not_trusted,
		property AS parent_column_id,
		object_definition(object_id) AS definition,
		uses_database_collation, is_system_named
	FROM sys.objects$
	WHERE type = 'C '
"
998	Parse Tree	View	-170786604	32767	6	4	1	5	12	251	0	1	1024	0	0	0	0	0	1764	"CREATE VIEW sys.dm_column_store_object_pool AS
	SELECT op.database_id AS database_id,
	op.object_id AS object_id,
	op.index_id AS index_id,
	op.partition_number AS partition_number,
	op.column_id AS column_id,
	op.row_group_id AS row_group_id,
	sp.value AS object_type,
	sp.name AS object_type_desc,
	op.access_count AS access_count,
	op.memory_used_in_bytes AS memory_used_in_bytes,
	op.object_load_time AS object_load_time
	FROM OpenRowset(TABLE DM_COLUMNSTORE_OBJECT_POOL_STATS) as op
	INNER JOIN sys.syspalvalues sp
		ON sp.class = 'COT'
			AND ((op.object_type = 0 AND sp.value = 0) 
			OR (op.object_type = 1 AND sp.value = 1)
			OR (op.object_type = 2 AND sp.value = 2) 
			OR (op.object_type = 4 AND sp.value = 3) 
			OR (op.object_type = 5 AND sp.value = 4) 
			OR (op.object_type = 6 AND sp.value = 5)
			OR (op.object_type = 8 AND sp.value = 6))
	
"
1002	Parse Tree	View	-459990558	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	188	"CREATE VIEW sys.dm_os_virtual_address_dump AS
	SELECT *
	FROM OpenRowset(TABLE SYSVADUMP) 
"
1004	Parse Tree	View	-80283750	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	300	"
-- add it
create view sys.dm_pdw_nodes_os_memory_cache_counters as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_cache_counters
"
1005	Parse Tree	View	-750419857	32767	6	3	1	20	6	251	0	1	1024	0	0	0	0	0	790	"CREATE VIEW INFORMATION_SCHEMA.VIEWS
AS
SELECT
	DB_NAME()						AS TABLE_CATALOG,
	SCHEMA_NAME(schema_id)			AS TABLE_SCHEMA,
	name							AS TABLE_NAME,
	convert(nvarchar(4000),
		OBJECT_DEFINITION(object_id))		AS VIEW_DEFINITION,
	convert(varchar(7), CASE with_check_option
		WHEN 1 THEN 'CASCADE'
		ELSE 'NONE' END)				AS CHECK_OPTION,
	'NO'								AS IS_UPDATABLE
FROM
	sys.views
"
1010	Parse Tree	View	-1045383193	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	188	"CREATE VIEW sys.dm_os_memory_allocations AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMALLOCS)
"
1013	Parse Tree	View	-1069989784	32767	6	4	1	3	6	251	0	1	1024	0	0	0	0	0	236	"
-- add it
create view sys.dm_pdw_nodes_os_tasks as
select *, convert(int, null) pdw_node_id from sys.dm_os_tasks
"
1020	Parse Tree	View	-233	32767	6	4	1	16	20	251	0	1	1024	0	0	0	0	0	2422	"CREATE VIEW sys.server_event_notifications AS
	SELECT o.name,
		object_id = o.id,
		parent_class = o.pclass,
		parent_class_desc = pc.name,
		parent_id = o.pid,
		create_date = o.created,
		modify_date = o.modified,
		service_name = convert(nvarchar(256), v.value) COLLATE Latin1_General_BIN,
		broker_instance = convert(sysname, b.value) COLLATE Latin1_General_BIN,
		creator_sid = convert(varbinary(85), cs.value),
		principal_id = r.indepid
	FROM master.sys.sysschobjs$ o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 72 AND v.objid = o.id AND v.subobjid = 0 AND v.valnum = 0		-- SVC_ASYNTRGSVCNAME
	LEFT JOIN sys.sysobjvalues b ON b.valclass = 74 AND b.objid = o.id AND b.subobjid = 0 AND b.valnum = 0		-- SVC_ASYNTRGBRKRINST
	LEFT JOIN sys.sysobjvalues cs ON cs.valclass = 75 AND cs.objid = o.id AND cs.subobjid = 0 AND cs.valnum = 0	-- SVC_ASYNTRGCTRSID
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 98 AND r.depsubid = 0	-- SRC_OBJLOGIN
	LEFT JOIN sys.syspalvalues pc ON pc.class = 'UNCL' AND pc.value = o.pclass
	WHERE o.type = 'EN' AND o.nsclass = 30 AND o.pclass = 100	-- x_eonc_EvtNotifOnServer:x_eunc_Server
		AND has_access('TR', o.id, o.pid, o.nsclass) = 1
"
1030	Parse Tree	View	-544	32767	6	4	1	2	11	187	0	1	1024	0	0	0	0	0	1998	"CREATE VIEW sys.plan_persist_query_in_memory AS
	SELECT
		query_id,
		query_text_id,
		context_settings_id,
		object_id,
		batch_sql_handle,
		query_hash,
		is_internal_query,
		query_param_type,
		initial_compile_start_time,
		last_compile_start_time,
		last_execution_time,
		last_compile_batch_sql_handle,
		last_compile_batch_offset_start,
		last_compile_batch_offset_end,
		compile_count,
		total_compile_duration,
		last_compile_duration,
		total_parse_duration,
		last_parse_duration,
		total_parse_cpu_time,
		last_parse_cpu_time,
		total_bind_duration,
		last_bind_duration,
		total_bind_cpu_time,
		last_bind_cpu_time,
		total_optimize_duration,
		last_optimize_duration,
		total_optimize_cpu_time,
		last_optimize_cpu_time,
		total_compile_memory_kb,
		last_compile_memory_kb,
		max_compile_memory_kb,
		status,
		statement_sql_handle,
		convert(bit, query_flags & 0x01) as is_ignored_by_query_tuning
	FROM OpenRowset(TABLE QUERY_STORE_QUERY_IN_MEM)
"
1041	Parse Tree	View	-486	32767	6	4	1	5	14	251	0	1	1024	0	0	0	0	0	2988	"CREATE VIEW sys.system_internals_partitions AS
	SELECT rs.rowsetid AS partition_id,
		rs.idmajor AS object_id,
		rs.idminor AS index_id,
		rs.numpart AS partition_number,
		isnull(ct.rows, rs.rcrows) AS rows,
		rs.fgidfs AS filestream_filegroup_id,
		convert(bit, 1-rs.ownertype) AS is_orphaned,
		convert(tinyint, rs.status & 3) AS dropped_lob_column_state,	--RS_LOBSTAT_*
		convert(bit, rs.status & 4) AS is_unique,					--RS_UNIQUE
		convert(bit, rs.status & 8) AS is_replicated,					--RS_REPLICATED
		convert(bit, rs.status & 16) AS is_logged_for_replication,		--RS_LOG_OFFROW_FOR_REPL
		sysconv(bit, rs.status & 1073741824) AS is_sereplicated,				--RS_SEREPLICATED
		rs.maxnullbit AS max_null_bit_used,
		rs.maxleaf AS max_leaf_length,
		rs.minleaf AS min_leaf_length,
		rs.maxint AS max_internal_length,
		rs.minint AS min_internal_length,
		convert(bit, rs.status & 64) AS allows_nullable_keys,			--RS_NULLABLE_KEYS
		convert(bit, 1-(rs.status & 128)/128) AS allow_row_locks,	--RS_NO_ROWLOCK
		convert(bit, 1-(rs.status & 256)/256) AS allow_page_locks,	--RS_NO_PAGELOCK
		convert(bit, rs.status & 512) AS is_data_row_format,			--RS_DATAROW_FRMT
		convert(bit, rs.status & 2048) AS is_not_versioned,			--RS_NOTVERSIONED
		convert(uniqueidentifier, rs.rsguid) AS filestream_guid,
		rs.ownertype as ownertype,
		sysconv(bit, rs.status & 0x00010000) AS is_columnstore
	FROM sys.sysrowsets rs OUTER APPLY OpenRowset(TABLE ALUCOUNT, rs.rowsetid, 0, 0, rs.idmajor) ct
"
1052	Parse Tree	View	-428	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	518	"CREATE VIEW sys.database_role_members AS
	SELECT indepid AS role_principal_id,
		depid AS member_principal_id
	FROM sys.sysmultiobjrefs
	WHERE class = 25 AND depsubid = 0 AND indepsubid = 0
		AND has_access('RL', depid, indepid) = 1	-- MRC_DBROLEMEMBER
"
1055	Parse Tree	View	-267822312	32767	6	4	1	8	4	251	0	1	1024	0	0	0	0	0	214	"CREATE VIEW sys.dm_os_memory_cache_counters AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMORYCACHECOUNTERS)
"
1061	Parse Tree	View	-185662232	32767	6	4	1	2	22	251	0	1	1024	0	0	0	0	0	3450	"CREATE VIEW sys.dm_db_missing_index_group_stats AS

	SELECT
		-- key
		group_handle = index_id,
		
		-- number of compiles (same for all queries because stored at combo level)
		unique_compiles = MAX(unique_compiles),

		-- stats for user queries
		user_seeks = SUM(user_seeks),
		user_scans = SUM(user_scans),
		last_user_seek = NULLIF(MAX(ISNULL(last_user_seek, 0)), 0),
		last_user_scan = NULLIF(MAX(ISNULL(last_user_scan, 0)), 0),
		avg_total_user_cost =
			CASE 
				WHEN SUM(user_seeks + user_scans) > 0 
				THEN SUM(total_user_cost) / SUM(user_seeks + user_scans)
				ELSE 0 
			END,
		avg_user_impact =
			CASE 
				WHEN SUM(user_seeks + user_scans) > 0 AND SUM(total_user_improvement) > 0 AND SUM(total_user_cost) > 0
				THEN ROUND(100 * IIF(SUM(total_user_improvement) > SUM(total_user_cost), 1, SUM(total_user_improvement) / SUM(total_user_cost)), 2)
				ELSE 0 
			END,

		-- stats for system queries
		system_seeks = SUM(system_seeks),
		system_scans = SUM(system_scans),
		last_system_seek = NULLIF(MAX(ISNULL(last_system_seek, 0)), 0),
		last_system_scan = NULLIF(MAX(ISNULL(last_system_scan, 0)), 0),
		avg_total_system_cost =
			CASE 
				WHEN SUM(system_seeks + system_scans) > 0 
				THEN SUM(total_system_cost) / SUM(system_seeks + system_scans)
				ELSE 0 
			END,
		avg_system_impact =
			CASE 
				WHEN SUM(system_seeks + system_scans) > 0 AND SUM(total_system_improvement) > 0 AND SUM(total_system_cost) > 0
				THEN ROUND(100 * IIF(SUM(total_system_improvement) > SUM(total_system_cost), 1, SUM(total_system_improvement) / SUM(total_system_cost)), 2)
				ELSE 0 
			END
			
	FROM OpenRowset(TABLE LOGINDEXSTATS)
	WHERE status <> 0
	GROUP BY index_id
"
1065	Compiled Plan	Adhoc	287644883	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.dm_os_nodes t
1067	Parse Tree	View	-305588759	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	532	"
-- add it
create view sys.pdw_health_component_status_mappings as
select
	component_id,
	property_id,
	physical_name	collate database_default physical_name,
	logical_name	collate database_default logical_name
from sys._pdw_health_component_status_mappings
"
1069	Parse Tree	View	-1030289985	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	204	"CREATE VIEW sys.dm_db_task_space_usage AS
	SELECT *
	FROM OpenRowset(TABLE DM_DB_TASK_SPACE_USAGE)
"
1069	Parse Tree	View	-482881846	32767	6	4	1	3	11	251	0	1	1024	0	0	0	0	0	1460	"
-- add it using explicit column names to avoid matrix-specific non-golden-bits columns.
create view sys.dm_pdw_nodes_resource_governor_resource_pools as
select
[pool_id]
,[name]
,[statistics_start_time]
,[total_cpu_usage_ms]
,[cache_memory_kb]
,[compile_memory_kb]
,[used_memgrant_kb]
,[total_memgrant_count]
,[total_memgrant_timeout_count]
,[active_memgrant_count]
,[active_memgrant_kb]
,[memgrant_waiter_count]
,[max_memory_kb]
,[used_memory_kb]
,[target_memory_kb]
,[out_of_memory_count]
,[min_cpu_percent]
,[max_cpu_percent]
,[min_memory_percent]
,[max_memory_percent]
,[cap_cpu_percent]
,[total_cpu_usage_preemptive_ms]
,convert(int, null) pdw_node_id from sys.dm_resource_governor_resource_pools
"
1085	Parse Tree	View	-254	32767	6	4	1	7	23	251	0	1	1024	0	0	0	0	0	5380	"CREATE VIEW sys.resource_governor_workload_groups
AS
    -- ISSUE - VSTS 83011
    -- Use isnull() below because Algebrizer doesn't properly
    -- determine these columns are non-nullable.
    SELECT
        group_id                    = co.id, -- group id
        name                        = co.name,
        importance                  = isnull(convert(sysname,case
                                                     when ((co.status / 0x100) % 0x100) = 1 then 'Low'    -- x_ergi_Low
                                                     when ((co.status / 0x100) % 0x100) = 3 then 'Medium' -- x_ergi_Medium
                                                     when ((co.status / 0x100) % 0x100) = 9 then 'High'   -- x_ergi_High
                                                     end),
                                              0),
        request_max_memory_grant_percent = isnull(co.status % 0x100, 0),
        request_max_cpu_time_sec         = co.intprop,
        request_memory_grant_timeout_sec = isnull(convert(int, convert(bigint, ov.value) % 0x100000000), 0),
        max_dop                          = isnull(convert(int, convert(bigint, ov_maxdop.value) % 0x100000000), 0),
        group_max_requests               = isnull(convert(int, convert(bigint, ov.value) / 0x100000000), 0),
        pool_id                          = sor.indepid,
        external_pool_id                 = isnull(sorex.indepid, 2)
    FROM
        master.sys.sysclsobjs co INNER JOIN
        master.sys.syssingleobjrefs sor ON
        (
            co.class = 53 AND   -- SOC_RG_GROUP
            co.id = sor.depid AND
            sor.class = 13 AND  -- SRC_RG_GROUP_TO_POOL
            sor.depsubid = 0 AND
            sor.indepsubid = 0
        ) LEFT JOIN
        master.sys.syssingleobjrefs sorex ON
        (
            co.class = 53 AND   -- SOC_RG_GROUP
            co.id = sorex.depid AND
            sorex.class = 120 AND  -- SRC_RG_GROUP_TO_EXTERNAL_POOL
            sorex.depsubid = 0 AND
            sorex.indepsubid = 0
        ) INNER JOIN
        master.sys.sysobjvalues ov ON
        (
            co.class = 53 AND   -- SOC_RG_GROUP
            co.id = ov.objid AND
            ov.valclass = 64 AND -- SVC_RG_GROUP
            ov.subobjid = 0 AND
            ov.valnum = 0
        ) LEFT JOIN
        master.sys.sysobjvalues ov_maxdop ON
        (
            co.class = 53 AND   -- SOC_RG_GROUP
            co.id = ov_maxdop.objid AND
            ov_maxdop.valclass = 64 AND -- SVC_RG_GROUP
            ov_maxdop.subobjid = 0 AND
            ov_maxdop.valnum = 1
        )
    WHERE
        has_access('RG', 0) = 1
"
1088	Parse Tree	View	-231898989	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	450	"
-- add it
create view sys.dm_pdw_network_credentials as
select
	pdw_node_id,
	target collate database_default target,
	username collate database_default username,
	last_modified
from sys._dm_pdw_network_credentials
"
1095	Parse Tree	View	-565	32767	6	4	1	22	6	251	0	1	1024	0	0	0	0	0	980	"
CREATE VIEW sys.external_data_sources AS
	SELECT
		seds.data_source_id AS data_source_id,
		seds.name AS name,
		seds.location AS location,
		UPPER(seds.type_desc) AS type_desc,
		seds.type AS type,
		seds.job_tracker_location AS resource_manager_location,
		seds.credential_id AS credential_id,
		seds.shard_map_manager_db AS database_name,
		seds.shard_map_name AS shard_map_name
	FROM sys.sysextsources seds
	WHERE has_access('ED', DB_ID()) = 1 -- catalog security check	
"
1096	Parse Tree	View	-196	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	438	"CREATE VIEW sys.sysconfigures AS
	SELECT
		convert(int, value) AS value,
		configuration_id AS config,
		description AS comment,
		convert(smallint, is_dynamic + is_advanced*2) AS status
	FROM sys.configurations
"
1117	Parse Tree	View	-107809906	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	314	"
-- add it
create view sys.dm_pdw_dms_cores as
select
	dms_core_id,
	pdw_node_id,
	status	collate database_default status
from sys._dm_pdw_dms_cores
"
1117	Parse Tree	View	-449	32767	6	4	1	10	7	251	0	1	1024	0	0	0	0	0	568	"CREATE VIEW sys.extended_properties AS
	SELECT p.class,
		class_desc = n.name,
		major_id = p.id,
		minor_id = p.subid,
		p.name, p.value
	FROM sys.sysxprops p
	LEFT JOIN sys.syspalvalues n ON n.class = 'UNCL' AND n.value = p.class
	WHERE has_access('EP', p.class, p.id) = 1
"
1119	Parse Tree	View	-136959643	32767	6	4	1	20	6	251	0	1	1024	0	0	0	0	0	900	"
-- add it
create view sys.pdw_health_alerts as
select
	alert_id,
	component_id,
	alert_name	collate database_default alert_name,
	state	collate database_default state,
	severity	collate database_default severity,
	type	collate database_default type,
	description	collate database_default description,
	condition	collate database_default condition,
	status	collate database_default status,
	condition_value
from sys._pdw_health_alerts
"
1125	Parse Tree	View	-1061705188	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	154	"CREATE VIEW sys.dm_os_hosts AS
	SELECT *
	FROM OpenRowSet(TABLE SYSHOSTS)
"
1128	Parse Tree	View	-391	32767	1	4	1	2	60	251	0	1	1024	0	0	0	0	0	8214	"CREATE VIEW sys.columns AS
	SELECT c.id AS object_id,
		c.name, c.colid AS column_id,
		c.xtype AS system_type_id,
		c.utype AS user_type_id,
		c.length AS max_length,
		c.prec AS precision, c.scale,
		convert(sysname, CollationPropertyFromId(c.collationid, 'name')) AS collation_name,
		sysconv(bit, 1 - (c.status & 1)) AS is_nullable,		-- CPM_NOTNULL
		sysconv(bit, c.status & 2) AS is_ansi_padded,		-- CPM_NOTRIM
		sysconv(bit, c.status & 8) AS is_rowguidcol,			-- CPM_ROWGUIDCOL
		sysconv(bit, c.status & 4) AS is_identity,			-- CPM_IDENTCOL
		sysconv(bit, case when sov4.value is NULL then c.status & 16 else 0 end) is_computed,			-- CPM_COMPUTED
		sysconv(bit, c.status & 32) AS is_filestream,			-- CPM_FILESTREAM
		sysconv(bit, c.status & 0x020000) AS is_replicated,			-- CPM_REPLICAT
		sysconv(bit, c.status & 0x040000) AS is_non_sql_subscribed,	-- CPM_NONSQSSUB
		sysconv(bit, c.status & 0x080000) AS is_merge_published,	-- CPM_MERGEREPL
		sysconv(bit, c.status & 0x100000) AS is_dts_replicated,	-- CPM_REPLDTS
		sysconv(bit, c.status & 2048) AS is_xml_document,		-- CPM_XML_DOC 
		c.xmlns AS xml_collection_id,
		c.dflt AS default_object_id,
		c.chk AS rule_object_id,
		sysconv(bit, c.status & 0x1000000) AS is_sparse,	-- CPM_SPARSE
		sysconv(bit, c.status & 0x2000000) AS is_column_set,	-- CPM_SPARSECOLUMNSET
		convert(tinyint, case when c.status & 0x10000000 = 0x10000000 then 1 when c.status & 0x20000000 = 0x20000000 then 2 when sov3.value >= 3 AND sov3.value <= 6 then sov3.value else 0 end) as generated_always_type, -- CPM_TEMPORALSYSSTARTCOLUMN CPM_TEMPORALSYSENDCOLUMN
		convert(nvarchar(60), case when c.status & 0x10000000 = 0x10000000 then 'AS_ROW_START' when c.status & 0x20000000 = 0x20000000 then 'AS_ROW_END' when sov3.value = 3 then 'AS_SUSER_SID_START' when sov3.value = 4 then 'AS_SUSER_SID_END' when sov3.value = 5 then 'AS_SUSER_SNAME_START' when sov3.value = 6 then 'AS_SUSER_SNAME_END' else 'NOT_APPLICABLE' end) collate Latin1_General_CI_AS_KS_WS as generated_always_type_desc, -- These _DESC columns should always be the fixed latin collation. Reason is that unlike other columns in system tables that can change depending on the collation setting of the database/instance, these are always fixed on all installations of SQL Server.
		convert(int, (convert(bigint, sov.value) / 0x100) % 0x100) as encryption_type,
		convert(nvarchar(64), v1.name) as encryption_type_desc,
		convert(sysname, v2.name) as encryption_algorithm_name,
		sor.indepid as column_encryption_key_id,
		convert(sysname, sov2.value) collate catalog_default as column_encryption_key_database_name,
		sysconv(bit, c.status & 0x2000) AS is_hidden,		-- CPM_HIDDEN
		sysconv(bit, c.status & 0x40000000) AS is_masked,			-- CPM_DATAMASKED
		convert(int, sov4.value) as graph_type,
		convert(nvarchar(60), v3.name) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues sov ON sov.valclass = 115 /*SVC_COL_ENCRYPTION_MD*/ and sov.objid = c.id and sov.subobjid = c.colid and sov.valnum = 0 -- TYPE_AND_ALGORITHM
	LEFT JOIN sys.sysobjvalues sov2 ON sov2.valclass = 115 /*SVC_COL_ENCRYPTION_MD*/ and sov2.objid = c.id and sov2.subobjid = c.colid and sov2.valnum = 2 -- CEK_DATABASE_NAME
	LEFT JOIN sys.sysobjvalues sov3 ON sov3.valclass = 119 /*SVC_GENERATED_ALWAYS_COLUMN_TYPE*/ and sov3.objid = c.id and sov3.subobjid = c.colid
	LEFT JOIN sys.sysobjvalues sov4 ON sov4.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ and sov4.objid = c.id and sov4.subobjid = c.colid and sov4.valnum = 0
	LEFT JOIN sys.syssingleobjrefs sor ON sor.class = 113 /*SRC_COLUMN_TO_COL_ENCRYPTION_KEY*/ and sov.objid = sor.depid and sov.subobjid = sor.depsubid
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'CET' AND v1.value = convert(int, (convert(bigint, sov.value) / 0x100) % 0x100)
	LEFT JOIN sys.syspalvalues v2 ON v2.class = 'CEA' A"
1128	Parse Tree	View	-391	32767	6	4	1	41	60	251	0	1	1024	0	0	0	0	0	8214	"CREATE VIEW sys.columns AS
	SELECT c.id AS object_id,
		c.name, c.colid AS column_id,
		c.xtype AS system_type_id,
		c.utype AS user_type_id,
		c.length AS max_length,
		c.prec AS precision, c.scale,
		convert(sysname, CollationPropertyFromId(c.collationid, 'name')) AS collation_name,
		sysconv(bit, 1 - (c.status & 1)) AS is_nullable,		-- CPM_NOTNULL
		sysconv(bit, c.status & 2) AS is_ansi_padded,		-- CPM_NOTRIM
		sysconv(bit, c.status & 8) AS is_rowguidcol,			-- CPM_ROWGUIDCOL
		sysconv(bit, c.status & 4) AS is_identity,			-- CPM_IDENTCOL
		sysconv(bit, case when sov4.value is NULL then c.status & 16 else 0 end) is_computed,			-- CPM_COMPUTED
		sysconv(bit, c.status & 32) AS is_filestream,			-- CPM_FILESTREAM
		sysconv(bit, c.status & 0x020000) AS is_replicated,			-- CPM_REPLICAT
		sysconv(bit, c.status & 0x040000) AS is_non_sql_subscribed,	-- CPM_NONSQSSUB
		sysconv(bit, c.status & 0x080000) AS is_merge_published,	-- CPM_MERGEREPL
		sysconv(bit, c.status & 0x100000) AS is_dts_replicated,	-- CPM_REPLDTS
		sysconv(bit, c.status & 2048) AS is_xml_document,		-- CPM_XML_DOC 
		c.xmlns AS xml_collection_id,
		c.dflt AS default_object_id,
		c.chk AS rule_object_id,
		sysconv(bit, c.status & 0x1000000) AS is_sparse,	-- CPM_SPARSE
		sysconv(bit, c.status & 0x2000000) AS is_column_set,	-- CPM_SPARSECOLUMNSET
		convert(tinyint, case when c.status & 0x10000000 = 0x10000000 then 1 when c.status & 0x20000000 = 0x20000000 then 2 when sov3.value >= 3 AND sov3.value <= 6 then sov3.value else 0 end) as generated_always_type, -- CPM_TEMPORALSYSSTARTCOLUMN CPM_TEMPORALSYSENDCOLUMN
		convert(nvarchar(60), case when c.status & 0x10000000 = 0x10000000 then 'AS_ROW_START' when c.status & 0x20000000 = 0x20000000 then 'AS_ROW_END' when sov3.value = 3 then 'AS_SUSER_SID_START' when sov3.value = 4 then 'AS_SUSER_SID_END' when sov3.value = 5 then 'AS_SUSER_SNAME_START' when sov3.value = 6 then 'AS_SUSER_SNAME_END' else 'NOT_APPLICABLE' end) collate Latin1_General_CI_AS_KS_WS as generated_always_type_desc, -- These _DESC columns should always be the fixed latin collation. Reason is that unlike other columns in system tables that can change depending on the collation setting of the database/instance, these are always fixed on all installations of SQL Server.
		convert(int, (convert(bigint, sov.value) / 0x100) % 0x100) as encryption_type,
		convert(nvarchar(64), v1.name) as encryption_type_desc,
		convert(sysname, v2.name) as encryption_algorithm_name,
		sor.indepid as column_encryption_key_id,
		convert(sysname, sov2.value) collate catalog_default as column_encryption_key_database_name,
		sysconv(bit, c.status & 0x2000) AS is_hidden,		-- CPM_HIDDEN
		sysconv(bit, c.status & 0x40000000) AS is_masked,			-- CPM_DATAMASKED
		convert(int, sov4.value) as graph_type,
		convert(nvarchar(60), v3.name) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues sov ON sov.valclass = 115 /*SVC_COL_ENCRYPTION_MD*/ and sov.objid = c.id and sov.subobjid = c.colid and sov.valnum = 0 -- TYPE_AND_ALGORITHM
	LEFT JOIN sys.sysobjvalues sov2 ON sov2.valclass = 115 /*SVC_COL_ENCRYPTION_MD*/ and sov2.objid = c.id and sov2.subobjid = c.colid and sov2.valnum = 2 -- CEK_DATABASE_NAME
	LEFT JOIN sys.sysobjvalues sov3 ON sov3.valclass = 119 /*SVC_GENERATED_ALWAYS_COLUMN_TYPE*/ and sov3.objid = c.id and sov3.subobjid = c.colid
	LEFT JOIN sys.sysobjvalues sov4 ON sov4.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ and sov4.objid = c.id and sov4.subobjid = c.colid and sov4.valnum = 0
	LEFT JOIN sys.syssingleobjrefs sor ON sor.class = 113 /*SRC_COLUMN_TO_COL_ENCRYPTION_KEY*/ and sov.objid = sor.depid and sov.subobjid = sor.depsubid
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'CET' AND v1.value = convert(int, (convert(bigint, sov.value) / 0x100) % 0x100)
	LEFT JOIN sys.syspalvalues v2 ON v2.class = 'CEA' A"
1138	Parse Tree	View	-804582623	32767	6	4	1	3	2	251	0	1	1024	0	0	0	0	0	198	"CREATE VIEW sys.dm_exec_valid_use_hints AS
	SELECT name
	FROM OpenRowset(TABLE VALID_USE_HINTS)
"
1139	Parse Tree	View	-129939010	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	220	"CREATE VIEW sys.dm_os_enumerate_fixed_drives
AS
	SELECT *
	FROM OpenRowset(TABLE DM_OS_ENUM_FIXED_DRIVES)
"
1150	Compiled Plan	Adhoc	10815958	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_audit_class_type_map t
1150	Compiled Plan	Adhoc	10815958	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_audit_class_type_map t
1152	Parse Tree	View	-132597256	32767	6	4	1	7	3	251	0	1	1024	0	0	0	0	0	232	"CREATE VIEW sys.dm_xe_session_event_actions AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_SESSION_EVENT_ACTIONS, 0) 
"
1153	Parse Tree	View	-596959306	32767	6	4	1	13	6	251	0	1	1024	0	0	0	0	0	176	"CREATE view sys.dm_fts_index_population
AS
	SELECT * FROM OpenRowset(TABLE FTCRAWLS)
"
1154	Parse Tree	View	-419725127	32767	6	4	1	11	5	251	0	1	1024	0	0	0	0	0	652	"
-- add it
create view sys.dm_exec_external_operations as
select
	execution_id	collate database_default execution_id,
	step_index,
	operation_type	collate database_default operation_type,
	operation_name	collate database_default operation_name,
	map_progress,
	reduce_progress
from sys._dm_exec_external_operations
"
1160	Parse Tree	View	-586	32767	6	4	1	11	13	251	0	1	1024	0	0	0	0	0	2838	"
CREATE VIEW sys.dm_db_column_store_row_group_physical_stats AS

	SELECT rg.parent_object_id as [object_id],
		rg.parent_index_id as [index_id],
		rg.parent_part_number as [partition_number],
		rg.[row_group_id],
		rg.[delta_store_hobt_id],
		rg.[state],
		sdstate.[name] as state_desc,
		rg.[total_rows],
		rg.[deleted_rows],
		rg.[size_in_bytes],
		rg.[trim_reason],
		sdtrim.[name] as trim_reason_desc,
		rg.[transition_reason] as transition_to_compressed_state,
		sdtransition.[name] as transition_to_compressed_state_desc,
		rg.[has_vertipaq_optimization],
		rg.[generation],
		rg.[created_time],
		rg.[closed_time]
	FROM 
	(sys.syspalvalues sdstate 
	INNER hash JOIN  
	(sys.syspalvalues sdtrim 
	right OUTER hash JOIN 
	(sys.syspalvalues sdtransition 
	right OUTER hash JOIN 
	-- First parameter determines which table to open
	-- Second parameter determines the object id passed in
	-- Third parameter determines which view to show,
	-- 1 is to show dm_db_column_store_row_group_physical_stats
	-- 0 is to show fn_column_store_row_groups or column_store_row_groups
	OpenRowset(TABLE COLUMNSTORE_ROW_GROUPS, 0, 1) rg
		ON (sdtransition.class = 'RGTR' AND sdtransition.value = rg.transition_reason))
		ON (sdtrim.class = 'RGCR' AND sdtrim.value = rg.trim_reason))
		ON (sdstate.class = 'CSRG' AND sdstate.value = rg.state)) 
	WHERE has_access('CO', rg.parent_object_id) = 1;
"
1161	Parse Tree	View	-217	32767	1	4	1	3	16	251	0	1	1024	0	0	0	0	0	1848	"CREATE VIEW sys.server_principals AS
	SELECT p.name,
		p.id AS principal_id,
		p.sid, p.type,
		n.name AS type_desc,
		is_disabled = sysconv(bit, p.status & 0x80),
		p.crdate AS create_date,
		p.modate AS modify_date,
		p.dbname AS default_database_name,
		p.lang AS default_language_name,
		r.indepid AS credential_id,
		(case when p.id >= 2 and p.id < 11 then 1 else ro.indepid end) AS owning_principal_id,
		sysconv(bit, case when p.id >= 3 and p.id < 11 then 1 else 0 end) AS is_fixed_role		
	FROM master.sys.sysxlgns p
	LEFT JOIN sys.syspalnames n ON n.class = 'LGTY' AND n.value = p.type
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = p.id AND r.class = 63 AND r.depsubid = 0	-- SRC_LOGIN_CREDENTIAL
	LEFT JOIN sys.syssingleobjrefs ro ON ro.depid = p.id AND ro.class = 61 AND ro.depsubid = 0	-- SRC_SRVROLELOGINOWNER
	WHERE has_access('LG', p.id) = 1
		AND p.type <> 'M' -- exclude component logins
"
1161	Parse Tree	View	-217	32767	1	4	1	3	16	4345	0	1	1024	0	0	0	0	0	1848	"CREATE VIEW sys.server_principals AS
	SELECT p.name,
		p.id AS principal_id,
		p.sid, p.type,
		n.name AS type_desc,
		is_disabled = sysconv(bit, p.status & 0x80),
		p.crdate AS create_date,
		p.modate AS modify_date,
		p.dbname AS default_database_name,
		p.lang AS default_language_name,
		r.indepid AS credential_id,
		(case when p.id >= 2 and p.id < 11 then 1 else ro.indepid end) AS owning_principal_id,
		sysconv(bit, case when p.id >= 3 and p.id < 11 then 1 else 0 end) AS is_fixed_role		
	FROM master.sys.sysxlgns p
	LEFT JOIN sys.syspalnames n ON n.class = 'LGTY' AND n.value = p.type
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = p.id AND r.class = 63 AND r.depsubid = 0	-- SRC_LOGIN_CREDENTIAL
	LEFT JOIN sys.syssingleobjrefs ro ON ro.depid = p.id AND ro.class = 61 AND ro.depsubid = 0	-- SRC_SRVROLELOGINOWNER
	WHERE has_access('LG', p.id) = 1
		AND p.type <> 'M' -- exclude component logins
"
1161	Parse Tree	View	-217	32767	6	4	1	19	16	251	0	1	1024	0	0	0	0	0	1848	"CREATE VIEW sys.server_principals AS
	SELECT p.name,
		p.id AS principal_id,
		p.sid, p.type,
		n.name AS type_desc,
		is_disabled = sysconv(bit, p.status & 0x80),
		p.crdate AS create_date,
		p.modate AS modify_date,
		p.dbname AS default_database_name,
		p.lang AS default_language_name,
		r.indepid AS credential_id,
		(case when p.id >= 2 and p.id < 11 then 1 else ro.indepid end) AS owning_principal_id,
		sysconv(bit, case when p.id >= 3 and p.id < 11 then 1 else 0 end) AS is_fixed_role		
	FROM master.sys.sysxlgns p
	LEFT JOIN sys.syspalnames n ON n.class = 'LGTY' AND n.value = p.type
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = p.id AND r.class = 63 AND r.depsubid = 0	-- SRC_LOGIN_CREDENTIAL
	LEFT JOIN sys.syssingleobjrefs ro ON ro.depid = p.id AND ro.class = 61 AND ro.depsubid = 0	-- SRC_SRVROLELOGINOWNER
	WHERE has_access('LG', p.id) = 1
		AND p.type <> 'M' -- exclude component logins
"
1180	Parse Tree	View	-146561936	32767	6	4	1	5	11	251	0	1	1024	0	0	0	0	0	284	"
-- add it
create view sys.dm_pdw_nodes_exec_procedure_stats as
select *, convert(int, null) pdw_node_id from sys.dm_exec_procedure_stats
"
1180	Parse Tree	View	-244284919	32767	6	4	1	6	22	251	0	1	1024	0	0	0	0	0	2850	"CREATE VIEW sys.dm_exec_trigger_stats AS
	SELECT
		database_id,
		object_id,
		type,
		n.name AS type_desc,
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,	
		max_worker_time,
		total_physical_reads,
		last_physical_reads,
		min_physical_reads,
		max_physical_reads,
		total_logical_writes,
		last_logical_writes,
		min_logical_writes,
		max_logical_writes,
		total_logical_reads,
		last_logical_reads,
		min_logical_reads,
		max_logical_reads,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time,
		total_spills,
		last_spills,
		min_spills,
		max_spills
	FROM OpenRowset (TABLE TRIGGER_STATS) o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' 
		AND n.value = o.type
	UNION ALL
	SELECT 
		database_id,
		object_id,
		CAST ('TR' AS CHAR(2)),
		CAST ('SQL_TRIGGER' AS NVARCHAR(60)),
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,
		max_worker_time,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time,
		NULL,
		NULL,
		NULL,
		NULL
	FROM OpenRowset (TABLE XTP_PROC_STATS, ASCII('T') + (ASCII('R') * 256)) -- Procedure Object Type

"
1181	Parse Tree	View	-534160742	32767	6	4	1	11	3	251	0	1	1024	0	0	0	0	0	284	"CREATE VIEW sys.dm_hadr_availability_replica_cluster_nodes AS
	SELECT *
	FROM OpenRowset(TABLE DM_HADR_AVAILABILITY_REPLICA_CLUSTER_NODES)
"
1183	Parse Tree	View	-101	32767	1	4	1	2	13	251	0	1	1024	0	0	0	0	0	1682	"CREATE VIEW sys.all_objects AS
	SELECT 
		o.name, o.id AS object_id, r.indepid AS principal_id,
		o.nsid AS schema_id, o.pid AS parent_object_id,
		convert(char(2), case o.type when 'ET' then 'U' else o.type end) AS type,
		n.name AS type_desc,
		o.created AS create_date, o.modified AS modify_date,
		convert(bit, o.status & 1) AS is_ms_shipped,        -- OBJALL_MSSHIPPED
		convert(bit, o.status & 16) AS is_published,        -- OBJALL_RPL_PUBLISHED
		convert(bit, o.status & 64) AS is_schema_published	-- OBJALL_RPL_PUB_SCHONLY
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 97 AND r.depsubid = 0	-- SRC_OBJOWNER
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	WHERE o.nsclass not in (20,21)        -- excluding DDL trigger
		AND HAS_ACCESS('AO', o.id) = 1
"
1183	Parse Tree	View	-101	32767	6	4	1	23	13	251	0	1	1024	0	0	0	0	0	1682	"CREATE VIEW sys.all_objects AS
	SELECT 
		o.name, o.id AS object_id, r.indepid AS principal_id,
		o.nsid AS schema_id, o.pid AS parent_object_id,
		convert(char(2), case o.type when 'ET' then 'U' else o.type end) AS type,
		n.name AS type_desc,
		o.created AS create_date, o.modified AS modify_date,
		convert(bit, o.status & 1) AS is_ms_shipped,        -- OBJALL_MSSHIPPED
		convert(bit, o.status & 16) AS is_published,        -- OBJALL_RPL_PUBLISHED
		convert(bit, o.status & 64) AS is_schema_published	-- OBJALL_RPL_PUB_SCHONLY
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 97 AND r.depsubid = 0	-- SRC_OBJOWNER
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	WHERE o.nsclass not in (20,21)        -- excluding DDL trigger
		AND HAS_ACCESS('AO', o.id) = 1
"
1193	Parse Tree	View	-412	32767	6	4	1	20	13	251	0	1	1024	0	0	0	0	0	1668	"CREATE VIEW sys.triggers AS
	SELECT o.name,
		object_id = o.id,
		parent_class = o.pclass,
		parent_class_desc = pc.name,
		parent_id = o.pid,
		type = o.type,
		type_desc = n.name,
		create_date = o.created,
		modify_date = o.modified,
		is_ms_shipped = sysconv(bit, o.status & 1), 		-- OBJALL_MSSHIPPED
		is_disabled = sysconv(bit, o.status & 256), 		-- OBJTRG_DISABLED
		is_not_for_replication = sysconv(bit, o.status & 512), 	-- OBJTRG_NOTFORREPL
		is_instead_of_trigger = sysconv(bit, o.status & 1024) 	-- OBJTRG_INSTEADOF
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	LEFT JOIN sys.syspalvalues pc ON pc.class = 'UNCL' AND pc.value = o.pclass
	WHERE o.type IN ('TA','TR') AND o.pclass <> 100 -- x_eunc_Server
		AND has_access('TR', o.id, o.pid, o.nsclass) = 1
"
1200	Parse Tree	View	-314477199	32767	6	4	1	7	8	251	0	1	1024	0	0	0	0	0	296	"
-- add it
create view sys.dm_pdw_nodes_os_memory_cache_entries as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_cache_entries
"
1202	Parse Tree	View	-123002535	32767	6	4	1	3	7	251	0	1	1024	0	0	0	0	0	616	"CREATE VIEW sys.service_contracts$ AS
	SELECT o.name,
		service_contract_id = o.id,
		principal_id = p.indepid
	FROM sys.sysbinobjs o
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 54 AND p.depsubid = 0	-- SRC_CONTRACTOWNER
	WHERE o.class = 22 AND o.nsid = 0	-- SOC_SERVICECONTRACT
"
1207	Parse Tree	View	-504273378	32767	6	4	1	24	15	251	0	1	1024	0	0	0	0	0	2282	"CREATE VIEW sys.dm_db_mirroring_connections AS
    SELECT 
	    connection_id,
	    transport_stream_id,
	    state,
	    state_desc = sn.name,
	    connect_time,
	    login_time,
	    authentication_method,
	    principal_name,
	    remote_user_name,
	    last_activity_time,
	    is_accept,
	    login_state,
	    login_state_desc = ln.name,
	    peer_certificate_id,
	    encryption_algorithm = encalg,
	    encryption_algorithm_desc = ag.name,
	    receives_posted,
	    is_receive_flow_controlled,
	    sends_posted,
	    is_send_flow_controlled,
	    total_bytes_sent,
	    total_bytes_received,
	    total_fragments_sent,
	    total_fragments_received,
	    total_sends,
	    total_receives,
	    peer_arbitration_id,
	    address
    FROM OpenRowset (TABLE SBCONNECTIONENDPOINTS) as c
    LEFT OUTER JOIN sys.syspalvalues ag ON ag.class = 'EPET' AND ag.value = c.encalg
    LEFT OUTER JOIN sys.syspalvalues sn ON sn.class = 'EPCS' AND sn.value = c.state
    LEFT OUTER JOIN sys.syspalvalues ln ON ln.class = 'EPLS' AND ln.value = c.login_state
        WHERE c.endpoint_type = 1 -- x_eetDbMirroring
"
1208	Parse Tree	View	-363166918	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	672	"CREATE VIEW sys.dm_db_xtp_hash_index_stats
AS
	SELECT H.object_id,
		xtp_object_id,
		H.index_id,
		bucket_count AS total_bucket_count,
		bucket_count - filled_count AS empty_bucket_count,
		avg_chain_length,
		max_chain_length
	FROM OpenRowset(TABLE XTP_HASH_IDX_STATS) H
	WHERE H.object_id > 0 -- filter out system tables.
"
1212	Parse Tree	View	-214443872	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	296	"
-- add it
create view sys.dm_pdw_nodes_os_performance_counters as
select *, convert(int, null) pdw_node_id from sys.dm_os_performance_counters
"
1217	Parse Tree	View	-415917887	32767	6	4	1	7	5	251	0	1	1024	0	0	0	0	0	632	"
-- add it
create view sys.dm_pdw_hadoop_operations as
select
	request_id	collate database_default request_id,
	step_index,
	operation_type	collate database_default operation_type,
	operation_name	collate database_default operation_name,
	map_progress,
	reduce_progress
from sys._dm_pdw_hadoop_operations
"
1225	Parse Tree	View	-655454781	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	1138	"CREATE VIEW sys.dm_hadr_availability_replica_cluster_states AS
	SELECT 
		replica_id = arcs.replica_id,
		replica_server_name = arcs.replica_server_name,
		group_id = arcs.group_id,
		join_state = arcs.join_state,
		join_state_desc = CASE
			WHEN (join_state = 0) THEN CAST ('NOT_JOINED' AS nvarchar(60))
			WHEN (join_state = 1) THEN CAST ('JOINED_STANDALONE' AS nvarchar(60))
			WHEN (join_state = 2) THEN CAST ('JOINED_FCI' AS nvarchar(60))
			ELSE CAST (NULL AS nvarchar(60)) END
	FROM OpenRowset(TABLE DM_HADR_AVAILABILITY_REPLICA_CLUSTER_STATES) arcs
"
1226	Parse Tree	View	-238	32767	6	4	1	5	10	251	0	1	1024	0	0	0	0	0	1166	"CREATE VIEW sys.server_sql_modules AS
	SELECT object_id = o.id,
		definition = object_definition(o.id),
		uses_ansi_nulls = sysconv(bit, o.status & 0x40000),				-- OBJMOD_ANSINULLS
		uses_quoted_identifier = sysconv(bit, o.status & 0x80000), 		-- OBJMOD_QUOTEDIDENT
		execute_as_principal_id = x.indepid
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs x ON x.depid = o.id AND x.class = 23 AND x.depsubid = 0	-- SRC_OBJEXECASLOGIN
	WHERE o.type = 'TR' AND o.nsclass = 20 AND o.pclass = 100	-- x_eonc_TrgOnServer:x_eunc_Server
		AND has_access('TR', o.id, 0, 20) = 1
"
1236	Parse Tree	View	-239789495	32767	6	4	1	12	7	251	0	1	1024	0	0	0	0	0	868	"
-- add it
create view sys.dm_pdw_dms_external_work as
select
	request_id	collate database_default request_id,
	step_index,
	dms_step_index,
	work_id,
	pdw_node_id,
	type	collate database_default type,
	input_name 	collate database_default input_name,
	read_location,
	bytes_processed,
	length,
	start_time,
	end_time,
	total_elapsed_time,
	status	collate database_default status
from sys._dm_pdw_dms_external_work
"
1236	Parse Tree	View	-549	32767	6	4	1	20	14	251	0	1	1024	0	0	0	0	0	2038	"CREATE VIEW sys.selective_xml_index_paths AS
	SELECT i.id AS object_id,
		i.indid AS index_id,
		p.path_id,
		convert(nvarchar(4000), s.value) collate Latin1_General_BIN2 as path,
		p.name,
		p.path_type,
		p.path_type_desc,
		p.xml_component_id,
		convert(nvarchar(4000), s.imageval) collate Latin1_General_BIN2 as xquery_type_description,
		p.is_xquery_type_inferred,
		p.xquery_max_length,
		p.is_xquery_max_length_inferred,
		p.is_node,
		p.system_type_id,
		p.user_type_id,
		p.max_length,
		p.precision,
		p.scale,
		convert(sysname, CollationPropertyFromId(p.collationid, 'name')) AS collation_name,
		p.is_singleton
	FROM sys.sysidxstats i
	CROSS APPLY OPENROWSET(TABLE SELECTIVE_XML_INDEX_PATHS, i.id, i.indid) p
	LEFT JOIN sys.sysobjvalues s ON s.valclass = 108 and s.objid = i.id and s.subobjid = i.indid and s.valnum = p.path_id	-- SVC_SELECTIVE_DG
	WHERE (i.indid >= 256000 and i.indid < 257000) AND i.tinyprop = 76 -- is this selective XML index
		AND has_access('CO', i.id) = 1
"
1244	Parse Tree	View	-60845561	32767	6	4	1	12	6	251	0	1	1024	0	0	0	0	0	312	"
-- add it
create view sys.dm_pdw_nodes_os_memory_cache_clock_hands as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_cache_clock_hands
"
1258	Parse Tree	View	-433	32767	6	4	1	11	8	251	0	1	1024	0	0	0	0	0	832	"CREATE VIEW sys.partition_functions AS
	SELECT f.name,
		f.id AS function_id,
		f.type,
		n.name AS type_desc,
		f.intprop AS fanout,
		sysconv(bit, f.status & 1) AS boundary_value_on_right,
		sysconv(bit, f.status & 2) AS is_system,
		f.created AS create_date,
		f.modified AS modify_date
	FROM sys.sysclsobjs f
	LEFT JOIN sys.syspalnames n ON n.class = 'PFTY' AND n.value = f.type
	WHERE f.class = 30
"
1259	Parse Tree	View	-118980417	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	236	"
CREATE VIEW sys.dm_db_rda_schema_update_status
AS
SELECT * FROM OpenRowset(TABLE DM_DB_RDA_SCHEMA_UPDATE_STATUS)
"
1265	Parse Tree	View	-317783018	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	232	"CREATE VIEW sys.dm_hadr_internal_ag_listeners AS
	SELECT *
	FROM OpenRowset(TABLE DM_HADR_INTERNAL_AG_LISTENERS)
"
1273	Parse Tree	View	-636658177	32767	6	4	1	4	6	251	0	1	1024	0	0	0	0	0	312	"
-- add it
create view sys.dm_pdw_nodes_os_memory_cache_hash_tables as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_cache_hash_tables
"
1273	Parse Tree	View	-732774532	32767	6	4	1	21	9	251	0	1	1024	0	0	0	0	0	1324	"
-- add it
create view sys.dm_pdw_dms_workers as
select
	request_id	collate database_default request_id,
	step_index,
	dms_step_index,
	pdw_node_id,
	distribution_id,
	type	collate database_default type,
	status	collate database_default status,
	bytes_per_sec,
	bytes_processed,
	rows_processed,
	start_time,
	end_time,
	total_elapsed_time,
	cpu_time,
	query_time,
	buffers_available,
	dms_cpid,
	sql_spid,
	error_id	collate database_default error_id,
	source_info	collate database_default source_info,
	destination_info	collate database_default destination_info,
	command	collate database_default command
from sys._dm_pdw_dms_workers
"
1284	Parse Tree	View	-999657598	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	202	"CREATE VIEW sys.dm_os_dispatcher_pools AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_DISPATCHERPOOLS)
"
1286	Parse Tree	View	-651118071	32767	6	4	1	33	14	251	0	1	1024	0	0	0	0	0	1830	"
CREATE VIEW sys.dm_exec_sessions AS
	SELECT 
		session_id, login_time, host_name, program_name, host_process_id,
		client_version, client_interface_name, security_id, login_name, nt_domain,
		nt_user_name, status, context_info, cpu_time, memory_usage, total_scheduled_time,
		total_elapsed_time, endpoint_id, last_request_start_time, last_request_end_time,
		reads, writes, logical_reads, is_user_process, text_size, language, date_format,
		date_first, quoted_identifier, arithabort, ansi_null_dflt_on, ansi_defaults,
		ansi_warnings, ansi_padding, ansi_nulls, concat_null_yields_null, transaction_isolation_level,
		lock_timeout, deadlock_priority, row_count, prev_error, original_security_id, original_login_name,
		last_successful_logon, last_unsuccessful_logon, unsuccessful_logons, group_id, database_id,
		authenticating_database_id, open_transaction_count
	FROM OpenRowset(TABLE SYSSESSIONS)
"
1291	Parse Tree	View	-259	32767	6	4	1	18	6	251	0	1	1024	0	0	0	0	0	532	"CREATE VIEW sys.server_audits AS
	SELECT
		audit_id,
		name,
		audit_guid,
		create_date,
		modify_date,
		principal_id,
		type,
		type_desc,	
		on_failure,
		on_failure_desc ,
		is_state_enabled,
		queue_delay,
		predicate
	FROM sys.server_audits$ 
"
1301	Parse Tree	View	-570	32767	6	4	1	8	42	251	0	1	1024	0	0	0	0	0	5128	"CREATE VIEW sys.internal_partitions AS
	WITH Group1(partition_id, object_id, index_id, partition_number, 
			hobt_id, internal_object_type, row_group_id, rows, data_compression)
	AS
	(
	SELECT
		rs.rowsetid AS partition_id,
		-- The next 4 columns form a unique Composite ID for internal partition.
		rs.idmajor AS object_id, -- This is the first column
		rs.idminor AS index_id,  -- This is the second column
		rs.numpart AS partition_number, -- This is the third column
		rs.rowsetid AS hobt_id, -- This is the fourth column
		MAX(rs.ownertype) as internal_object_type,
		NULL AS row_group_id, -- No rowgroup id for delete bitmaps, delete buffer or mapping index.
		SUM(isnull(ct.rows, rs.rcrows))	AS rows,
		MAX(rs.cmprlevel)	AS data_compression
	FROM sys.sysrowsets rs OUTER APPLY OpenRowset(TABLE ALUCOUNT, rs.rowsetid, 0, 0, 0) ct 
	WHERE rs.ownertype IN (2,4,5) -- delete bitmaps, delete buffer and mapping index.
	GROUP BY rs.rowsetid, rs.idmajor, rs.idminor, rs.numpart
	),
	Group2(partition_id, object_id, index_id, partition_number, 
			hobt_id, internal_object_type, row_group_id, rows, data_compression )
	AS
	(
		SELECT
			rs.rowsetid AS partition_id, 
		-- The next 4 columns form a unique Composite ID for internal partition.
		rs.idmajor AS object_id, -- This is the first column
			rs.idminor AS index_id,  -- This is the second column
			rs.numpart AS partition_number, -- This is the third column
			rs.rowsetid AS hobt_id, -- This is the fourth column
			MAX(rs.ownertype) as internal_object_type,
		MAX(rg.row_group_id) AS row_group_id,
			SUM(isnull(ct.rows, rs.rcrows))	AS rows,
		MAX(rs.cmprlevel)	AS data_compression
		FROM sys.sysrowsets rs OUTER APPLY OpenRowset(TABLE ALUCOUNT, rs.rowsetid, 0, 0, 0) ct
	LEFT JOIN OpenRowset(TABLE COLUMNSTORE_ROW_GROUPS, 0, 0) rg ON 
		rs.idmajor = rg.parent_object_id AND rs.idminor = rg.parent_index_id AND rs.rowsetid = rg.delta_store_hobt_id
	WHERE rs.ownertype IN (3) -- deltastores
		GROUP BY rs.rowsetid, rs.idmajor, rs.idminor, rs.numpart
	)
	SELECT 
		P.partition_id,
		P.object_id,
		P.index_id,
		P.partition_number,
		P.hobt_id,
		P.internal_object_type,
		rst.name as internal_object_type_desc,
		P.row_group_id, 
		P.rows, 
		P.data_compression,
		cl.name AS data_compression_desc
	FROM (SELECT * from Group1
		UNION ALL
		SELECT * from Group2) AS P
	LEFT JOIN sys.syspalvalues cl ON cl.class = 'CMPL' AND cl.value = P.data_compression
	LEFT JOIN sys.syspalvalues rst ON rst.class = 'ROTY' AND rst.value = P.internal_object_type
"
1302	Parse Tree	View	-201	32767	6	4	1	12	4	251	0	1	1024	0	0	0	0	0	172	"CREATE VIEW sys.syscursortables AS
	SELECT *
	FROM OpenRowSet(TABLE SYSCURSORTBLS)
"
1307	Parse Tree	View	-224699861	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	240	"CREATE VIEW sys.dm_resource_governor_resource_pool_affinity AS
	SELECT *
	FROM OpenRowSet(TABLE DM_RG_POOL_AFFINITY)
"
1313	Parse Tree	View	-143	32767	6	4	1	6	12	251	0	1	1024	0	0	0	0	0	1826	"CREATE VIEW sys.sysfiles AS
	SELECT
		fileid = convert(smallint, fileid & 0x7fff),
		groupid = convert(smallint, grpid),
		size = isnull(FilePropertyById(fileid, 'size'), size),
		maxsize, growth,
		status = convert(int,
					case filetype when 1 then 66 else 2 end  -- x_eft_SQLLog, FCB_LOG_DEVICE, FCB_DSK_DEVICE
					+ (status & 8) * 2 -- FCB_READONLY_MEDIA
					+ (status & 16) * 256 -- FCB_READONLY
					+ case filestate when 6 then 268435456 else 0 end -- OFFLINE, FCB_OFFLINE
					+ (status & 256) * 2097152 -- FCB_SPARSE_FILE
					+ (status & 32) * 32768 -- FCB_PERCENT_GROWTH
					+ (status & 2048) / 2048), --FCB_PMM_METADATA
		perf = convert(int, 0),
		name = lname,
		filename = trim_path(pname)
	FROM sys.sysprufiles
	WHERE filetype IN (0, 1) -- x_eft_SQLData, x_eft_SQLLog (bwkcmpt types)
		AND filestate NOT IN (1, 2, 3) -- x_efs_Dummy, x_efs_Dropped, x_efs_DroppedReusePending
"
1315	Parse Tree	View	-118955752	32767	6	4	1	19	7	251	0	1	1024	0	0	0	0	0	1060	"
-- add it
create view sys.dm_pdw_request_steps as
select
	request_id	collate database_default request_id,
	step_index,
	operation_type	collate database_default operation_type,
	distribution_type	collate database_default distribution_type,
	location_type	collate database_default location_type,
	status		collate database_default status,
	error_id	collate database_default error_id,
	start_time,
	end_time,
	total_elapsed_time,
	row_count,
	command		collate database_default command
from sys._dm_pdw_request_steps
"
1323	Parse Tree	View	-454	32767	6	4	1	23	24	251	0	1	1024	0	0	0	0	0	3042	"CREATE VIEW sys.xml_schema_elements AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id,
		sysconv(bit, c.status & 1) AS is_default_fixed,
		sysconv(bit, c.status & 2) AS is_abstract,
		sysconv(bit, c.status & 8) AS is_nillable,
		sysconv(bit, c.status & 16) AS must_be_qualified,
		sysconv(bit, c.status & 32) AS is_extension_blocked,
		sysconv(bit, c.status & 64) AS is_restriction_blocked,
		sysconv(bit, c.status & 128) AS is_substitution_blocked,
		sysconv(bit, c.status & 256) AS is_final_extension,
		sysconv(bit, c.status & 512) AS is_final_restriction,
		c.defval AS default_value
	FROM sys.sysxmlcomponent c
	LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	WHERE c.symspace = 'E'
		AND has_access('XC', c.id, c.xsdid) = 1
"
1331	Parse Tree	View	-255560655	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	176	"create view sys.trace_categories as select * from OpenRowset(TABLE SYSTRACECATEGORIES)
"
1334	Parse Tree	View	-396	32767	6	4	1	23	25	251	0	1	1024	0	0	0	0	0	5134	"CREATE VIEW sys.identity_columns AS
	SELECT object_id = id,
		name = c.name,
		column_id = colid,
		system_type_id = xtype,
		user_type_id = utype,
		max_length = length,
		precision = prec,
		scale = scale,
		collation_name = convert(sysname,CollationPropertyFromId(collationid,'name')),
		is_nullable = sysconv(bit, 1 - (status & 1)), 	-- CPM_NOTNULL
		is_ansi_padded = sysconv(bit, status & 2), 	-- CPM_NOTRIM
		is_rowguidcol = sysconv(bit, status & 8), 	-- CPM_ROWGUIDCOL
		is_identity = sysconv(bit, status & 4), 		-- CPM_IDENTCOL
		is_filestream = sysconv(bit, status & 32), 	-- CPM_FILESTREAM
		is_replicated = sysconv(bit, status & 0x20000), 	-- CPM_REPLICAT
		is_non_sql_subscribed = sysconv(bit, status & 0x40000), 	-- CPM_NONSQSSUB
		is_merge_published = sysconv(bit, status & 0x80000), 		-- CPM_MERGEREPL
		is_dts_replicated = sysconv(bit, status & 0x100000), 		-- CPM_REPLDTS
		is_xml_document = sysconv(bit, 0),
		xml_collection_id = sysconv(int, 0),
		default_object_id = sysconv(int, 0),
		rule_object_id = sysconv(int, 0),
		seed_value = IdentityProperty(id, 'SeedValue'),
		increment_value = IdentityProperty(id, 'IncrementValue'),
		last_value = IdentityProperty(id, 'LastValue'),
		is_not_for_replication = sysconv(bit, status & 0x10000),	-- CPM_ID_REPL
		is_computed = sysconv(bit, status & 16),			-- CPM_COMPUTED				
		sysconv(bit, 0) as is_sparse,
		sysconv(bit, 0) as is_column_set,
		convert(tinyint, 0) AS generated_always_type,
		convert(nvarchar(60), 'NOT_APPLICABLE') collate Latin1_General_CI_AS_KS_WS AS generated_always_type_desc,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) collate catalog_default as column_encryption_key_database_name,
		sysconv(bit, 0) as is_hidden,
		sysconv(bit, status & 0x40000000) AS is_masked, -- CPM_DATAMASKED
		convert(int, sov1.value) as graph_type,
		convert(nvarchar(60), v1.name) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues sov1 ON sov1.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ and sov1.objid = id and sov1.subobjid = colid and sov1.valnum = 0
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'EGCT' AND v1.value = convert(int, sov1.value)
	WHERE number = 0	-- SOC_COLUMN
		AND (status & 4) = 4 	-- CPM_IDENTCOL
		AND has_access('CO', id) = 1
"
1359	Parse Tree	View	-495395802	32767	6	4	1	14	16	251	0	1	1024	0	0	0	0	0	2406	"CREATE VIEW sys.dm_db_xtp_checkpoint_files
AS
	SELECT	df.[file_id] as container_id,
			cf.[container_guid],
			cf.[file_id] as 'checkpoint_file_id',
			cf.[relative_path] as 'relative_file_path',
			cf.[file_type],
			pv.[name] as 'file_type_desc',
			cf.[storage_array_index] as 'internal_storage_slot',
			cf.[pair_file_id] as 'checkpoint_pair_file_id',
			cf.[allocated_bytes] as 'file_size_in_bytes',
			cf.[used_bytes] as 'file_size_used_in_bytes',
			cf.[logical_row_count],
			cf.[state],
			pv2.[name] as 'state_desc',
			cf.[min_transaction_id] as 'lower_bound_tsn',
			cf.[max_transaction_id] as 'upper_bound_tsn',
			cf.[begin_checkpoint_id],
			cf.[end_checkpoint_id],
			cf.[last_checkpoint_id] as 'last_updated_checkpoint_id',
			cf.[encryption_status],
			pv3.[name] as 'encryption_status_desc'
	FROM 
		OpenRowset(TABLE XTP_CKPT_FILESV2) cf JOIN
		sys.database_files df ON cf.[container_guid] = df.[file_guid] JOIN
		sys.syspalvalues pv ON pv.class = 'CFT2' and pv.value = cf.[file_type] JOIN
		sys.syspalvalues pv2 ON pv2.class = 'CFS2' and pv2.value = cf.[state] LEFT JOIN
		sys.syspalvalues pv3 ON pv3.class = 'CFES' and pv3.value = cf.[encryption_status]
"
1364	Compiled Plan	Adhoc	193710469	6	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.database_automatic_tuning_mode t
1364	Compiled Plan	Adhoc	193710469	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.database_automatic_tuning_mode t
1367	Parse Tree	View	-222	32767	1	4	1	1	5	251	0	1	1024	0	0	0	0	0	604	"CREATE VIEW	sys.linked_logins AS
	SELECT srvid AS server_id,
		lgnid AS local_principal_id,
		sysconv(bit, status & 1) AS uses_self_credential,	-- LGN_LINKED_USESELF
		name AS remote_name,
		modate AS modify_date
	FROM master.sys.syslnklgns
	WHERE lgnid = suser_id() OR has_access('SR', 0) = 1
"
1367	Parse Tree	View	-222	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	604	"CREATE VIEW	sys.linked_logins AS
	SELECT srvid AS server_id,
		lgnid AS local_principal_id,
		sysconv(bit, status & 1) AS uses_self_credential,	-- LGN_LINKED_USESELF
		name AS remote_name,
		modate AS modify_date
	FROM master.sys.syslnklgns
	WHERE lgnid = suser_id() OR has_access('SR', 0) = 1
"
1383	Compiled Plan	Adhoc	584511716	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.server_principals t
1383	Compiled Plan	Adhoc	584511716	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.server_principals t
1389	Parse Tree	View	-106	32767	6	4	1	8	45	251	0	1	1024	0	0	0	0	0	8100	"-- Return visible system objects in master database context
CREATE VIEW sys.syscolumns AS
	SELECT c.name, c.id, c.xtype,
		typestat = convert(tinyint, c.status & 3),	-- (1-is_nullable) + is_ansi_padded * 2
		xusertype = convert(smallint, c.utype),
		c.length, xprec = c.prec,
		xscale = c.scale,
		colid = convert(smallint, c.colid),
		xoffset = convert(smallint, 0),
		bitpos = convert(tinyint, 0),
		reserved = convert(tinyint, 0),
		colstat = convert(smallint,
			(c.status & 4)/4				-- CPM_IDENTCOL (is_identity)
			+ (c.status & 8)/4			-- CPM_ROWGUIDCOL (is_rowguidcol * 2)
			+ (case when sov4.value is null then (c.status & 16)/4 else 0 end)			-- CPM_COMPUTED (is_computed * 4)
			+ (c.status & 512)/128		-- CPM_OUTPUT (is_output * 4)
			+ (c.status & 1024)/32		-- CPM_CURSORREF (is_cursor_ref * 32)					
			+ (c.status & 0x20000)/32		-- CPM_REPLICAT (is_replicated * 4096)
			+ (c.status & 0x40000)/32		-- CPM_NONSQSSUB (is_non_sql_subscribed * 8192)
			+ (c.status & 0x80000)/32		-- CPM_MERGEREPL (is_merge_published * 16384)
			+ (c.status & 0x100000)/32),	-- CPM_REPLDTS (is_dts_replicated * 32768)
		cdefault = c.dflt,
		domain = c.chk,
		number = convert(smallint, case c.number when 1 then 1 - objectproperty(c.id, 'isscalarfunction') else c.number end),
		colorder = convert(smallint, c.colid),
		autoval = convert(varbinary(8000), null),
		offset  = convert(smallint, case c.number when 0 then columnproperty(c.id, c.name, 'sql65offset') else 0 end),
		c.collationid,
		language = case c.number when 0 then columnproperty(c.id, c.name, 'fulltextlcid') else 0 end,
		status = convert(tinyint,
			(1-(c.status & 1))*8			-- CPM_NOTNULL (is_nullable * 8)
			+ case when (c.status & 2 <> 0) or (c.xtype in (34, 35) and c.status & 0x20000 <> 0)	-- CPM_NOTRIM,CPM_REPLICAT
			then 16 else 0 end			-- image, text (is_ansi_padded <> 0 or (system_type_id in (34, 35) and is_replicated <> 0))
			+ case when (c.xtype in (34, 35) and c.status & 0x40000 <> 0) or (c.xtype in (173, 175, 189) and c.status & 1 = 0)
			then 32 else 0 end			-- (is_non_sql_subscribed <> 0 and image/text) or is_nullable and timestamp/char/binary
			+ (c.status & 512)/8			-- CPM_OUTPUT (is_output * 64)
			+ (case when sov4.value is null then ((c.status & 16) * 4) else 0 end)			-- CPM_COMPUTED (is_computed*64)
			+ (c.status & 4)*32),			-- CPM_IDENTCOL (is_identity * 128)
		type = xtypetotds(c.xtype, 1 - (c.status & 1)),	-- CPM_NOTNULL (is_nullable)
		usertype = convert(smallint, columnproperty(c.id, c.name, 'oldusertype')),
		printfmt = convert(varchar(255), null),
		prec = convert(smallint,
			case when c.xtype in (34, 35, 99) then null	-- ntext, image, text
			when c.xtype = 36 then c.prec					-- uniqueidentifier
			when c.length = -1 then -1					-- new style large objects
			else odbcprec(c.xtype, c.length, c.prec) end),
		scale = odbcscale(c.xtype, c.scale),
		iscomputed = convert(int, case when sov4.value is null then (c.status & 16)/16 else 0 end),	-- CPM_COMPUTED (is_computed)
		isoutparam = convert(int, (c.status & 512)/512),	-- CPM_OUTPUT (is_output)
		isnullable = convert(int, 1 - (c.status & 1)),	-- CPM_NOTNULL (is_nullable)
		collation = convert(sysname, collationpropertyfromid(collationid, 'name')),
		tdscollation = convert(binary(5), collationpropertyfromid(collationid, 'tdscollation'))
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues sov4 ON sov4.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ and sov4.objid = c.id and sov4.subobjid = c.colid and sov4.valnum = 0
	WHERE has_access('CO', c.id) = 1
	UNION ALL
	SELECT c.name collate catalog_default AS name,
		c.id, c.xtype, c.typestat, c.xusertype, c.length, c.xprec, c.xscale,
		c.colid, c.xoffset, c.bitpos, c.reserved, c.colstat, c.cdefault,
		c.domain, c.number, c.colorder, c.autoval, c.offset, c.collationid,
		c.language, c.status, c.type, c.usertype, c.printfmt, c"
1395	Parse Tree	View	-541412146	32767	6	4	1	11	5	251	0	1	1024	0	0	0	0	0	562	"
-- add it
create view sys.dm_exec_distributed_requests as
select
	sql_handle,
	execution_id	collate database_default execution_id,
	status			collate database_default status,
	error_id,
	start_time,
	end_time,
	total_elapsed_time
from sys._dm_exec_distributed_requests
"
1399	Parse Tree	View	-417	32767	6	4	1	16	18	251	0	1	1024	0	0	0	0	0	2052	"CREATE VIEW sys.assembly_modules AS
	SELECT object_id = o.id,
		assembly_id = asm.indepid,
		assembly_class = convert(sysname, v.value) collate Latin1_General_BIN,
		assembly_method = convert(sysname, m.value) collate Latin1_General_BIN,
		null_on_null_input = sysconv(bit, o.status & 0x200000),	-- OBJMOD_NULLONNULL
		execute_as_principal_id = x.indepid
	FROM sys.sysschobjs$ o
	JOIN sys.syssingleobjrefs asm ON asm.depid = o.id AND asm.class = 11 AND asm.depsubid = 0 	-- SRC_MODULETOASM
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 11 AND v.objid = o.id AND v.subobjid = 0 AND v.valnum = 1 	-- SVC_OBJASMENTRY,ASMENTRY_CLASS
	LEFT JOIN sys.sysobjvalues m ON m.valclass = 11 AND m.objid = o.id AND m.subobjid = 0 AND m.valnum = 2 	-- SVC_OBJASMENTRY,ASMENTRY_METHOD
	LEFT JOIN sys.syssingleobjrefs x ON x.depid = o.id AND x.class = 22 AND x.depsubid = 0	-- SRC_OBJEXECASOWNER
	WHERE o.pclass <> 100	-- x_eunc_Server
		AND type IN ('AF','PC','FS','FT','TA')
		AND has_access('SQ', o.id, o.pid, o.nsclass) = 1
"
1414	Compiled Plan	Adhoc	95875136	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.selective_xml_index_paths t
1414	Compiled Plan	Adhoc	95875136	6	0	-2	2	1	24	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.selective_xml_index_paths t
1432	Parse Tree	View	-243	32767	6	4	1	4	11	251	0	1	1024	0	0	0	0	0	1180	"CREATE VIEW sys.master_key_passwords AS
	SELECT
		co.id AS credential_id,
		convert(uniqueidentifier, 
			stringtovarbinary(convert(varchar(128),
									SUBSTRING ( co.name, 
												charindex('_', co.name) + 1,
												charindex('_', co.name, charindex('_', co.name) + 1) - charindex('_', co.name) - 1)
			   )			   )		 ) AS family_guid
	FROM master.sys.sysclsobjs co
	LEFT JOIN master.sys.sysobjvalues ov ON ov.valclass = 28 AND ov.objid = co.id AND ov.subobjid = 0 AND ov.valnum = 1
	WHERE co.class = 57
		AND has_access('CR', 0) = 1 AND co.name LIKE '##DBMKEY_%'
"
1453	Parse Tree	View	-496	32767	6	4	1	2	6	251	0	1	1024	0	0	0	0	0	600	"CREATE VIEW sys.function_order_columns AS
	SELECT idmajor AS object_id,
		subid AS order_column_id,
		intprop AS column_id,
	  	convert (bit, status & 0x4) AS is_descending	-- ISC_IC_DESC_KEY
	FROM sys.sysiscols
	WHERE (status & 64) <> 0 -- ISC_ORDER_HINT
		AND has_access('CO', idmajor) = 1
"
1458	Parse Tree	View	-253460977	32767	6	4	1	2	7	251	0	1	1024	0	0	0	0	0	206	"CREATE VIEW sys.dm_db_xtp_gc_cycle_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_GC_CYCLE_STATS)
"
1464	Parse Tree	View	-438	32767	6	4	1	11	11	251	0	1	1024	0	0	0	0	0	978	"CREATE VIEW sys.partition_schemes AS
	SELECT o.name AS name,
		o.id AS data_space_id,
		o.type AS type,
		c.name AS type_desc,
		sysconv(bit, o.status & 0x1) AS is_default,
		sysconv(bit, o.status & 0x4) AS is_system,
		r.indepid AS function_id
	FROM sys.sysclsobjs o
	JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 31 AND r.depsubid = 0 -- SRC_PRTSCHFUNC
	LEFT JOIN sys.syspalnames c ON c.class = 'DSTY' AND c.value = o.type
	WHERE o.class = 31 AND o.type = 'PS'
"
1470	Parse Tree	View	-391819058	32767	6	3	1	33	17	251	0	1	1024	0	0	0	0	0	1878	"CREATE VIEW INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
AS
SELECT
	DB_NAME()				AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(f.schema_id)		AS CONSTRAINT_SCHEMA,
	f.name					AS CONSTRAINT_NAME,
	DB_NAME()				AS UNIQUE_CONSTRAINT_CATALOG,
	SCHEMA_NAME(t.schema_id)		AS UNIQUE_CONSTRAINT_SCHEMA,
	i.name					AS UNIQUE_CONSTRAINT_NAME,
	convert(varchar(7), 'SIMPLE')	AS MATCH_OPTION,
	convert(varchar(11), CASE f.update_referential_action
		WHEN 0 THEN 'NO ACTION'
		WHEN 1 THEN 'CASCADE'
		WHEN 2 THEN 'SET NULL'
		WHEN 3 THEN 'SET DEFAULT' END) AS UPDATE_RULE,
	convert(varchar(11), CASE f.delete_referential_action
		WHEN 0 THEN 'NO ACTION'
		WHEN 1 THEN 'CASCADE'
		WHEN 2 THEN 'SET NULL'
		WHEN 3 THEN 'SET DEFAULT' END) AS DELETE_RULE
FROM		
	sys.foreign_keys f
	LEFT JOIN sys.indexes i ON i.object_id = f.referenced_object_id AND i.index_id = f.key_index_id
	LEFT JOIN sys.tables t ON t.object_id = f.referenced_object_id
"
1491	Parse Tree	View	-486135952	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	160	"create view sys.trace_events as select * from OpenRowset(TABLE SYSTRACEEVENTS)
"
1497	Parse Tree	View	-264	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	324	"CREATE VIEW sys.fulltext_semantic_language_statistics_database AS
	SELECT database_id, register_date, registered_by, version
	FROM master.sys.sysftsemanticsdb
"
1508	Parse Tree	View	-206	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	458	"CREATE VIEW sys.sysmessages AS
	SELECT
		message_id AS error,
		severity,
		convert(smallint, is_event_logged * 128) AS dlevel,
		convert(nvarchar(255), text) AS description,
		language_id AS msglangid
	FROM sys.messages
"
1510	Compiled Plan	Adhoc	56946395	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	120	SELECT t.* FROM sys.parameter_xml_schema_collection_usages t
1518	Parse Tree	View	-517	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	492	"CREATE VIEW sys.filetable_system_defined_objects AS
	SELECT
		o.id AS object_id,
		o.pid AS parent_object_id
	FROM sys.sysschobjs$ o
	WHERE sysconv(bit, o.status2 & 0x00000001) = 1 -- OBJALL2_SYSTEM_SCHEMA
		AND has_access('CO', o.id) = 1
"
1518	Parse Tree	View	-261030829	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	538	"
-- add it
create view sys.pdw_diag_sessions as
select
	name	collate database_default name,
	xml_data	collate database_default xml_data,
	is_active,
	host_address	collate database_default host_address,
	principal_id,
	database_id
from sys._pdw_diag_sessions
"
1519	Parse Tree	View	-148	32767	1	4	1	1	13	187	0	1	1024	0	0	0	0	0	1070	"CREATE VIEW sys.obd_state AS
	SELECT convert(sysname, c.name) AS component_name,
		s.name AS schema_name,
		o.name AS object_name,
		convert(tinyint, convert(int, c.value) & 1) AS state,
		o.type
	FROM sys.sysobjkeycrypts k
	JOIN sys.sysschobjs$ o ON o.id = k.id
	JOIN master.sys.sysxlgns l ON l.type = 'M' AND substring(l.sid, 13, 28) = k.thumbprint
	JOIN master.sys.configurations c ON c.name = substring(l.name, 3, len(l.name) - 4)
	LEFT JOIN sys.schemas s ON s.schema_id = o.nsid
	WHERE k.class = 1 AND k.type = 'INCP'
"
1529	Parse Tree	View	-459	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	730	"CREATE VIEW sys.xml_schema_component_placements AS
	SELECT placingid AS xml_component_id,
		ordinal AS placement_id,
		placedid AS placed_xml_component_id,
		sysconv(bit, status & 1) AS is_default_fixed,
		minoccur AS min_occurences,
		maxoccur AS max_occurences,
		defval AS default_value
	FROM sys.sysxmlplacement
	WHERE has_access('XC', placingid) = 1
"
1532	Parse Tree	View	-599325421	32767	6	4	1	4	3	251	0	1	1024	0	0	0	0	0	180	"CREATE view sys.dm_fts_memory_buffers
AS
	SELECT * FROM OpenRowset(TABLE FTMEMBUFFERS)
"
1540	Parse Tree	View	-401	32767	6	4	1	7	13	187	0	1	1024	0	0	0	0	0	1700	"CREATE VIEW sys.index_columns AS
	SELECT isc.idmajor AS object_id,
		isc.idminor AS index_id,
		isc.subid AS index_column_id,
		isc.intprop AS column_id,
	  	isc.tinyprop1 AS key_ordinal,
	  	isc.tinyprop2 AS partition_ordinal,
	  	convert (bit, isc.status & 0x4) AS is_descending_key,	-- ISC_IC_DESC_KEY
		convert (bit, isc.status & 0x10) AS is_included_column	-- ISC_IC_INCLUDED
	FROM sys.sysiscols isc
	INNER JOIN sys.sysschobjs$ obj ON obj.id = isc.idmajor
	INNER JOIN sys.sysidxstats idxstats ON obj.id = idxstats.id AND isc.idminor = idxstats.indid
	WHERE (isc.status & 2) <> 0
		AND has_access('CO', isc.idmajor) = 1	-- ISC_IND_COL
		AND (isc.status & 0x10 = 0 OR obj.status2 & 0x00000008 = 0 OR isc.idminor = 1)	-- ISC_IC_INCLUDED, OBJTAB2_HEKATON, ISC_IC_IDMINOR
		AND (idxstats.status & 0x04000000) = 0 -- !IS_IND_RESUMABLE
"
1543	Parse Tree	View	-995830047	32767	6	4	1	2	9	251	0	1	1024	0	0	0	0	0	202	"CREATE VIEW sys.dm_xtp_transaction_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_SYSTEM_STATS)
"
1568	Parse Tree	View	-592772559	32767	6	4	1	17	4	251	0	1	1024	0	0	0	0	0	182	"CREATE VIEW sys.dm_os_child_instances AS
	SELECT * FROM OpenRowset(TABLE CHILDINSTANCES)
"
1571	Parse Tree	View	-77438453	32767	6	4	1	11	3	251	0	1	1024	0	0	0	0	0	172	"CREATE VIEW sys.login_token AS
	SELECT * FROM OpenRowset(TABLE LOGINROLESANDGROUPS)
"
1572	Parse Tree	View	-596	32767	6	4	1	7	15	251	0	1	1024	0	0	0	0	0	2050	"CREATE VIEW sys.query_store_wait_stats AS
	SELECT
		wait_stats_id,
		plan_id,
		runtime_stats_interval_id,
		wait_category,
		c.name as wait_category_desc,
		execution_type,
		n.name as execution_type_desc,
		total_query_wait_time_ms,
		avg_query_wait_time_ms,
		last_query_wait_time_ms,
		min_query_wait_time_ms,
		max_query_wait_time_ms,
		CASE WHEN sqdiff_query_wait_time_ms >= 0 THEN sqrt(sqdiff_query_wait_time_ms) ELSE NULL END as stdev_query_wait_time_ms
	FROM
	(
		SELECT
		*,
		round( convert(float, sumsquare_query_wait_time_ms) / count_executions - avg_query_wait_time_ms * avg_query_wait_time_ms,2) as sqdiff_query_wait_time_ms
		FROM
		(
			SELECT 
			ws.*,
			CONVERT(float, total_query_wait_time_ms) / count_executions AS avg_query_wait_time_ms
			FROM sys.plan_persist_wait_stats_merged ws
		) AS AVG_VAL
	) AS AVG_SQ_VAL
	LEFT JOIN sys.syspalvalues c ON c.class = 'WCAT' and c.value = wait_category
	LEFT JOIN sys.syspalvalues n ON n.class = 'QDXT' and n.value = execution_type
"
1573	Parse Tree	View	-921329122	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	190	"CREATE VIEW sys.dm_xtp_gc_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_SYSTEM_GC_STATS)
"
1573	Parse Tree	View	-227	32767	6	4	1	26	26	251	0	1	1024	0	0	0	0	0	4002	"CREATE VIEW sys.http_endpoints AS
	SELECT e.name, e.id AS endpoint_id,
		o.indepid AS principal_id,
		e.protocol, p.name AS protocol_desc,
		e.type, t.name AS type_desc,
		convert(tinyint, e.bstat & 3) AS state,	-- BSTAT_STATEMASK
		s.name AS state_desc,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		e.site,
		convert(nvarchar(4000), v.value) collate Latin1_General_CI_AS_KS_WS AS url_path,
		sysconv(bit, e.pstat & 1) AS is_clear_port_enabled,		-- PSTAT_HTTP_CLEARPORT
		e.port1 AS clear_port,
		sysconv(bit, e.pstat & 2) AS is_ssl_port_enabled,		-- PSTAT_HTTP_SSLPORT
		e.port2 AS ssl_port,
		sysconv(bit, 0) AS is_anonymous_enabled,				-- is_anonymous_enabled is always zero.
		sysconv(bit, e.pstat & 8) AS is_basic_auth_enabled,		-- PSTAT_HTTP_BASICAUTH
		sysconv(bit, e.pstat & 16) AS is_digest_auth_enabled,		-- PSTAT_HTTP_DIGESTAUTH
		sysconv(bit, (e.pstat & (32|64))) AS is_kerberos_auth_enabled,	-- PSTAT_HTTP_INTEGAUTH | PSTAT_HTTP_KERBEROS
		sysconv(bit, (e.pstat & (32|256))) AS is_ntlm_auth_enabled,	-- PSTAT_HTTP_INTEGAUTH |PSTAT_HTTP_NTLM
		sysconv(bit, case when (e.pstat & 32) <> 0 or (e.pstat & 320)=320 then 1 else 0 end) AS is_integrated_auth_enabled,	-- PSTAT_HTTP_INTEGAUTH | (PSTAT_HTTP_KERBEROS & PSTAT_HTTP_NTLM)
		e.authrealm AS authorization_realm,
		e.dfltdm AS default_logon_domain,
		sysconv(bit, e.pstat & 128) AS is_compression_enabled 		-- PSTAT_HTTP_COMPRESS
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 46 AND v.objid = e.id AND v.subobjid = 0 AND v.valnum = 1	-- SVC_EP_PROPS
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	WHERE e.protocol = 1
		AND has_access('HE', e.id) = 1
"
1579	Parse Tree	View	-53812200	32767	6	4	1	7	5	251	0	1	1024	0	0	0	0	0	688	"
-- add it
create view sys.dm_pdw_os_threads as
select
	pdw_node_id,
	thread_id,
	process_id,
	name	collate database_default name,
	priority,
	start_time,
	state	collate database_default state,
	wait_reason	collate database_default wait_reason,
	total_processor_elapsed_time,
	total_user_elapsed_time
from sys._dm_pdw_os_threads
"
1580	Parse Tree	View	-537861001	32767	6	4	1	21	12	251	0	1	1024	0	0	0	0	0	292	"
-- add it
create view sys.pdw_nodes_columns as
select *, convert(int, null) pdw_node_id, convert(int, null) distribution_id from sys.columns
"
1583	Parse Tree	View	-538	32767	6	4	1	4	19	251	0	1	1024	0	0	0	0	0	3546	"CREATE VIEW sys.query_store_query AS
	SELECT 
		query_id,
		query_text_id,
		context_settings_id,
		object_id,
		CAST(batch_sql_handle AS VARBINARY(44)) as batch_sql_handle,
		query_hash,
		is_internal_query,
		query_param_type as query_parameterization_type,
		n.name as query_parameterization_type_desc,
		initial_compile_start_time,
		last_compile_start_time,
		last_execution_time,
		CAST(last_compile_batch_sql_handle AS VARBINARY(44)) as last_compile_batch_sql_handle,
		last_compile_batch_offset_start,
		last_compile_batch_offset_end,
		compile_count as count_compiles,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_compile_duration) / compile_count END as avg_compile_duration,
		last_compile_duration,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_bind_duration) / compile_count END as avg_bind_duration,
		last_bind_duration,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_bind_cpu_time) / compile_count END as avg_bind_cpu_time,
		last_bind_cpu_time,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_optimize_duration) / compile_count END as avg_optimize_duration,
		last_optimize_duration,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_optimize_cpu_time) / compile_count END as avg_optimize_cpu_time,
		last_optimize_cpu_time,
		CASE WHEN compile_count = 0 THEN NULL ELSE convert(float, total_compile_memory_kb) / compile_count END as avg_compile_memory_kb,
		last_compile_memory_kb,
		max_compile_memory_kb,
		CASE WHEN status IS NULL	THEN NULL ELSE convert(bit, status & 0x01) END as is_clouddb_internal_query
	FROM sys.plan_persist_query_merged
	LEFT JOIN  sys.syspalvalues n ON n.class = 'QDPT' AND n.value = query_param_type
"
1583	Parse Tree	View	-614120937	32767	6	4	1	7	3	251	0	1	1024	0	0	0	0	0	202	"CREATE VIEW sys.dm_xe_session_events AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_SESSION_EVENTS,0) 
"
1584	Parse Tree	View	-934388215	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	356	"
-- add it
create view sys.pdw_nodes_column_store_row_groups as
select *, convert(int, null) pdw_node_id, convert(int, null) distribution_id from sys.column_store_row_groups
"
1585	Parse Tree	View	-818696768	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	272	"
-- add it
create view sys.dm_pdw_nodes_exec_cached_plans as
select *, convert(int, null) pdw_node_id from sys.dm_exec_cached_plans
"
1586	Parse Tree	View	-508495221	32767	6	4	1	22	14	251	0	1	1024	0	0	0	0	0	1816	"CREATE view sys.dm_repl_schemas
as
	SELECT 
		[artcache_schema_address]
		,[tabid]
		,[indexid]
		,[idSch]
		,[tabschema]
		,[ccTabschema]
		,[tabname]
		,[ccTabname]
		,[rowsetid_delete]
		,[rowsetid_insert]
		,[num_pk_cols]
		,[pcitee]
		,[re_numtextcols]
		,[re_schema_lsn_begin]
		,[re_schema_lsn_end]
		,[re_numcols]
		,[re_colid]
		,[re_awcName]
		,[re_ccName]
		,[re_colattr]
		,[re_maxlen]
		,[re_prec]
		,[re_scale]
		,[re_collatid]
		,[re_xvtype]
		,[re_offset]
		,[re_bitpos]
		,[re_fNullable]
		,[re_fAnsiTrim]
		,[re_computed]
		,[se_rowsetid]
		,[se_schema_lsn_begin]
		,[se_schema_lsn_end]
		,[se_numcols]
		,[se_colid]
		,[se_maxlen]
		,[se_prec]
		,[se_scale]
		,[se_collatid]
		,[se_xvtype]
		,[se_offset]
		,[se_bitpos]
		,[se_fNullable]
		,[se_fAnsiTrim]
		,[se_computed]
		,[se_nullBitInLeafRows]
	FROM OpenRowset(TABLE DM_REPL_SCHEMAS)
"
1594	Parse Tree	View	-480	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	352	"CREATE VIEW sys.parameter_type_usages AS
	SELECT id AS object_id,
		colid AS parameter_id,
		utype AS user_type_id
	FROM sys.syscolpars
	WHERE number = 1 AND utype > 256
"
1605	Parse Tree	View	-422	32767	6	4	1	10	8	187	0	1	1024	0	0	0	0	0	1228	"CREATE VIEW sys.sql_dependencies AS
	SELECT dp.class,
		i.name AS class_desc,
		dp.depid AS object_id,
		dp.depsubid AS column_id,
		dp.indepid AS referenced_major_id,
		dp.indepsubid AS referenced_minor_id,
		sysconv(bit, dp.status & 4) AS is_selected,		-- OBJDEP_READCS
		sysconv(bit, dp.status & 2) AS is_updated,		-- OBJDEP_RESULT
		sysconv(bit, dp.status & 1) AS is_select_all	-- OBJDEP_SELECT
	FROM sys.sysmultiobjrefs dp LEFT JOIN sys.syspalvalues i ON i.class = 'DPCL' AND i.value = dp.class
	WHERE dp.class <= 4	-- MRC_OLDDEPENDS,MRC_EXPRTOOBJ,MRC_EXPRTOTYPE,MRC_EXPRTOXMLNS,MRC_EXPRTOPRTFUNC
"
1607	Parse Tree	View	-1072372588	32767	6	3	1	23	15	251	0	1	1024	0	0	0	0	0	1936	"CREATE VIEW INFORMATION_SCHEMA.TABLE_PRIVILEGES
AS
SELECT	
	USER_NAME(p.grantor_principal_id)	AS GRANTOR,
	USER_NAME(p.grantee_principal_id)	AS GRANTEE,
	DB_NAME()						AS TABLE_CATALOG,
	SCHEMA_NAME(o.schema_id)			AS TABLE_SCHEMA,
	o.name							AS TABLE_NAME,
	convert(varchar(10), CASE p.type
		WHEN 'RF' THEN 'REFERENCES'
		WHEN 'SL' THEN 'SELECT'
		WHEN 'IN' THEN 'INSERT'
		WHEN 'DL' THEN 'DELETE'
		WHEN 'UP' THEN 'UPDATE'
		END)						AS PRIVILEGE_TYPE,
	convert(varchar(3), CASE p.state
		WHEN 'G' THEN 'NO'
		WHEN 'W' THEN 'YES'
		END)						AS IS_GRANTABLE
FROM
	sys.objects o,
	sys.database_permissions p
WHERE
	o.type IN ('U', 'V')
	AND p.class = 1
	AND p.major_id = o.object_id
	AND p.minor_id = 0	-- all columns
 	AND p.type IN ('RF','IN','SL','UP','DL')
 	AND p.state IN ('W','G')
	AND (p.grantee_principal_id = 0
		OR p.grantee_principal_id = DATABASE_PRINCIPAL_ID()
		OR p.grantor_principal_id = DATABASE_PRINCIPAL_ID())
"
1611	Parse Tree	View	-329906142	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	748	"CREATE VIEW sys.dm_tran_active_snapshot_database_transactions AS
	SELECT 
		transaction_id,
		transaction_sequence_num,
		commit_sequence_num,
		session_id,
		is_snapshot,
		first_snapshot_sequence_num,
		max_version_chain_traversed,
		average_version_chain_traversed,
		elapsed_time_seconds
	FROM OpenRowset(TABLE DM_TRAN_ACTIVE_SNAPSHOT_DATABASE_TRANSACTIONS)
"
1638	Parse Tree	View	-248	32767	6	4	1	13	11	251	0	1	1024	0	0	0	0	0	1390	"CREATE VIEW sys.server_event_session_actions AS
	SELECT 
		event_session_id = v.objid,
		event_id		 = v.subobjid,
		name			 = convert(sysname, v.value) collate catalog_default,
		package			 = convert(sysname, p.name) collate catalog_default,
		module			 = convert(sysname, m.name) collate catalog_default
	FROM master.sys.sysobjvalues v
	LEFT JOIN master.sys.sysqnames p ON p.nid =
		((((substring( v.imageval, 4, 1 ) * 256 ) +
			substring( v.imageval, 3, 1 ) * 256 ) +
			substring( v.imageval, 2, 1 ) * 256 ) +
			substring( v.imageval, 1, 1 ))
	LEFT JOIN master.sys.sysqnames m ON m.nid = p.qid
	WHERE v.valclass = 58			-- SVC_XE_SESSION_ACTION
	AND has_access ('ES', 0) = 1
"
1648	Parse Tree	View	-559	32767	6	4	1	25	21	251	0	1	1024	0	0	0	0	0	3136	"
CREATE VIEW sys.external_tables AS
	SELECT
		obj.name AS name,
		obj.object_id AS object_id,
		obj.principal_id AS principal_id,
		obj.schema_id AS schema_id,
		obj.parent_object_id AS parent_object_id,
		obj.type AS type,
		obj.type_desc AS type_desc,	
		obj.create_date AS create_date,
		obj.modify_date AS modify_date,
		obj.is_ms_shipped AS is_ms_shipped,	
		obj.is_published AS is_published,
		obj.is_schema_published AS is_schema_published,
		(SELECT TOP 1 column_id from sys.columns cols
			WHERE cols.object_id = et.object_id
			ORDER BY cols.column_id DESC) AS max_column_id_used,	
		obj.uses_ansi_nulls AS uses_ansi_nulls,
		et.data_source_id AS data_source_id,
		et.file_format_id AS file_format_id,
		et.location AS location,
		et.reject_type AS reject_type,
		et.reject_value AS reject_value,
		et.reject_sample_value AS reject_sample_value,
		CASE
			WHEN et.sharding_dist_type < 3 THEN et.sharding_dist_type
			ELSE NULL
		END AS distribution_type,
		CASE 
			WHEN et.sharding_dist_type = 0 THEN CONVERT(NVARCHAR(120), 'SHARDED')
			WHEN et.sharding_dist_type = 1 THEN CONVERT(NVARCHAR(120), 'REPLICATED')
			WHEN et.sharding_dist_type = 2 THEN CONVERT(NVARCHAR(120), 'ROUND_ROBIN')
			ELSE NULL
		END AS distribution_desc,
		CASE 
			WHEN et.sharding_col_id <> -1 THEN et.sharding_col_id
			ELSE NULL
		END AS sharding_col_id,
		et.source_schema_name as remote_schema_name,
		et.source_table_name as remote_object_name
	FROM sys.sysexttables et 
		INNER JOIN sys.objects$ obj on et.object_id = obj.object_id
"
1659	Parse Tree	View	-501	32767	6	4	1	9	9	251	0	1	1024	0	0	0	0	0	1052	"CREATE VIEW sys.database_audit_specifications AS
	SELECT
		asp.id AS database_specification_id,
		asp.name AS name,
		asp.created AS create_date,
		asp.modified AS modify_date,
		g.guid AS audit_guid,
		sysconv(bit, sysconv (int, asp.status) & 0x1) AS is_state_enabled
	FROM sys.sysclsobjs asp
	LEFT JOIN sys.sysguidrefs g ON g.class = 7 AND g.id = asp.id AND g.subid = 0  -- GRC_DBAUDITSPECGUID
	WHERE asp.class = 65 AND asp.type = 'DA' -- SOC_SECAUDITSPEC
		AND has_access('DA', 0) = 1 -- catalog security check
"
1660	Parse Tree	View	-744484871	32767	6	4	1	21	24	251	0	1	1024	0	0	0	0	0	5392	"CREATE VIEW sys.dm_hadr_availability_replica_states AS
	SELECT
		ars.replica_id,
		ars.group_id,
		ars.is_local,
		ars.role,
		ars.role_desc,
		ars.operational_state,
		ars.operational_state_desc,
		ars.connected_state,
		ars.connected_state_desc,
		recovery_health = CASE
			WHEN dbs.database_state_aggr IS NULL THEN NULL
			WHEN ars.configured_database_count > dbs.database_count THEN CAST (0 AS TINYINT)	-- ONLINE_IN_PROGRESS
			WHEN dbs.database_state_aggr = 0 THEN CAST (1 AS TINYINT)							-- ONLINE
			ELSE CAST (0 AS TINYINT) END,														-- ONLINE_IN_PROGRESS
		recovery_health_desc = CASE
			WHEN dbs.database_state_aggr IS NULL THEN CAST (NULL AS NVARCHAR(60))
			WHEN ars.configured_database_count > dbs.database_count THEN CAST ('ONLINE_IN_PROGRESS' AS NVARCHAR(60))
			WHEN dbs.database_state_aggr = 0 THEN CAST ('ONLINE' AS NVARCHAR(60))
			ELSE CAST ('ONLINE_IN_PROGRESS' AS NVARCHAR(60)) END,
		synchronization_health = CASE
			WHEN (war.availability_mode = 4 AND ars.connected_state = 1) THEN CAST (2 AS TINYINT) -- Configuration-only, always healthy when connected
			WHEN dbs.synchronization_health_aggr IS NULL THEN CAST (0 AS TINYINT)				-- NOT_HEALTHY
			WHEN ars.configured_database_count > dbs.database_count THEN CAST (0 AS TINYINT)	-- NOT_HEALTHY (one or more DBs not joined)
			ELSE CAST (dbs.synchronization_health_aggr AS TINYINT) END,
		synchronization_health_desc = CASE
			WHEN (war.availability_mode = 4 AND ars.connected_state = 1) THEN CAST ('HEALTHY' AS NVARCHAR(60))
			WHEN dbs.synchronization_health_aggr IS NULL THEN CAST ('NOT_HEALTHY' AS NVARCHAR(60))
			WHEN ars.configured_database_count > dbs.database_count THEN CAST ('NOT_HEALTHY' AS NVARCHAR(60))
			WHEN dbs.synchronization_health_aggr = 2 THEN CAST ('HEALTHY' AS NVARCHAR(60))
			WHEN dbs.synchronization_health_aggr = 1 THEN CAST ('PARTIALLY_HEALTHY' AS NVARCHAR(60))
			ELSE CAST ('NOT_HEALTHY' AS NVARCHAR(60)) END,
		ars.last_connect_error_number,
		ars.last_connect_error_description,
		ars.last_connect_error_timestamp,
		ars.write_lease_remaining_ticks
	FROM 
		sys.dm_hadr_internal_availability_replica_states ars
		LEFT OUTER JOIN
		(
			SELECT 
				replica_id,
				database_count = COUNT (*),
				synchronization_health_aggr = MIN (synchronization_health),
				database_state_aggr = MAX (database_state) 
			FROM 
				sys.dm_hadr_database_replica_states 
			GROUP BY replica_id
		)
		AS dbs
		ON (ars.real_replica_id = dbs.replica_id)
		LEFT OUTER JOIN
		(
			SELECT
				ag_replica_id,
				availability_mode
			FROM
				sys.dm_hadr_internal_wsfc_ag_replicas
		)
		AS war
		ON (ars.real_replica_id = war.ag_replica_id)
"
1665	Parse Tree	View	-649563640	32767	6	4	1	20	12	251	0	1	1024	0	0	0	0	0	248	"
-- add it
create view sys.dm_pdw_nodes_os_sys_info as
select *, convert(int, null) pdw_node_id from sys.dm_os_sys_info
"
1670	Parse Tree	View	-443	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	648	"CREATE VIEW sys.service_contract_message_usages AS
	SELECT service_contract_id = depid,
		message_type_id = indepid,
		is_sent_by_initiator = sysconv(bit, status & 1),
		is_sent_by_target = sysconv(bit, status & 2)
	FROM sys.sysmultiobjrefs
	WHERE class = 20 AND depsubid = 0 AND indepsubid = 0 -- MRC_SVCCONTRACTMSG
"
1681	Parse Tree	View	-385	32767	6	4	1	64	9	187	0	1	1024	0	0	0	0	0	492	"CREATE VIEW sys.objects AS
	SELECT name, 
		object_id,
		principal_id,
		schema_id,
		parent_object_id,
		type, 
		type_desc, 
		create_date, 
		modify_date,
		is_ms_shipped,
		is_published,
		is_schema_published
	FROM sys.objects$
"
1690	Parse Tree	View	-104729818	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	154	"CREATE VIEW sys.dm_os_tasks AS
	SELECT *
	FROM OpenRowSet(TABLE SYSTASKS)
"
1694	Parse Tree	View	-774096994	32767	6	4	1	27	17	251	0	1	1024	0	0	0	0	0	4342	"CREATE VIEW sys.availability_replicas AS
	SELECT
		replica_id = CASE WHEN mr.replica_id is null THEN wr.ag_replica_id -- show remote replica
			ELSE mr.replica_id END,
		group_id = CASE WHEN mr.replica_id is null THEN wr.ag_id -- show remote group id
			ELSE mr.group_id END,
		replica_metadata_id = mr.internal_group_id,
		replica_server_name = CASE WHEN mr.replica_id is not null and wr.ag_replica_name is null THEN (select @@servername)
			ELSE wr.ag_replica_name END,
		owner_sid = mr.owner_sid,
		endpoint_url = wr.endpoint_url,
		availability_mode = wr.availability_mode,
		availability_mode_desc = CASE
			WHEN (wr.availability_mode = 1) THEN CAST('SYNCHRONOUS_COMMIT' AS nvarchar(60))
			WHEN (wr.availability_mode = 0) THEN CAST('ASYNCHRONOUS_COMMIT' AS nvarchar(60))
			WHEN (wr.availability_mode = 4) THEN CAST('CONFIGURATION_ONLY' AS nvarchar(60))
			ELSE CAST (NULL as nvarchar(60))
			END,
		failover_mode = wr.failover_mode,
		failover_mode_desc = CASE
			WHEN (wr.failover_mode = 0) THEN CAST('AUTOMATIC' AS nvarchar(60))
			WHEN (wr.failover_mode = 1) THEN CAST('MANUAL' AS nvarchar(60))
			WHEN (wr.failover_mode = 2) THEN CAST('EXTERNAL' AS nvarchar(60))
			ELSE CAST (NULL as nvarchar(60))
			END,
		session_timeout = wr.session_timeout,
		primary_role_allow_connections = wr.primary_role_allow_connections,
		primary_role_allow_connections_desc = wr.primary_role_allow_connections_desc,
		secondary_role_allow_connections = wr.secondary_role_allow_connections,
		secondary_role_allow_connections_desc = wr.secondary_role_allow_connections_desc,
		create_date = mr.create_date,
		modify_date = mr.modify_date,
		backup_priority = wr.backup_priority,
		read_only_routing_url = wr.read_only_routing_url,
		seeding_mode = wr.seeding_mode,
		seeding_mode_desc = CASE
			WHEN (wr.seeding_mode = 1) THEN CAST('MANUAL' AS nvarchar(60))
			WHEN (wr.seeding_mode = 0) THEN CAST('AUTOMATIC' AS nvarchar(60))
			ELSE CAST (NULL as nvarchar(60))
			END
	FROM sys.availability_replicas_internal AS mr
	FULL JOIN sys.dm_hadr_internal_wsfc_ag_replicas AS wr
		ON mr.group_id = wr.ag_id and mr.replica_id = wr.ag_replica_id
"
1703	Parse Tree	View	-269	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	378	"CREATE VIEW sys.resource_governor_external_resource_pool_affinity
AS
	SELECT external_pool_id = pool_id, processor_group, cpu_mask
	FROM OpenRowSet(TABLE SYS_RG_EXTERNAL_POOL_AFFINITY)
"
1703	Parse Tree	View	-637153227	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	178	"CREATE VIEW sys.dm_os_memory_clerks AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMCLERKS)
"
1709	Parse Tree	View	-237633642	32767	6	4	1	8	19	251	0	1	1024	0	0	0	0	0	1790	"CREATE VIEW sys.dm_resource_governor_workload_groups AS
	SELECT
		group_id,
		name,
		pool_id,
		external_pool_id,
		statistics_start_time,
		total_request_count,
		total_queued_request_count,
		active_request_count,
		queued_request_count,
		total_cpu_limit_violation_count,
		total_cpu_usage_ms,
		max_request_cpu_time_ms,
		blocked_task_count,
		total_lock_wait_count,
		total_lock_wait_time_ms,
		total_query_optimization_count,
		total_suboptimal_plan_generation_count,
		total_reduced_memgrant_count,
		max_request_grant_memory_kb,
		active_parallel_thread_count,
		importance,
		isnull(cast(request_max_memory_grant_percent as int), 0) request_max_memory_grant_percent,
		request_max_cpu_time_sec,
		request_memory_grant_timeout_sec,
		group_max_requests,
		max_dop,
		effective_max_dop,
		total_cpu_usage_preemptive_ms
	FROM OpenRowSet(TABLE DM_RG_GROUPS)
"
1711	Parse Tree	View	-917213099	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	198	"CREATE VIEW sys.dm_exec_query_optimizer_info AS
	SELECT *
	FROM OpenRowSet(TABLE OPTIMIZERINFO)
"
1713	Parse Tree	View	-580	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	308	"CREATE VIEW sys.time_zone_info AS
	SELECT 	name,
			current_utc_offset,
			is_currently_dst
	FROM OPENROWSET(TABLE TIME_ZONE_INFO, SYSUTCDATETIME())
"
1714	Parse Tree	View	-211	32767	6	4	1	3	6	251	0	1	1024	0	0	0	0	0	620	"CREATE VIEW sys.sysremotelogins AS
	SELECT
		remoteserverid = convert(smallint, r.server_id),
		remoteusername = r.remote_name,
		status = convert(smallint, 0),
		p.sid,
		changedate = r.modify_date
	FROM sys.remote_logins r
	LEFT JOIN sys.server_principals p ON r.local_principal_id = p.principal_id
"
1724	Parse Tree	View	-986106448	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	608	"
-- add it
create view sys.dm_pdw_component_health_status as
select
	pdw_node_id,
	component_id,
	property_id,
	component_instance_id	collate database_default component_instance_id,
	property_value	collate database_default property_value,
	update_time
from sys._dm_pdw_component_health_status
"
1731	Parse Tree	View	-661340934	32767	6	4	1	11	3	251	0	1	1024	0	0	0	0	0	216	"CREATE view sys.dm_hadr_cluster_members
as
	SELECT 
	*
	FROM OpenRowset(TABLE DM_HADR_CLUSTER_MEMBERS)
"
1735	Parse Tree	View	-464	32767	6	4	1	14	28	251	0	1	1024	0	0	0	0	0	3172	"CREATE VIEW sys.symmetric_keys AS
	SELECT s.name AS name,
		r.indepid AS principal_id,
		s.id AS symmetric_key_id,
		s.intprop AS key_length,
		s.type AS key_algorithm,
		case when vpt.value = 6 then  -- x_emd_EKMProvider = 6
		    convert(nvarchar(60),symkeyproperty(s.id, 'algorithm_desc'))
		    else alg.name end AS algorithm_desc,
		s.created AS create_date,
		s.modified AS modify_date,
		g.guid AS key_guid,
		vph.value AS key_thumbprint,
		n.name as provider_type,
		convert(uniqueidentifier, vpg.value) AS cryptographic_provider_guid,
		vpa.value AS cryptographic_provider_algid
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 47 AND r.depsubid = 0
	LEFT JOIN sys.sysguidrefs g ON g.id = s.id AND g.class = 2 AND g.subid = 0
	LEFT JOIN sys.syspalnames alg ON alg.class = 'ENAL' AND alg.value = s.type
	LEFT JOIN sys.sysobjvalues vpt ON vpt.valclass = 35 AND vpt.objid = s.id AND vpt.subobjid = 0 AND vpt.valnum = 1	-- SVC_OKEYPROVPROPS/PROV_TYPE_PROP
	LEFT JOIN sys.sysobjvalues vpg ON vpg.valclass = 35 AND vpg.objid = s.id AND vpg.subobjid = 0 AND vpg.valnum = 2	-- SVC_OKEYPROVPROPS/PROV_GUID_PROP
	LEFT JOIN sys.sysobjvalues vpa ON vpa.valclass = 35 AND vpa.objid = s.id AND vpa.subobjid = 0 AND vpa.valnum = 3	-- SVC_OKEYPROVPROPS/PROV_ALGID_PROP
	LEFT JOIN sys.sysobjvalues vph ON vph.valclass = 35 AND vph.objid = s.id AND vph.valnum = 4	-- SVC_OKEYPROVPROPS/PROV_THUMB_PROP
	LEFT JOIN sys.syspalvalues n ON n.class = 'CPKP' AND n.value = vpt.value
	WHERE s.class = 56
		AND has_access('OK', s.id) = 1
"
1742	Parse Tree	View	-206346157	32767	6	4	1	7	7	251	0	1	1024	0	0	0	0	0	366	" 
-- add it
create view sys.dm_pdw_nodes_db_column_store_row_group_physical_stats as
select *, convert(int, null) pdw_node_id from sys.dm_db_column_store_row_group_physical_stats
"
1746	Parse Tree	View	-406	32767	6	4	1	16	12	187	0	1	1024	0	0	0	0	0	836	"
CREATE VIEW sys.key_constraints AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		r.indepid AS unique_index_id,
		o.is_system_named,
		1 AS is_enforced
	FROM sys.objects$ o
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.object_id
	WHERE o.type IN ('PK', 'UQ')
"
1747	Parse Tree	View	-1035533931	32767	6	4	1	18	5	251	0	1	1024	0	0	0	0	0	176	"CREATE VIEW sys.dm_os_loaded_modules AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMODULES)
"
1752	Parse Tree	View	-830015131	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	236	"
-- add it
create view sys.dm_pdw_nodes_os_hosts as
select *, convert(int, null) pdw_node_id from sys.dm_os_hosts
"
1756	Parse Tree	View	-731037170	32767	6	4	1	3	15	251	0	1	1024	0	0	0	0	0	666	" 
-- add it
create view sys.dm_pdw_nodes_io_virtual_file_stats as
select dbs.name as database_name, iostats.*, convert(int, null) pdw_node_id
from sys.dm_io_virtual_file_stats(null, null) as iostats join sys.databases as dbs
on (iostats.database_id = dbs.database_id)
where dbs.name like 'Distribution%' or dbs.name ='tempdb'
"
1756	Parse Tree	View	-720428490	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	634	"CREATE VIEW sys.dm_external_script_execution_stats AS
 	SELECT 
		[language] = 
			CAST (CASE script_type
				WHEN 0 THEN 'Test'
				WHEN 1 THEN 'R'
				WHEN 2 THEN 'Python'
				ELSE 'Not Supported'
			END as nvarchar(128)),
		counter_name,
		counter_value
	FROM OpenRowSet(TABLE DM_EXTSCRIPT_EXEC_STATS)
"
1779	Parse Tree	View	-232	32767	6	4	1	17	10	251	0	1	1024	0	0	0	0	0	1190	"CREATE VIEW sys.endpoint_webmethods AS
	SELECT
		endpoint_id = m.id,
		namespace = m.nmspace,
		method_alias = m.alias,
		object_name = m.objname,
		result_schema = convert(tinyint, m.status & 7),			-- METHSTAT_SCHEMAMASK
		result_schema_desc = s.name,
		result_format = convert(tinyint, (m.status/8) & 7),		-- METHSTAT_FMTMASK
		result_format_desc = f.name
	FROM master.sys.syswebmethods m
	LEFT JOIN sys.syspalvalues s ON s.class = 'SPRS' AND s.value = m.status & 7
	LEFT JOIN sys.syspalvalues f ON f.class = 'SPRF' AND f.value = (m.status/8)&7
	WHERE has_access('HE', m.id) = 1
"
1785	Parse Tree	View	-595552097	32767	6	4	1	4	2	251	0	1	1024	0	0	0	0	0	178	"CREATE VIEW sys.securable_classes AS
	SELECT * FROM OpenRowset(TABLE SECURABLECLASSES)
"
1789	Parse Tree	View	-543	32767	6	4	1	2	19	187	0	1	1024	0	0	0	0	0	4412	"CREATE VIEW sys.plan_persist_plan_merged AS
	SELECT 
		P.plan_id as plan_id,
		P.query_id as query_id,
		P.plan_group_id as plan_group_id,
		P.engine_version as engine_version,
		P.query_plan_hash as query_plan_hash,
		P.query_plan as query_plan,
		P.is_online_index_plan as is_online_index_plan,
		P.is_trivial_plan as is_trivial_plan,
		P.is_parallel_plan as is_parallel_plan,
		P.is_forced_plan as is_forced_plan,
		CASE WHEN P.is_forced_plan = 1 AND convert(bit, P.plan_flags & 0x02) = 0 THEN 1
			 WHEN P.is_forced_plan = 1 AND convert(bit, P.plan_flags & 0x02) = 1 THEN 2
			 ELSE 0
		END as plan_forcing_type,
		ISNULL(convert(bit, P.plan_flags & 0x01), convert(bit, 0)) as is_natively_compiled,
		P.force_failure_count as force_failure_count,
		P.last_force_failure_reason as last_force_failure_reason,
		IIF(PM.count_compiles is NULL OR (PM.last_compile_start_time is not NULL and PM.last_compile_start_time = P.last_compile_start_time), P.count_compiles, P.count_compiles + PM.count_compiles) as count_compiles,
		P.initial_compile_start_time as initial_compile_start_time,
		IIF(PM.last_compile_start_time IS NULL OR PM.last_compile_start_time <= P.last_compile_start_time, P.last_compile_start_time, PM.last_compile_start_time) as last_compile_start_time,
		IIF(PM.last_execution_time is NULL OR PM.last_execution_time <= P.last_execution_time, P.last_execution_time, PM.last_execution_time) as last_execution_time,
		IIF(PM.total_compile_duration is not NULL AND (PM.last_compile_start_time IS NULL OR PM.last_compile_start_time <= P.last_compile_start_time), P.total_compile_duration + PM.total_compile_duration, P.total_compile_duration) as total_compile_duration,
		IIF(PM.last_compile_duration is not null AND (PM.last_compile_start_time IS NULL OR PM.last_compile_start_time <= P.last_compile_start_time), PM.last_compile_duration, P.last_compile_duration) as last_compile_duration,
		P.compatibility_level as compatibility_level
	FROM
		sys.plan_persist_plan P WITH (NOLOCK) -- NOTE - in order to prevent potential deadlock between QDS_STATEMENT_STABILITY LOCK and index locks
	LEFT OUTER JOIN sys.plan_persist_plan_in_memory PM ON
		P.plan_id = PM.plan_id
"
1791	Parse Tree	View	-107098490	32767	6	4	1	20	6	251	0	1	1024	0	0	0	0	0	1302	"CREATE VIEW sys.availability_group_listener_ip_addresses AS
	SELECT
		listener_id = CAST(agl.listener_id AS nvarchar(36)),
		ip_address = CAST(agl.ip_address as nvarchar(48)),
		ip_subnet_mask = CAST(agl.ip_subnet_mask as nvarchar(15)),
		is_dhcp = agl.is_dhcp,
		network_subnet_ip = CAST(agl.network_subnet_ip as nvarchar(48)),
		network_subnet_prefix_length = CAST(agl.network_subnet_prefix_length as int),
		network_subnet_ipv4_mask = CAST(agl.network_subnet_ipv4_mask as nvarchar(48)),
		state = CAST(agl.state AS tinyint),
		state_desc = CAST(agl.state_desc AS nvarchar(60))
	FROM
		sys.dm_hadr_internal_ag_listener_addresses AS agl
"
1800	Parse Tree	View	-575104509	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	252	"CREATE VIEW sys.dm_exec_background_job_queue_stats AS
	SELECT *
	FROM OpenRowSet(TABLE DM_EXEC_BACKGROUND_JOB_QUEUE_STATS)
"
1800	Parse Tree	View	-485	32767	6	4	1	20	10	251	0	1	1024	0	0	0	0	0	1822	"CREATE VIEW sys.plan_guides AS
	SELECT 
		plan_guide_id 	= g.id,
		name 		= g.name, 
		create_date 	= g.created,
		modify_date 	= g.modified,
		is_disabled 	= sysconv(bit, g.status & 1),
		query_text 	= convert(nvarchar(max), p.stmt),
		scope_type 	= g.scopetype,
		scope_type_desc 	= convert(nvarchar(60), case g.scopetype 
								when  1 then 'OBJECT' 
								when  2 then 'SQL'
								else 'TEMPLATE' end),
		scope_object_id = sysconv(int, case g.scopetype when 1 then g.scopeid end), -- object-id is non-NULL only for module-scoped guide
		scope_batch 	= convert(nvarchar(max), p.batch), -- for single-stmt batch, batch_text is always NULL
		parameters 		= convert(nvarchar(max), p.params),
		hints 			= convert(nvarchar(max), p.hints)
	FROM sys.syssqlguides g CROSS APPLY OpenRowset(TABLE PLANGUIDES, g.id, g.scopeid, g.scopetype) p	
	WHERE g.scopeid <> 0 -- filter-out batch entries
"
1810	Parse Tree	View	-672410142	32767	6	4	1	20	13	251	0	1	1024	0	0	0	0	0	288	"
-- add it
create view sys.pdw_nodes_tables as
select *, convert(int, null) pdw_node_id, convert(int, null) distribution_id from sys.tables
"
1824	Parse Tree	View	-875242884	32767	6	4	1	14	5	251	0	1	1024	0	0	0	0	0	276	"
-- add it
create view sys.dm_pdw_nodes_os_child_instances as
select *, convert(int, null) pdw_node_id from sys.dm_os_child_instances
"
1831	Parse Tree	View	-1009023505	32767	6	4	1	6	8	251	0	1	1024	0	0	0	0	0	174	"CREATE VIEW sys.dm_os_schedulers AS
	SELECT *
	FROM OpenRowSet(TABLE SYSSCHEDULERS)
"
1833	Compiled Plan	Adhoc	427716520	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_db_rda_schema_update_status t
1842	Parse Tree	View	-900213070	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	158	"CREATE view sys.dm_fts_fdhosts
AS
	SELECT * FROM OpenRowset(TABLE FTFDHOST)
"
1844	Parse Tree	View	-253	32767	6	4	1	2	9	251	0	1	1024	0	0	0	0	0	1514	"CREATE VIEW sys.resource_governor_configuration
AS
    SELECT
        classifier_function_id          = sor.indepid,
        is_enabled                      = sysconv(bit, sor.status & 1), -- 0-Disabled / 1-Enabled
        max_outstanding_io_per_volume   = isnull(convert(int, ov.value), 0)
        FROM
        master.sys.syssingleobjrefs sor LEFT JOIN
        master.sys.sysobjvalues ov ON
        (
            ov.objid = 0 AND
            ov.valclass = 111 AND -- SVC_RG_CONFIGURATION
            ov.subobjid = 0 AND
            ov.valnum = 0
        )
    WHERE
        sor.class = 12 AND -- SRC_RG_CONFIGURATION
        sor.depsubid = 0 AND
        sor.depid = 0 AND
        sor.indepsubid = 0 AND
        has_access('RG', 0) = 1
"
1845	Parse Tree	View	-471580126	32767	6	4	1	11	3	251	0	1	1024	0	0	0	0	0	214	"CREATE view sys.dm_hadr_cluster_networks
as
	SELECT *
	FROM OpenRowset(TABLE DM_HADR_CLUSTER_NETWORKS)
"
1854	Parse Tree	View	-564	32767	6	4	1	7	8	251	0	1	1024	0	0	0	0	0	1062	"CREATE VIEW sys.column_encryption_key_values AS
	SELECT
		sc.id as column_encryption_key_id, 
		smov1.indepid as column_master_key_id,
		convert(varbinary(8000), smov1.imageval) as encrypted_value,
		convert(sysname, smov1.value) as encryption_algorithm_name
	FROM sys.sysclsobjs sc
	INNER JOIN sys.sysmultiobjvalues smov1 ON smov1.valclass = 1 /*SMVC_CEKDETAILS*/ and smov1.depid = sc.id and smov1.valnum = 0 -- ENCRYPTED_LOB_AND_ALGORITH
	WHERE sc.class = 102 -- SOC_COLENCRYPTIONKEY
	AND has_access('CK', DB_ID()) = 1
"
1863	Parse Tree	View	-625907287	32767	6	4	1	3	8	251	0	1	1024	0	0	0	0	0	822	"
-- add it
create view sys.dm_pdw_exec_query_profiles as
select
   	convert(int, null) pdw_node_id,
	session_id,
	request_id,
	sql_handle,
  	plan_handle,
	physical_operator_name collate database_default physical_operator_name,
   	node_id as sql_plan_node_id,
	thread_id,
	row_count,
	estimate_row_count,
	elapsed_time_ms,
	read_ahead_count,
	write_page_count
from sys.dm_exec_query_profiles
"
1876	Parse Tree	View	-448	32767	6	4	1	16	23	251	0	1	1024	0	0	0	0	0	4114	"CREATE VIEW sys.database_files AS
	SELECT
		file_id 				= f.fileid,
		file_guid 				= f.fileguid,
		type					= f.filetype,
		type_desc			= ft.name,
		data_space_id 		= f.grpid,
		name 				= f.lname,
		physical_name 		= trim_path(f.pname),
		state				= convert(tinyint, case f.filestate		-- Map enum EMDFileState to AvailablityStates
								when 0 then 0 when 10 then 0	-- ONLINE
								when 4 then 7	-- DEFUNCT
								when 5 then 3 when 9 then 3	-- RECOVERY_PENDING
								when 7 then 1 when 8 then 1 when 11 then 1	-- RESTORING
								when 12 then 4	-- SUSPECT
								else 6 end),	-- OFFLINE
		state_desc			= st.name,
		size 					= isnull(FilePropertyById(f.fileid, 'size'), size),
		max_size 			= f.maxsize,
		f.growth,
		is_media_read_only 	= sysconv(bit, f.status & 8),		-- FIL_READONLY_MEDIA
		is_read_only 			= sysconv(bit, f.status & 16),	-- FIL_READONLY
		is_sparse 			= sysconv(bit, f.status & 256),	-- FIL_SPARSE_FILE
		is_percent_growth 	= sysconv(bit, f.status & 32),	-- FIL_PERCENT_GROWTH
		is_name_reserved		= sysconv(bit, case f.filestate when 3 then 1 else 0 end), -- x_efs_DroppedReusePending
		is_persistent_log_buffer = sysconv(bit, f.status & 2048), -- FIL_IS_PMM_METADATA
		create_lsn			= GetNumericLsn(f.createlsn),
		drop_lsn				= GetNumericLsn(f.droplsn),
		read_only_lsn			= GetNumericLsn(f.readonlylsn),
		read_write_lsn		= GetNumericLsn(f.readwritelsn),
		differential_base_lsn	= GetNumericLsn(f.diffbaselsn),
		differential_base_guid	= f.diffbaseguid,
		differential_base_time	= nullif(f.diffbasetime, 0),
		redo_start_lsn			= GetNumericLsn(f.redostartlsn),
		redo_start_fork_guid	= f.redostartforkguid,
		redo_target_lsn		= GetNumericLsn(f.redotargetlsn),
		redo_target_fork_guid	= f.forkguid,
		backup_lsn			= GetNumericLsn(f.backuplsn)
	FROM sys.sysprufiles f
	LEFT JOIN sys.syspalvalues st ON st.class = 'DBFS' AND st.value = f.filestate
	LEFT JOIN sys.syspalvalues ft ON ft.class = 'DBFT' AND ft.value = f.filetype
	WHERE filestate NOT IN (1, 2)	-- x_efs_Dummy, x_efs_Dropped
"
1880	Parse Tree	View	-198963827	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_exec_query_transformation_stats AS
	SELECT *
	FROM OpenRowSet(TABLE SYSRULESTATS)
"
1887	Parse Tree	View	-390	32767	6	4	1	9	9	251	0	1	1024	0	0	0	0	0	1104	"CREATE VIEW sys.system_views AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc, create_date, modify_date,
		is_ms_shipped, is_published, is_schema_published,
		sysconv(bit, 0) AS is_replicated,
		sysconv(bit, 0) AS has_replication_filter,
		sysconv(bit, 0) AS has_opaque_metadata,
		sysconv(bit, 0) AS has_unchecked_assembly_data,
		sysconv(bit, 0) AS with_check_option,
		sysconv(bit, 0) as is_date_correlation_view,
		sysconv(bit, 0) as is_tracked_by_cdc
	FROM sys.system_objects
	WHERE type = 'V'
"
1904	Parse Tree	View	-824889540	32767	6	4	1	15	6	251	0	1	1024	0	0	0	0	0	814	"
-- add it
create view sys.dm_pdw_query_stats_xe as
select
	event	collate database_default event,
	event_id	collate database_default event_id,
	create_time,
	session_id,
	cpu,
	reads,
	writes,
	sql_text	collate database_default sql_text,
	client_app_name	collate database_default client_app_name,
	tsql_stack	collate database_default tsql_stack,
	pdw_node_id
from sys._dm_pdw_query_stats_xe
"
1907	Parse Tree	View	-15626663	32767	6	4	1	22	4	251	0	1	1024	0	0	0	0	0	198	"CREATE VIEW sys.dm_xe_object_columns AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_OBJECT_COLUMNS) 
"
1907	Parse Tree	View	-618821265	32767	6	4	1	39	10	251	0	1	1024	0	0	0	0	0	1476	"CREATE view sys.dm_repl_articles
as
	SELECT 
		[artcache_db_address]
		,[artcache_table_address]
		,[artcache_schema_address]
		,[artcache_article_address]
		,[artid]
		,[artfilter]
		,[artobjid]
		,[artpubid]
		,[artstatus]
		,[arttype]
		,[wszArtdesttable]
		,[wszArtdesttableowner]
		,[wszArtinscmd]
		,[cmdTypeIns]
		,[wszArtdelcmd]
		,[cmdTypeDel]
		,[wszArtupdcmd]
		,[cmdTypeUpd]
		,[wszArtpartialupdcmd]
		,[cmdTypePartialUpd]
		,[numcol]
		,[artcmdtype]
		,[artgeninscmd]
		,[artgendelcmd]
		,[artgenupdcmd]
		,[artpartialupdcmd]
		,[artupdtxtcmd]
		,[artgenins2cmd]
		,[artgendel2cmd]
		,[fInReconcile]
		,[fPubAllowUpdate]
		,[intPublicationOptions]
	FROM OpenRowset(TABLE DM_REPL_ARTICLES)
"
1908	Parse Tree	View	-1063468038	32767	6	4	1	6	10	251	0	1	1024	0	0	0	0	0	1916	"
-- add it using explicit column names to avoid matrix-specific non-golden-bits columns.
create view sys.dm_pdw_nodes_resource_governor_workload_groups as
select
[group_id]
,[name]
,[pool_id]
,[statistics_start_time]
,[total_request_count]
,[total_queued_request_count]
,[active_request_count]
,[queued_request_count]
,[total_cpu_limit_violation_count]
,[total_cpu_usage_ms]
,[max_request_cpu_time_ms]
,[blocked_task_count]
,[total_lock_wait_count]
,[total_lock_wait_time_ms]
,[total_query_optimization_count]
,[total_suboptimal_plan_generation_count]
,[total_reduced_memgrant_count]
,[max_request_grant_memory_kb]
,[active_parallel_thread_count]
,[importance]
,[request_max_memory_grant_percent]
,[request_max_cpu_time_sec]
,[request_memory_grant_timeout_sec]
,[group_max_requests]
,[max_dop]
,[effective_max_dop]
,[total_cpu_usage_preemptive_ms]
,convert(int, null) pdw_node_id from sys.dm_resource_governor_workload_groups
"
1909	Compiled Plan	Adhoc	340190177	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.availability_databases_cluster t
1911	Parse Tree	View	-689794237	32767	6	4	1	8	4	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_xe_session_targets AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_SESSION_TARGETS, 0) 
"
1920	Parse Tree	View	-216	32767	6	4	1	15	27	251	0	1	1024	0	0	0	0	0	4480	" CREATE VIEW sys.master_files AS
	SELECT
		database_id 	= f.dbid,
		file_id 		= f.fileid,
		file_guid 		= f.fileguid,
		type			= f.filetype,
		type_desc		= ft.name,
		data_space_id 	= f.grpid,
		name 			= f.lname,
		physical_name 	= f.pname,
		state			= convert(tinyint, case f.filestate		-- Map enum EMDFileState to AvailablityStates
								when 0 then 0 when 10 then 0	-- ONLINE
								when 4 then 7	-- DEFUNCT
								when 5 then 3 when 9 then 3	-- RECOVERY_PENDING
								when 7 then 1 when 8 then 1 when 11 then 1	-- RESTORING
								when 12 then 4	-- SUSPECT
								else 6 end),	-- OFFLINE
		state_desc		= st.name,
		f.size,
		max_size 			= f.maxsize,
		f.growth,
		is_media_read_only 	= sysconv(bit, f.status & 8),		-- FIL_READONLY_MEDIA
		is_read_only 			= sysconv(bit, f.status & 16),	-- FIL_READONLY
		is_sparse 			= sysconv(bit, f.status & 256),	-- FIL_SPARSE_FILE
		is_percent_growth 	= sysconv(bit, f.status & 32),	-- FIL_PERCENT_GROWTH
		is_name_reserved		= sysconv(bit, case f.filestate when 3 then 1 else 0 end), -- x_efs_DroppedReusePending
		is_persistent_log_buffer = sysconv(bit, f.status & 2048), -- FIL_IS_PMM_METADATA
		create_lsn			= GetNumericLsn(f.createlsn),
		drop_lsn				= GetNumericLsn(f.droplsn),
		read_only_lsn			= GetNumericLsn(f.readonlylsn),
		read_write_lsn		= GetNumericLsn(f.readwritelsn),
		differential_base_lsn	= GetNumericLsn(f.diffbaselsn),
		differential_base_guid	= f.diffbaseguid,
		differential_base_time	= nullif(f.diffbasetime, 0),
		redo_start_lsn			= GetNumericLsn(f.redostartlsn),
		redo_start_fork_guid	= f.redostartforkguid,
		redo_target_lsn		= GetNumericLsn(f.redotargetlsn),
		redo_target_fork_guid	= f.forkguid,
		backup_lsn			= GetNumericLsn(f.backuplsn),
		credential_id		= cr.credential_id
	FROM sys.sysbrickfiles f
	LEFT JOIN sys.syspalvalues st ON st.class = 'DBFS' AND st.value = f.filestate
	LEFT JOIN sys.syspalvalues ft ON ft.class = 'DBFT' AND ft.value = f.filetype
	LEFT JOIN sys.credentials cr ON f.pname LIKE cr.name + N'%' COLLATE database_default
	WHERE f.dbid < 0x7fff -- consistent with sys.databases
		AND f.pruid = 0
		AND f.filestate NOT IN (1, 2)	-- x_efs_Dummy, x_efs_Dropped
		AND has_access('MF', 1) = 1
"
1922	Parse Tree	View	-1013821813	32767	6	3	1	35	20	251	0	1	1024	0	0	0	0	0	3532	"CREATE VIEW INFORMATION_SCHEMA.DOMAINS
AS
SELECT
	DB_NAME()					AS DOMAIN_CATALOG,
	SCHEMA_NAME(schema_id)		AS DOMAIN_SCHEMA,
	name						AS DOMAIN_NAME,
	TYPE_NAME(system_type_id) 	AS DATA_TYPE,
	convert(int, TypePropertyEx(user_type_id, 'charmaxlen'))	AS CHARACTER_MAXIMUM_LENGTH,
	convert(int, TypePropertyEx(user_type_id, 'octetmaxlen'))	AS CHARACTER_OCTET_LENGTH,
	convert(sysname, null)			AS COLLATION_CATALOG,
	convert(sysname, null) collate catalog_default		AS COLLATION_SCHEMA,
	collation_name				AS COLLATION_NAME,
	convert(sysname, null)			AS CHARACTER_SET_CATALOG,
	convert(sysname, null) collate catalog_default		AS CHARACTER_SET_SCHEMA,
	convert(sysname, CASE
		WHEN system_type_id IN (35, 167, 175) THEN SERVERPROPERTY('sqlcharsetname') -- char/varchar/text
		WHEN system_type_id IN (99, 231, 239) THEN N'UNICODE' END) AS CHARACTER_SET_NAME,		-- nchar/nvarchar/ntext
	convert(tinyint, CASE -- int/decimal/numeric/real/float/money
		WHEN system_type_id IN (48, 52, 56, 59, 60, 62, 106, 108, 122, 127) THEN precision
		END)									AS NUMERIC_PRECISION,
	convert(smallint, CASE	-- int/money/decimal/numeric
		WHEN system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
		WHEN system_type_id IN (59, 62) THEN 2 END)	AS NUMERIC_PRECISION_RADIX,
	convert(int, CASE	-- datetime/smalldatetime
		WHEN system_type_id IN (40, 41, 42, 43, 58, 61) THEN NULL
		ELSE ODBCSCALE(system_type_id, scale) END)	AS NUMERIC_SCALE,
	convert(smallint, CASE -- datetime/smalldatetime
		WHEN system_type_id IN (40, 41, 42, 43, 58, 61) THEN  ODBCSCALE(system_type_id, scale) END)	AS DATETIME_PRECISION,
	convert(nvarchar(4000),
		OBJECT_DEFINITION(default_object_id))			AS DOMAIN_DEFAULT
FROM
	sys.types
WHERE
	user_type_id > 256	-- UDT
"
1940	Parse Tree	View	-330796626	32767	6	4	1	6	6	251	0	1	1024	0	0	0	0	0	668	"CREATE VIEW sys.dm_os_buffer_descriptors AS
	SELECT 
		database_id,
		file_id,
		page_id,
		page_level,
		allocation_unit_id,
		page_type,
		row_count,
		free_space_in_bytes,
		is_modified,
		numa_node,
		read_microsec,
		is_in_bpool_extension,
		error_code,
		op_history
	FROM OpenRowset(TABLE SYSBUFFERDESCRIPTORS)
"
1941	Parse Tree	View	-469	32767	6	4	1	32	31	251	0	1	1024	0	0	0	0	0	3888	"CREATE VIEW sys.asymmetric_keys AS
	SELECT a.name AS name,
		r.indepid AS principal_id,
		a.id AS asymmetric_key_id,
		a.encrtype AS pvt_key_encryption_type,
		ce.name AS pvt_key_encryption_type_desc,
		a.thumbprint AS thumbprint,
		a.algorithm AS algorithm,
		case when vpt.value = 6 then -- x_emd_EKMProvider = 6
		    convert(varbinary(60),asymkeyproperty(a.id, 'algorithm_desc'))
		    else alg.name end AS algorithm_desc,
		a.bitlength AS key_length,
		convert(varbinary(85), asymkeyproperty(a.id, 'sid')) AS sid,
		convert(nvarchar(128), asymkeyproperty(a.id, 'string_sid')) AS string_sid,
		a.pukey AS public_key,
		convert(nvarchar(260), v.value) AS attested_by,
		n.name as provider_type,
		convert (uniqueidentifier, vpg.value) AS cryptographic_provider_guid,
		vpa.value AS cryptographic_provider_algid
	FROM sys.sysasymkeys a
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = a.id AND r.class = 64 AND r.depsubid = 0
	LEFT JOIN sys.syspalnames ce ON ce.class = 'CETY' AND ce.value = a.encrtype
	LEFT JOIN sys.syspalnames alg ON alg.class = 'ENAL' AND alg.value = a.algorithm
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 34 AND v.objid = a.id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_AKATTESTINGDLLPATH
	LEFT JOIN sys.sysobjvalues vpt ON vpt.valclass = 31 AND vpt.objid = a.id AND vpt.subobjid = 0 AND vpt.valnum = 1	-- SVC_AKPROVPROPS/PROV_TYPE_PROP
	LEFT JOIN sys.sysobjvalues vpg ON vpg.valclass = 31 AND vpg.objid = a.id AND vpg.subobjid = 0 AND vpg.valnum = 2	-- SVC_AKPROVPROPS/PROV_GUID_PROP
	LEFT JOIN sys.sysobjvalues vpa ON vpa.valclass = 31 AND vpa.objid = a.id AND vpa.subobjid = 0 AND vpa.valnum = 3	-- SVC_AKPROVPROPS/PROV_ALGID_PROP
	LEFT JOIN sys.sysobjvalues vpu ON vpu.valclass = 31 AND vpu.objid = a.id AND vpu.subobjid = 0 AND vpu.valnum = 5	-- SVC_AKPROVPROPS/PROV_URI_PROP
	LEFT JOIN sys.syspalvalues n ON n.class = 'CPKP' AND n.value = vpt.value
	WHERE has_access('AK', a.id) = 1
"
1952	Parse Tree	View	-411	32767	6	4	1	11	11	251	0	1	1024	0	0	0	0	0	718	"CREATE VIEW sys.procedures AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc, create_date, modify_date,
		is_ms_shipped, is_published, is_schema_published,
		is_auto_executed, is_execution_replicated,
		is_repl_serializable_only, skips_repl_constraints
	FROM sys.objects$
	WHERE type IN ('P ', 'X ', 'PC', 'RF')
"
1960	Parse Tree	View	-879924562	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	200	"CREATE VIEW sys.dm_db_log_space_usage AS
	SELECT *
	FROM OpenRowset(TABLE DM_DB_LOG_SPACE_USAGE)
"
1962	Parse Tree	View	-246260710	32767	6	4	1	2	10	251	0	1	1024	0	0	0	0	0	404	"
-- add it
create view sys.pdw_physical_databases as
select database_id, name as physical_name from sys.databases
where name not in ('DWConfiguration', 'DWDiagnostics', 'DWQueue', 'model', 'msdb')
"
1977	Parse Tree	View	-655991572	32767	1	4	1	3	8	251	0	1	1024	0	0	0	0	0	958	"
create view sys.dm_exec_cached_plans as 
	SELECT
		bucketid,
		refcounts,
		usecounts,
		size_in_bytes,
		memory_object_address,
		cacheobjtype,
		objtype,
		plan_handle,
		pool_id,
		parent_plan_handle
	FROM OpenRowset(TABLE SYSDMEXECCACHEDPLANS)
	UNION ALL
	SELECT 
		bucketid,
		refcounts,
		usecounts,
		size_in_bytes,
		memory_object_address,
		cacheobjtype,
		objtype,
		plan_handle,
		pool_id,
		NULL
	FROM OpenRowset(TABLE XTP_CACHED_PLANS)

"
1977	Parse Tree	View	-655991572	32767	6	4	1	9	8	251	0	1	1024	0	0	0	0	0	958	"
create view sys.dm_exec_cached_plans as 
	SELECT
		bucketid,
		refcounts,
		usecounts,
		size_in_bytes,
		memory_object_address,
		cacheobjtype,
		objtype,
		plan_handle,
		pool_id,
		parent_plan_handle
	FROM OpenRowset(TABLE SYSDMEXECCACHEDPLANS)
	UNION ALL
	SELECT 
		bucketid,
		refcounts,
		usecounts,
		size_in_bytes,
		memory_object_address,
		cacheobjtype,
		objtype,
		plan_handle,
		pool_id,
		NULL
	FROM OpenRowset(TABLE XTP_CACHED_PLANS)

"
1985	Parse Tree	View	-237	32767	6	4	1	10	9	251	0	1	1024	0	0	0	0	0	1488	"CREATE VIEW sys.server_trigger_events AS
	SELECT ee.object_id AS object_id,
		ee.event_id AS type,
		ee.event_desc AS type_desc,
		convert(bit, 1) AS is_trigger_event,
		sysconv(bit, convert(int, e.value) & 1) AS is_first,	-- TRG_FIRSTFIRED
		sysconv(bit, convert(int, e.value) & 2) AS is_last,	-- TRG_LASTFIRED
		ee.group_id AS event_group_type,
		ee.group_desc AS event_group_type_desc
	FROM sys.sysobjvalues e
	CROSS APPLY openrowset( TABLE EXPAND_EVENTS, e.objid, e.subobjid, 
		case when (e.valclass = 70 AND convert(int, e.value) & 4 != 4)	-- is user created trigger? 
			then 1 else 0 end) ee
	WHERE e.valclass = 70 AND e.valnum = 100	-- x_eunc_Server
		AND has_access('CO', e.objid) = 1	-- SVC_EXTTRIGEVT, SVC_ASYNTRGEVT
"
1990	Parse Tree	View	-425657552	32767	6	4	1	14	4	251	0	1	1024	0	0	0	0	0	648	"CREATE view sys.dm_cdc_errors
as
	SELECT 
	    [session_id]
        ,[phase_number]
        ,[entry_time]
        ,[error_number]
        ,[error_severity]
        ,[error_state]
        ,[error_message]
        ,[start_lsn]
        ,[begin_lsn]
        ,[sequence_value]
	FROM OpenRowset(TABLE DM_CDC_ERRORS)
"
1995	Parse Tree	View	-548	32767	6	4	1	2	41	187	0	1	1024	0	0	0	0	0	6728	"CREATE VIEW sys.plan_persist_runtime_stats_merged AS
	SELECT 
		runtime_stats_id,
		plan_id,
		runtime_stats_interval_id,
		execution_type,
		first_execution_time,
		last_execution_time,
		count_executions,
		total_duration,
		last_duration,
		min_duration,
		max_duration,
		sumsquare_duration,
		total_cpu_time,
		last_cpu_time,
		min_cpu_time,
		max_cpu_time,
		sumsquare_cpu_time,
		total_logical_io_reads,
		last_logical_io_reads,
		min_logical_io_reads,
		max_logical_io_reads,
		sumsquare_logical_io_reads,
		total_logical_io_writes,
		last_logical_io_writes,
		min_logical_io_writes,
		max_logical_io_writes,
		sumsquare_logical_io_writes,
		total_physical_io_reads,
		last_physical_io_reads,
		min_physical_io_reads,
		max_physical_io_reads,
		sumsquare_physical_io_reads,
		total_clr_time,
		last_clr_time,
		min_clr_time,
		max_clr_time,
		sumsquare_clr_time,
		total_dop,
		last_dop,
		min_dop,
		max_dop,
		sumsquare_dop,
		total_query_max_used_memory,
		last_query_max_used_memory, 
		min_query_max_used_memory,
		max_query_max_used_memory,
		sumsquare_query_max_used_memory,
		total_rowcount,
		last_rowcount,
		min_rowcount,
		max_rowcount,
		sumsquare_rowcount,
		total_num_physical_io_reads,
		last_num_physical_io_reads,
		min_num_physical_io_reads,
		max_num_physical_io_reads,
		sumsquare_num_physical_io_reads,
		total_log_bytes_used,
		last_log_bytes_used,
		min_log_bytes_used,
		max_log_bytes_used,
		sumsquare_log_bytes_used,
		total_tempdb_space_used,
		last_tempdb_space_used,
		min_tempdb_space_used,
		max_tempdb_space_used,
		sumsquare_tempdb_space_used
	FROM sys.plan_persist_runtime_stats WITH(NOLOCK)
	UNION ALL
	SELECT
		runtime_stats_id,
		plan_id,
		runtime_stats_interval_id,
		execution_type,
		first_execution_time,
		last_execution_time,
		count_executions,
		total_duration,
		last_duration,
		min_duration,
		max_duration,
		sumsquare_duration,
		total_cpu_time,
		last_cpu_time,
		min_cpu_time,
		max_cpu_time,
		sumsquare_cpu_time,
		total_logical_io_reads,
		last_logical_io_reads,
		min_logical_io_reads,
		max_logical_io_reads,
		sumsquare_logical_io_reads,
		total_logical_io_writes,
		last_logical_io_writes,
		min_logical_io_writes,
		max_logical_io_writes,
		sumsquare_logical_io_writes,
		total_physical_io_reads,
		last_physical_io_reads,
		min_physical_io_reads,
		max_physical_io_reads,
		sumsquare_physical_io_reads,
		total_clr_time,
		last_clr_time,
		min_clr_time,
		max_clr_time,
		sumsquare_clr_time,
		total_dop,
		last_dop,
		min_dop,
		max_dop,
		sumsquare_dop,
		total_query_max_used_memory,
		last_query_max_used_memory, 
		min_query_max_used_memory,
		max_query_max_used_memory,
		sumsquare_query_max_used_memory,
		total_rowcount,
		last_rowcount,
		min_rowcount,
		max_rowcount,
		sumsquare_rowcount,
		total_num_physical_io_reads,
		last_num_physical_io_reads,
		min_num_physical_io_reads,
		max_num_physical_io_reads,
		sumsquare_num_physical_io_reads,
		total_log_bytes_used,
		last_log_bytes_used,
		min_log_bytes_used,
		max_log_bytes_used,
		sumsquare_log_bytes_used,
		total_tempdb_space_used,
		last_tempdb_space_used,
		min_tempdb_space_used,
		max_tempdb_space_used,
		sumsquare_tempdb_space_used
	FROM sys.plan_persist_runtime_stats_in_memory
"
2017	Parse Tree	View	-432	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	380	"CREATE VIEW sys.assembly_references AS
	SELECT depid AS assembly_id,
		indepid AS referenced_assembly_id
	FROM sys.sysmultiobjrefs
	WHERE class = 10 AND depsubid = 0 AND indepsubid = 0
"
2034	Parse Tree	View	-272834121	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	198	"CREATE VIEW sys.dm_broker_queue_monitors AS
    SELECT * FROM OpenRowset (TABLE SBQUEUEMONITORS)
"
2049	Parse Tree	View	-104492283	32767	6	4	1	13	5	251	0	1	1024	0	0	0	0	0	654	"CREATE VIEW sys.fulltext_document_types AS
	select componentname as [document_type], 
		   clsid as [class_id], 
		   (case when is_srvrolemember('serveradmin') = 1 then fullpath else NULL end) AS [path], 
	         version, 
	         manufacturer
	from sys.fn_ftcatcomponents(1, 0, 0)
	where componenttype = 'filter'
"
2050	Parse Tree	View	-63832383	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	354	"
-- add it
create view sys.pdw_diag_events as
select
	name	collate database_default name,
	source	collate database_default source,
	is_enabled
from sys._pdw_diag_events
"
2050	Parse Tree	View	-258	32767	6	4	1	7	12	251	0	1	1024	0	0	0	0	0	1980	"CREATE VIEW sys.change_tracking_databases AS
	SELECT 
		id AS database_id,
		-- UNDONE: reconcile this for Sterling if needed.
		-- case when d.name = db_name() then COALESCE(convert(int, dbprop(db_id(), 'logicaldbid')), d.id) else d.id end AS database_id,
		convert(tinyint, DatabasePropertyEx(name, 'IsChangeTrackingAutoCleanup')) as is_auto_cleanup_on,
		convert(int, DatabasePropertyEx(name, 'ChangeTrackingRetentionPeriod')) as retention_period,
		convert(tinyint, DatabasePropertyEx(name, 'ChangeTrackingRetentionUnits')) as retention_period_units,
		convert(nvarchar(60), DatabasePropertyEx(name, 'ChangeTrackingRetentionUnitsDesc')) as retention_period_units_desc,
		change_tracking_max_cleanup_version((case when serverproperty('EngineEdition') = 5 then DB_ID() else id end)) as max_cleanup_version
	FROM sys.sysdbreg
	WHERE id < 0x7fff
		AND has_access('DB', (case when serverproperty('EngineEdition') = 5 then DB_ID() else id end)) = 1
		AND (category & 128) = 128
"
2060	Parse Tree	View	-569	32767	6	4	1	13	15	251	0	1	1024	0	0	0	0	0	1978	"CREATE VIEW sys.database_credentials AS
    SELECT
        co.name,
        ISNULL(p.indepid, 1) AS principal_id, -- 1: Default DBO owner
        co.id AS credential_id,
        convert(nvarchar(4000), ov.value) as credential_identity,
        co.created as create_date,
        co.modified as modify_date,
        n.name as target_type,
        r.indepid AS target_id
    FROM sys.sysclsobjs co
    LEFT JOIN sys.sysobjvalues ov ON ov.valclass = 28 AND ov.objid = co.id AND ov.subobjid = 0 AND ov.valnum = 1
    LEFT JOIN sys.syssingleobjrefs r ON r.depid = co.id AND r.class = co.intprop AND r.depsubid = 0  
    LEFT JOIN sys.syssingleobjrefs p ON p.depid = co.id AND p.class = 121 AND p.depsubid = 0 -- SRC_DB_SCOPED_CRED_OWNER
    LEFT JOIN sys.syspalvalues n ON n.class = 'SRCL' AND n.value = co.intprop
    WHERE co.class = 57
        AND co.type = '1' -- Database Scope Credentials
		AND has_access('DC', co.id) = 1 -- View Database Scoped Credential permission.
"
2061	Parse Tree	View	-200	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	156	"CREATE VIEW sys.syscursors AS
	SELECT *
	FROM OpenRowSet(TABLE SYSCURSORS)
"
2067	Parse Tree	View	-17925033	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	418	"
-- add it
create view sys.pdw_diag_event_properties as
select
	event_name	collate database_default event_name,
	property_name	collate database_default property_name
from sys._pdw_diag_event_properties
"
2072	Parse Tree	View	-142	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	484	"CREATE VIEW sys.sysfilegroups AS
	SELECT
		groupid = convert(smallint, data_space_id & 0x7fff),
		allocpolicy = convert(smallint, 0),
		status = convert(int, is_default * 16 + is_read_only * 8),
		groupname = name
	FROM sys.filegroups
"
2076	Compiled Plan	Adhoc	273341834	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	142	SELECT t.* FROM sys.resource_governor_external_resource_pool_affinity t
2081	Parse Tree	View	-204203741	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	216	"
CREATE VIEW sys.dm_db_xtp_checkpoint_internals
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_CHECKPOINTS)
"
2081	Parse Tree	View	-672085049	32767	6	4	1	17	7	251	0	1	1024	0	0	0	0	0	1176	"CREATE VIEW sys.dm_hadr_physical_seeding_stats
AS
	SELECT 
		local_physical_seeding_id,
		remote_physical_seeding_id,
		local_database_id,
		local_database_name,
		remote_machine_name,
		role_desc,
		internal_state_desc,
		transfer_rate_bytes_per_second,
		transferred_size_bytes,
		database_size_bytes, 
		start_time_utc,
		end_time_utc,
		estimate_time_complete_utc,
		total_disk_io_wait_time_ms,
		total_network_wait_time_ms,
		failure_code,
		failure_message,
		failure_time_utc,
		is_compression_enabled
	FROM OpenRowset(TABLE DM_CLOUD_PHYSICAL_SEEDING_STATS)
"
2082	Parse Tree	View	-453	32767	6	4	1	9	7	251	0	1	1024	0	0	0	0	0	660	"CREATE VIEW sys.xml_schema_facets AS
	SELECT f.compid AS xml_component_id,
		f.ord AS facet_id,
		f.kind,
		k.name AS kind_desc,
		sysconv(bit, f.status & 1) AS is_fixed,
		f.dflt AS value
	FROM sys.sysxmlfacet f
	LEFT JOIN sys.sysbinpals k ON k.class = 'XFKI' AND k.value = f.kind
	WHERE has_access('XC', f.compid) = 1
"
2091	Parse Tree	View	-1046288262	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	304	"
-- add it
create view sys.pdw_nodes_partitions as
select *, convert(int, null) pdw_node_id, convert(int, null) distribution_id from sys.partitions
"
2093	Parse Tree	View	-395	32767	6	4	1	29	24	251	0	1	1024	0	0	0	0	0	4970	"CREATE VIEW sys.computed_columns AS
	SELECT object_id = id,
		name = s.name,
		column_id = colid,
		system_type_id = xtype,
		user_type_id = utype,
		max_length = length,
		precision = prec,
		scale = scale,
		collation_name = convert(sysname,CollationPropertyFromId(collationid,'name')),
		is_nullable = sysconv(bit, 1 - (status & 1)), 		-- CPM_NOTNULL
		is_ansi_padded = sysconv(bit, status & 2), 		-- CPM_NOTRIM
		is_rowguidcol = sysconv(bit, status & 8), 		-- CPM_ROWGUIDCOL
		is_identity = sysconv(bit, status & 4), 		-- CPM_IDENTCOL
		is_filestream = sysconv(bit, status & 32), 		-- CPM_FILESTREAM
		is_replicated = sysconv(bit, status & 0x20000), 	-- CPM_REPLICAT
		is_non_sql_subscribed = sysconv(bit, status & 0x40000),	-- CPM_NONSQSSUB
		is_merge_published = sysconv(bit, status & 0x80000), 	-- CPM_MERGEREPL
		is_dts_replicated = sysconv(bit, status & 0x100000), 	-- CPM_REPLDTS
		is_xml_document = sysconv(bit, status & 2048),		-- CPM_XML_DOC 		
		xml_collection_id = xmlns,
		default_object_id = dflt,
		rule_object_id = chk,
		definition = object_definition(id, colid),
		uses_database_collation = sysconv(bit, status & 128),		-- CPM_USESDBCOLL
		is_persisted = sysconv(bit, status & 64),			-- CPM_PERSISTEDCC	
		is_computed = sysconv(bit, status & 16),			-- CPM_COMPUTED	
		sysconv(bit, 0) as is_sparse,
		sysconv(bit, 0) as is_column_set,
		convert(tinyint, 0) AS generated_always_type,
		convert(nvarchar(60), 'NOT_APPLICABLE') collate Latin1_General_CI_AS_KS_WS AS generated_always_type_desc,
		convert(int, NULL) as encryption_type,
		convert(nvarchar(64), NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_type_desc,
		convert(sysname, NULL) COLLATE Latin1_General_CI_AS_KS_WS as encryption_algorithm_name,
		convert(int, NULL) as column_encryption_key_id,
		convert(sysname, NULL) collate catalog_default as column_encryption_key_database_name,
		sysconv(bit, 0) as is_hidden,
		sysconv(bit, 0) AS is_masked,
		convert(int, NULL) AS graph_type,
		convert(nvarchar(60), NULL) collate Latin1_General_CI_AS_KS_WS as graph_type_desc
	FROM sys.syscolpars s
	LEFT JOIN sys.sysobjvalues sov1 ON sov1.valclass = 128 /*SVC_GRAPHDB_COLUMN_TYPE*/ AND sov1.objid = id AND sov1.subobjid = colid AND sov1.valnum = 0 
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'EGCT' AND v1.value = convert(int, sov1.value)
	WHERE number = 0
		AND (status & 16) = 16			-- CPM_COMPUTED
		AND sov1.value IS NULL
		AND has_access('CO', id) = 1
"
2105	Parse Tree	View	-851643926	32767	6	4	1	11	3	251	0	1	1024	0	0	0	0	0	200	"CREATE view sys.dm_hadr_name_id_map
as
	SELECT 
	*
	FROM OpenRowset(TABLE DM_HADR_NAME_ID_MAP)
"
2106	Parse Tree	View	-1040815568	32767	6	4	1	2	6	251	0	1	1024	0	0	0	0	0	232	"CREATE VIEW sys.dm_db_xtp_nonclustered_index_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_RANGE_INDEX_STATS)
"
2115	Parse Tree	View	-499566554	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	760	"CREATE VIEW sys.dm_resource_governor_external_resource_pools AS
 	SELECT 
		external_pool_id,
		name,
		pool_version,
		max_cpu_percent,
		max_processes,
		max_memory_percent,
		statistics_start_time,
		peak_memory_kb,
		write_io_count,
		read_io_count,
		total_cpu_kernel_ms,
		total_cpu_user_ms,
		active_processes_count

	FROM OpenRowSet(TABLE DM_RG_EXTPOOLS)
"
2116	Parse Tree	View	-39192848	32767	6	4	1	8	6	251	0	1	1024	0	0	0	0	0	814	"create view sys.dm_os_cluster_nodes
as
	select 
		[NodeName],
		[status] = convert (int, [state] & 0xffff),
		[status_description] = 
			CASE convert(int, [state] & 0xffff)
				When 0 Then 'up'
				When 1 Then 'down'
				When 3 Then 'joining'
				When 2 Then 'paused'
				Else 'unknown'
			END,
		convert(bit, [state] & 0x10000) as is_current_owner
	from OpenRowset(TABLE VIRTUALSERVERNODES)
"
2124	Compiled Plan	Adhoc	53572405	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.fulltext_languages t
2125	Parse Tree	View	-590	32767	6	4	1	2	14	251	0	1	1024	0	0	0	0	0	972	"
-- add it
create view sys.pdw_table_distribution_properties as
select
	so.objid as object_id,
	cast (so.value as tinyint) as distribution_policy,
	cast (
		case so.value
			when 1 then N'NONE'
			when 2 then N'HASH'
			when 3 then N'REPLICATE'
			when 4 then N'ROUND_ROBIN'
			else N'UNDEFINED'
		end
		as nvarchar(60)) as distribution_policy_desc
from  sys.sysobjvalues so
where so.valclass = 126 -- SVC_MPP_TABLE
	and so.valnum = 0 -- MPP_TABLE_DISTRIBUTION_POLICY
"
2126	Parse Tree	View	-221	32767	1	4	1	1	5	251	0	1	1024	0	0	0	0	0	454	"CREATE VIEW sys.remote_logins AS
	SELECT srvid AS server_id,
		name AS remote_name,
		lgnid AS local_principal_id,
		modate AS modify_date
	FROM master.sys.sysrmtlgns
	WHERE lgnid = suser_id() OR has_access('SR', 0) = 1
"
2126	Parse Tree	View	-221	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	454	"CREATE VIEW sys.remote_logins AS
	SELECT srvid AS server_id,
		name AS remote_name,
		lgnid AS local_principal_id,
		modate AS modify_date
	FROM master.sys.sysrmtlgns
	WHERE lgnid = suser_id() OR has_access('SR', 0) = 1
"
2131	Parse Tree	View	-568350250	32767	6	4	1	1	4	251	0	1	1024	0	0	0	0	0	260	"
-- add it
create view sys.dm_pdw_nodes_os_latch_stats as
select *, convert(int, null) pdw_node_id from sys.dm_os_latch_stats
"
2136	Parse Tree	View	-377091052	32767	6	4	1	4	3	251	0	1	1024	0	0	0	0	0	296	"CREATE VIEW sys.fulltext_system_stopwords
AS
	SELECT convert(nvarchar(64), stopword) as stopword, language_id FROM OpenRowset(TABLE FTSYSSTPWD) 
"
2144	Compiled Plan	Adhoc	159222841	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_tran_version_store t
2148	Parse Tree	View	-105	32767	6	4	1	9	25	251	0	1	1024	0	0	0	0	0	4002	"-- Return visible system objects in master database context
CREATE VIEW sys.sysobjects AS
	SELECT name, 
		id,
		xtype = type collate catalog_default,
		uid = convert(smallint, nsid),
		info = convert(smallint, 0),
		status = convert(int, 0),
		base_schema_ver = convert(int, 0),
		replinfo = convert(int, 0),
		parent_obj = pid,
		crdate = created,
		ftcatid = convert(smallint, 
			case type when 'U' then OBJECTPROPERTY(id, 'TableFulltextCatalogId')
			else 0 end),
		schema_ver = convert(int, 0),
		stats_schema_ver = convert(int, 0),
		type = convert(char(2), 
			case type when 'UQ' then 'K' when 'PK' then 'K' when 'ET' then 'U'
			else type collate catalog_default end),
		userstat = convert(smallint, 
			case type when 'S' then 1 when 'U' then 1 when 'ET' then 1
			else 0 end),
		sysstat = convert(smallint, 
			case type when 'S' then 1 when 'V' then 2 when 'U' then 3 when 'P' then 4 when 'RF' then 4
			when 'X' then 4 when 'D' then 6 when 'R' then 7 when 'TR' then 8
			when 'PK' then 9 when 'UQ' then 9 when 'C' then 10 when 'F' then 11
			else 0 end),
		indexdel = convert(smallint, 0),
		refdate = created,
		version = convert(int, 0),
		deltrig = convert(int,
			case type when 'U' then OBJECTPROPERTY(id,'TableDeleteTrigger')
			when 'TR' then pid else 0 end),
		instrig = convert(int, 
			case type when 'U' then OBJECTPROPERTY(id,'TableInsertTrigger')
			else 0 end),
		updtrig = convert(int,
			case type when 'U' then OBJECTPROPERTY(id,'TableUpdateTrigger')
			else 0 end),
		seltrig = convert(int, 0),
		category = convert(int, 
			case when type = 'D' and pid <> 0 then 2048 
			else 0 end
			+ 
			case when type = 'P' and (status & 256) <> 0 then 16 
			else 0 end -- is_auto_executed
			+ (status & 1)*2 + (status & 16)*2), -- is_ms_shipped * 2 + is_published * 32
		cache = convert(smallint, 0)
	FROM sys.sysschobjs$
	WHERE nsclass = 0 -- x_eonc_Standard
	AND pclass = 1 -- x_eunc_Object
	AND has_access('MO', id) = 1
"
2158	Parse Tree	View	-416	32767	6	4	1	15	19	251	0	1	1024	0	0	0	0	0	2786	"CREATE VIEW sys.sql_modules AS
	SELECT object_id = o.id,
		definition = object_definition(o.id),
		uses_ansi_nulls = sysconv(bit, o.status & 0x40000), 			-- OBJMOD_ANSINULLS
		uses_quoted_identifier = sysconv(bit, o.status & 0x80000), 		-- OBJMOD_QUOTEDIDENT
		is_schema_bound = sysconv(bit, o.status & 0x20000), 			-- OBJMOD_SCHEMABOUND
		uses_database_collation = sysconv(bit, o.status & 0x100000), 	-- OBJMOD_USESDBCOLL
		is_recompiled = sysconv(bit, o.status & 0x400000), 				-- OBJMOD_NOCACHE
		null_on_null_input = sysconv(bit, o.status & 0x200000), 		-- OBJMOD_NULLONNULL
		execute_as_principal_id = x.indepid,
		uses_native_compilation = sysconv(bit, CASE WHEN (o.type = 'P') THEN o.status & 0x00000200	-- OBJPRC_HEKATON
												WHEN (o.type = 'FN') THEN o.status & 0x00000200		-- OBJPRC_HEKATON
												WHEN (o.type = 'TR') THEN o.status & 0x00001000		-- OBJTRG_HEKATON
												WHEN (o.type = 'IF') THEN o.status & 0x00000200		-- OBJPRC_HEKATON
												ELSE 0
												END)
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syssingleobjrefs x ON x.depid = o.id AND x.class = 22 AND x.depsubid = 0 -- SRC_OBJEXECASOWNER
	WHERE o.pclass <> 100 -- x_eunc_Server
		AND ((o.type = 'TR' AND has_access('TR', o.id, o.pid, o.nsclass) = 1)
			OR (type IN ('P','V','FN','IF','TF','RF','IS') AND has_access('CO', o.id) = 1)
			OR (type IN ('R','D') AND o.pid = 0))
"
2162	Parse Tree	View	-404521279	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	200	"CREATE view sys.dm_fts_semantic_similarity_population
AS
	SELECT * FROM OpenRowset(TABLE DSIPOP)
"
2167	Parse Tree	View	-464242447	32767	6	4	1	21	7	251	0	1	1024	0	0	0	0	0	1032	"
-- add it
create view sys.dm_pdw_resource_waits as
select
	wait_id,
	session_id	collate database_default session_id,
	type	collate database_default type,
	object_type collate database_default object_type,
	object_name collate database_default object_name,
	request_id	collate database_default request_id,
	request_time,
	acquire_time,
	state	collate database_default state,
	priority,
	concurrency_slots_used,
	resource_class	collate database_default resource_class
from sys._dm_pdw_resource_waits
"
2171	Parse Tree	View	-511861742	32767	6	4	1	25	8	251	0	1	1024	0	0	0	0	0	1298	"CREATE view sys.dm_cdc_log_scan_sessions
as
	SELECT 
	    [session_id]
        ,[start_time]
        ,[end_time]
        ,[duration]
        ,[scan_phase]
        ,[error_count]
        ,[start_lsn]
        ,[current_lsn]
        ,[end_lsn]
        ,[tran_count]
        ,[last_commit_lsn]
        ,[last_commit_time]
        ,[log_record_count]
        ,[schema_change_count]
        ,[command_count]
        ,[first_begin_cdc_lsn]
        ,[last_commit_cdc_lsn]
        ,[last_commit_cdc_time]
        ,[latency]
        ,[empty_scan_count]
        ,[failed_sessions_count]
	FROM OpenRowset(TABLE DM_CDC_LOGSCAN_SESSIONS)
"
2191	Parse Tree	View	-242	32767	6	4	1	4	7	251	0	1	1024	0	0	0	0	0	696	"CREATE VIEW sys.database_recovery_status AS
	SELECT d.id AS database_id,
		p.database_guid,
		p.family_guid,
		p.last_log_backup_lsn,
		p.recovery_fork_guid,
		p.first_recovery_fork_guid,
		p.fork_point_lsn
	FROM master.sys.sysdbreg d OUTER APPLY OpenRowset(TABLE DBRECOVER, d.id) p
	WHERE d.id < 0x7fff
		AND has_access('DB', d.id) = 1
"
2199	Parse Tree	View	-354452907	32767	6	4	1	4	3	251	0	1	1024	0	0	0	0	0	262	"CREATE VIEW sys.dm_db_persisted_sku_features AS
	SELECT feature_name, feature_id
	FROM OpenRowset(TABLE persisted_sku_features)
"
2211	Parse Tree	View	-292564105	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	192	"CREATE VIEW sys.syscscontainers AS
	SELECT *
	FROM OpenRowset(TABLE BLOB_CONTAINER_ACCESSOR)
"
2212	Parse Tree	View	-495	32767	6	4	1	24	8	251	0	1	1024	0	0	0	0	0	1018	"CREATE VIEW sys.sql_expression_dependencies AS
	SELECT referencing_id, referencing_minor_id, referencing_class, referencing_class_desc,
			is_schema_bound_reference, referenced_class, referenced_class_desc,
			referenced_server_name, referenced_database_name, referenced_schema_name, referenced_entity_name,
			referenced_id, referenced_minor_id, is_caller_dependent, is_ambiguous
	FROM sys.sql_expression_dependencies$
	WHERE has_perms_by_name(quotename(db_name()), 'DATABASE', 'VIEW DEFINITION') = 1
"
2223	Parse Tree	View	-437	32767	6	4	1	12	17	251	0	1	1024	0	0	0	0	0	1568	"CREATE VIEW sys.filegroups AS
	SELECT o.name AS name,
		o.id AS data_space_id,
		o.type,
		c.name AS type_desc,
		sysconv(bit, o.status & 0x1) AS is_default,
		sysconv(bit, o.status & 0x4) AS is_system,
		g.guid AS filegroup_guid,
		r.indepid AS log_filegroup_id,
		sysconv(bit, o.status & 0x2) AS is_read_only,
		sysconv(bit, o.status & 0x8) AS is_autogrow_all_files
	FROM sys.sysclsobjs o
	LEFT JOIN sys.sysguidrefs g ON g.id = o.id AND g.class = 3 AND g.subid = 0 -- GRC_FGGUID
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 58 AND r.depsubid = 0 -- SRC_FGPAIR
	LEFT JOIN sys.syspalnames c ON c.class = 'DSTY' AND c.value = o.type
	WHERE o.class = 31 AND (o.type IN ('FD', 'FG', 'FL') OR (o.type = 'FX' AND serverproperty('EngineEdition') <> 5))
"
2232	Parse Tree	View	-305100784	32767	6	4	1	24	5	251	0	1	1024	0	0	0	0	0	190	"CREATE VIEW sys.dm_server_services AS
	SELECT *
	FROM OpenRowset(TABLE DM_SERVER_SERVICES) 
"
2244	Parse Tree	View	-778689403	32767	6	4	1	4	7	251	0	1	1024	0	0	0	0	0	796	"
-- add it
create view sys.dm_pdw_node_status as
select
	pdw_node_id,
	process_id,
	process_name	collate database_default process_name,
	allocated_memory,
	available_memory,
	process_cpu_usage,
	total_cpu_usage,
	thread_count,
	handle_count,
	total_elapsed_time,
	is_available,
	sent_time,
	received_time,
	error_id	collate database_default error_id
from sys._dm_pdw_node_status
"
2250	Parse Tree	View	-133761156	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	396	"
-- add it
create view sys.dm_pdw_query_stats_xe_file as
select
	event	collate database_default event,
	data	collate database_default data,
	pdw_node_id
from sys._dm_pdw_query_stats_xe_file
"
2256	Parse Tree	View	-263	32767	6	4	1	3	12	251	0	1	1024	0	0	0	0	0	1464	"CREATE VIEW sys.availability_replicas_internal AS
	SELECT
		group_id = sgr.guid,
		name = co.name,
		replica_id = sgr2.guid,
		owner_sid = p.sid,
		internal_group_id = co.id,
		create_date = co.created,
		modify_date = co.modified
	FROM master.sys.sysclsobjs  co
	LEFT JOIN master.sys.sysguidrefs sgr ON
	(
		sgr.class = 8 AND -- GRC_AGGUID
		sgr.id = co.id AND 
		sgr.subid = 0         -- AGGUID_AG_ID
	)
	LEFT JOIN master.sys.sysguidrefs sgr2 ON
	(
		sgr2.class = 8 AND -- GRC_AGGUID
		sgr2.id = co.id AND 
		sgr2.subid = 1       -- AGGUID_REPLICA_ID
	)
	LEFT JOIN master.sys.sysxlgns p ON
	(
		p.id = co.status
	)
	WHERE
		co.class = 67    -- SOC_AVAILABILITY_GROUP
		AND has_access('AG', co.id) = 1
"
2267	Parse Tree	View	-205	32767	6	4	1	14	36	251	0	1	1024	0	0	0	0	0	5070	"CREATE VIEW sys.syslogins AS SELECT
	sid = p.sid,
	status = convert(smallint, 8 +
		CASE WHEN m.state in ('G','W') THEN 1 ELSE 2 END),
	createdate = p.create_date,
	updatedate = p.modify_date,
	accdate = p.create_date,
	totcpu = convert(int, 0),
	totio = convert(int, 0),
	spacelimit = convert(int, 0),
	timelimit = convert(int, 0),
	resultlimit = convert(int, 0),
	name = p.name,
	dbname = p.default_database_name,
	password = convert(sysname, LoginProperty(p.name, 'PasswordHash')),
	language = p.default_language_name,
	denylogin = convert(int, CASE WHEN m.state ='D' THEN 1 ELSE 0 END),
	hasaccess = convert(int, CASE WHEN m.state in ('G','W') THEN 1 ELSE 0 END),
	isntname = convert(int, CASE WHEN p.type in ('G','U') THEN 1 ELSE 0 END),
	isntgroup = convert(int, CASE WHEN p.type='G' THEN 1 ELSE 0 END),
	isntuser = convert(int, CASE WHEN p.type='U' THEN 1 ELSE 0 END),
	sysadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 3), 0)), --x_MDLoginIdSysAdmin
	securityadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 4), 0)), --x_MDLoginIdSecAdmin
	serveradmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 5), 0)), --x_MDLoginIdServAdmin
	setupadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 6), 0)), --x_MDLoginIdSetupAdmin
	processadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 7), 0)), --x_MDLoginIdProcAdmin
	diskadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 8), 0)), --x_MDLoginIdDiskAdmin
	dbcreator = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 9), 0)), --x_MDLoginIdDBCreator
	bulkadmin = convert(int, ISNULL ((SELECT 1 FROM sys.server_role_members WHERE member_principal_id = p.principal_id
		AND role_principal_id = 10), 0)), --x_MDLoginIdBulkAdmin
	loginname = p.name
FROM sys.server_principals p LEFT JOIN master.sys.sysprivs m
	ON m.class = 100 AND m.id = 0 AND m.subid = 0 AND m.grantee = p.principal_id AND m.grantor = 1 AND m.type = 'COSQ'
WHERE p.type <> 'R'
"
2277	Parse Tree	View	-516	32767	6	4	1	10	9	251	0	1	1024	0	0	0	0	0	412	"CREATE VIEW sys.filetables AS
	SELECT p.*
	FROM sys.objects$ o WITH (NOLOCK)
		CROSS APPLY OpenRowset(TABLE FILETABLES, o.object_id) p
	WHERE o.is_filetable = 1
	AND has_access('CO', o.object_id) = 1
"
2288	Parse Tree	View	-189437573	32767	6	4	1	2	6	251	0	1	1024	0	0	0	0	0	798	"CREATE VIEW sys.dm_exec_query_resource_semaphores AS
	SELECT convert(smallint, ~convert(bit, isnull(max_target_memory_kb, -1) +1)) as resource_semaphore_id,
	target_memory_kb, max_target_memory_kb, total_memory_kb, available_memory_kb, granted_memory_kb,
	used_memory_kb, grantee_count, waiter_count, timeout_error_count, forced_grant_count,
	pool_id
	FROM OpenRowset(TABLE DM_EXEC_QE_RESSEM)
"
2288	Parse Tree	View	-458	32767	6	4	1	2	7	251	0	1	1024	0	0	0	0	0	596	"CREATE VIEW sys.xml_schema_wildcard_namespaces AS
	SELECT xml_component_id = r.depid,
		namespace = q.name
	FROM sys.sysmultiobjrefs r JOIN sys.sysqnames q ON r.indepid = q.nid
	WHERE r.class = 83 AND r.depsubid = 0 AND r.indepsubid = 0	-- MRC_XMLWILDCARDNS
		AND has_access('XC', depid) = 1
"
2289	Parse Tree	View	-590517192	32767	6	4	1	1	6	251	0	1	1024	0	0	0	0	0	744	"
-- add it
create view sys.dm_pdw_nodes_tran_active_transactions as
select
transaction_id,
name,
transaction_begin_time,
transaction_type,
transaction_uow,
transaction_state,
transaction_status,
transaction_status2,
dtc_state,
dtc_status,
dtc_isolation_level,
filestream_transaction_id,
convert(int, null) pdw_node_id from sys.dm_tran_active_transactions
"
2292	Parse Tree	View	-2059280	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	292	"
-- add it
create view sys.dm_pdw_nodes_io_pending_io_requests as
select *, convert(int, null) pdw_node_id from sys.dm_io_pending_io_requests
"
2299	Parse Tree	View	-400	32767	6	4	1	5	9	251	0	1	1024	0	0	0	0	0	1044	"CREATE VIEW sys.allocation_units AS
	SELECT au.auid AS allocation_unit_id,
		au.type,
		ip.name AS type_desc,
		au.ownerid AS container_id,
		convert(int, au.fgid) AS data_space_id,
		isnull(ct.reserved_pages, au.pcreserved) AS total_pages,
		isnull(ct.used_pages, au.pcused) AS used_pages,
		isnull(ct.data_pages, au.pcdata) AS data_pages
	FROM sys.sysallocunits au OUTER APPLY OpenRowset(TABLE ALUCOUNT, au.ownerid, au.type, 0, 0) ct
	LEFT JOIN sys.syspalvalues ip ON ip.class = 'AUTY' AND ip.value = au.type
"
2303	Parse Tree	View	-350827106	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	264	"
-- add it
create view sys.dm_pdw_nodes_os_memory_pools as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_pools
"
2310	Parse Tree	View	-993951361	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	460	"CREATE VIEW sys.indexes$ AS
	SELECT id AS object_id,
		indid AS index_id,
		rowset,
		type
	FROM sys.sysidxstats
	WHERE indid < 256000
	AND (status & 1) = 1 -- IS_INDEX
	AND (status & 0x04000000) = 0 -- !IS_IND_RESUMABLE
"
2316	Parse Tree	View	-979841583	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	450	"
-- add it
create view sys.dm_pdw_diag_processing_stats as
select
	pdw_node_id,
	process_id,
	target_name	collate database_default target_name,
	queue_size,
	lost_events_count
from sys._dm_pdw_diag_processing_stats
"
2331	Parse Tree	View	-595	32767	6	4	1	2	10	187	0	1	1024	0	0	0	0	0	1398	"CREATE VIEW sys.plan_persist_wait_stats_merged AS
	SELECT 
		wait_stats_id,
		runtime_stats_interval_id,
		plan_id,
		wait_category,
		execution_type,
		count_executions,
		total_query_wait_time_ms,
		last_query_wait_time_ms, 
		min_query_wait_time_ms,
		max_query_wait_time_ms,
		sumsquare_query_wait_time_ms
	FROM sys.plan_persist_wait_stats WITH(NOLOCK)
	UNION ALL
	SELECT
		wait_stats_id,
		runtime_stats_interval_id,
		plan_id,
		wait_category,
		execution_type,
		count_executions,
		total_query_wait_time_ms,
		last_query_wait_time_ms, 
		min_query_wait_time_ms,
		max_query_wait_time_ms,
		sumsquare_query_wait_time_ms
	FROM sys.plan_persist_wait_stats_in_memory
"
2332	Parse Tree	View	-226	32767	6	4	1	14	16	251	0	1	1024	0	0	0	0	0	1482	"CREATE VIEW sys.endpoints AS
	SELECT
		e.name, e.id AS endpoint_id,
		o.indepid AS principal_id,
		e.protocol, p.name AS protocol_desc,
		e.type, t.name AS type_desc,
		state = convert(tinyint, bstat & 3),	-- BSTAT_STATEMASK
		s.name AS state_desc,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	WHERE has_access('HE', e.id) = 1
"
2340	Parse Tree	View	-1006059056	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	234	"create view sys.dm_os_server_diagnostics_log_configurations
as
	select *
	from OpenRowset(TABLE DIAGLOG_CONFIGS)
"
2342	Parse Tree	View	-537	32767	6	4	1	13	20	251	0	1	1024	0	0	0	0	0	3428	"CREATE VIEW sys.query_store_plan AS
	SELECT 
		plan_id,
		query_id,
		plan_group_id,
		convert(nvarchar(32), 
		REPLACE(STR((engine_version & 0xff00000000 ) / 0x100000000), ' ', '') + '.'
		+ REPLACE(STR((engine_version & 0xff000000 ) / 0x1000000), ' ', '') + '.'
		+ REPLACE(STR((engine_version & 0xffff00 ) / 0x100), ' ', '') + '.'
		+ REPLACE(STR(engine_version & 0xff), ' ', '')
		) as engine_version,
		compatibility_level,
		query_plan_hash,
		cast(showplanxmldecompress(query_plan) as nvarchar(max)) as query_plan,
		is_online_index_plan,
		is_trivial_plan,
		is_parallel_plan,
		is_forced_plan,
		is_natively_compiled,
		force_failure_count,
		last_force_failure_reason,
		convert(nvarchar(128), CASE last_force_failure_reason
			WHEN 0 THEN N'NONE'
			WHEN NULL THEN N'NONE'
			WHEN 8637 THEN N'ONLINE_INDEX_BUILD'
			WHEN 8683 THEN N'INVALID_STARJOIN'
			WHEN 8684 THEN N'TIME_OUT'
			WHEN 8689 THEN N'NO_DB'
			WHEN 8690 THEN N'HINT_CONFLICT'
			WHEN 8691 THEN N'SETOPT_CONFLICT'
			WHEN 8694 THEN N'DQ_NO_FORCING_SUPPORTED'
			WHEN 8698 THEN N'NO_PLAN'
			WHEN 8712 THEN N'NO_INDEX'
			WHEN 8713 THEN N'VIEW_COMPILE_FAILED'
			ELSE N'GENERAL_FAILURE'
			END) COLLATE Latin1_General_CI_AS_KS_WS as last_force_failure_reason_desc,
		count_compiles,
		initial_compile_start_time,
		last_compile_start_time,
		last_execution_time,
		CASE WHEN count_compiles = 0 THEN NULL ELSE convert(float, total_compile_duration) / count_compiles END as avg_compile_duration,
		last_compile_duration,
		plan_forcing_type,
		p.name as plan_forcing_type_desc
	FROM sys.plan_persist_plan_merged
	LEFT JOIN  sys.syspalvalues p ON p.class = 'PFT' AND p.value = plan_forcing_type
"
2349	Parse Tree	View	-794798515	32767	6	4	1	18	6	251	0	1	1024	0	0	0	0	0	848	"
-- add it
create view sys.dm_pdw_lock_waits as
select
	wait_id,
	session_id	collate database_default session_id,
	type	collate database_default type,
	object_type collate database_default object_type,
	object_name collate database_default object_name,
	request_id	collate database_default request_id,
	request_time,
	acquire_time,
	state	collate database_default state,
	priority
from sys._dm_pdw_lock_waits
"
2353	Parse Tree	View	-479	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	340	"CREATE VIEW sys.column_type_usages AS
	SELECT id AS object_id,
		colid AS column_id,
		utype AS user_type_id
	FROM sys.syscolpars
	WHERE number = 0 AND utype > 256
"
2355	Parse Tree	View	-624118073	32767	6	4	1	10	7	251	0	1	1024	0	0	0	0	0	838	"CREATE VIEW sys.dm_db_xtp_memory_consumers
AS
	SELECT
	memory_consumer_id,
	memory_consumer_type,
	memory_consumer_type_desc,
	memory_consumer_desc,
	object_id,
	xtp_object_id,
	index_id,
	allocated_bytes,
	used_bytes,
	allocation_count,
	partition_count,
	sizeclass_count,
	min_sizeclass,
	max_sizeclass,
	memory_consumer_address
	FROM sys.dm_xtp_consumer_memory_usage
	WHERE database_id = db_id()
"
2356	Parse Tree	View	-178691254	32767	6	4	1	10	5	251	0	1	1024	0	0	0	0	0	842	"
-- add it
create view sys.dm_pdw_component_health_alerts as
select
	pdw_node_id,
	component_id,
	component_instance_id	collate database_default component_instance_id,
	alert_id,
	alert_instance_id	collate database_default alert_instance_id,
	previous_value	collate database_default previous_value,
	current_value	collate database_default current_value,
	create_time
from sys._dm_pdw_component_health_alerts
"
2359	Parse Tree	View	-110446759	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	362	"
-- add it
create view sys.pdw_health_components as
select
	component_id,
	group_id,
	component_name	collate database_default component_name
from sys._pdw_health_components
"
2364	Parse Tree	View	-421	32767	6	4	1	16	16	251	0	1	1024	0	0	0	0	0	1666	"CREATE VIEW sys.service_queues AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		convert(smallint, o.property) AS max_readers,
		convert(nvarchar(776), v.value) COLLATE catalog_default AS activation_procedure,
		e.indepid AS execute_as_principal_id,
		o.is_activation_enabled, o.is_receive_enabled, o.is_enqueue_enabled,
		o.is_retention_enabled, o.is_poison_message_handling_enabled
	FROM sys.objects$ o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 12 AND v.objid = o.object_id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_QUEUEACTIVPROC
	LEFT JOIN sys.syssingleobjrefs e ON e.depid = o.object_id AND e.class = 22 AND e.depsubid = 0 -- SRC_OBJEXECASOWNER
	WHERE o.type = 'SQ'
"
2401	Parse Tree	View	-735915642	32767	6	4	1	3	12	251	0	1	1024	0	0	0	0	0	840	"CREATE VIEW sys.dm_db_mirroring_auto_page_repair AS
	SELECT d.database_id AS database_id,
		p.file_id AS file_id,
		p.page_id AS page_id,
		p.error_type AS error_type,
		p.page_status AS page_status,
		p.modification_time AS modification_time
	FROM sys.databases d CROSS APPLY OpenRowset(TABLE DBMIRROR_AUTO_PAGE_REPAIR, d.database_id) p
	WHERE d.database_id < 0x7fff
		AND has_access('DB', d.database_id) = 1
"
2407	Parse Tree	View	-558	32767	6	4	1	16	12	251	0	1	1024	0	0	0	0	0	1466	"CREATE VIEW sys.security_predicates AS
	SELECT 
		mr.depid as object_id, 
		mr.depsubid as security_predicate_id, 
		mr.indepid as target_object_id, 
		object_definition(mr.depid, mr.depsubid) as predicate_definition,
		convert(int, mr.status % 0x10) as predicate_type,
		v1.name as predicate_type_desc,
		case when convert(int, mr.status / 0x10 % 0x10) = 0 then NULL else convert(int, mr.status / 0x10 % 0x10) end as operation,
		v2.name as operation_desc
	FROM sys.sysmultiobjrefs mr
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'SPT' AND v1.value = (mr.status % 0x10)
	LEFT JOIN sys.syspalvalues v2 ON v2.class = 'SPO' AND v2.value = (mr.status / 0x10 % 0x10)
	WHERE mr.class = 11 AND has_access('CO', mr.depid) = 1
"
2411	Parse Tree	View	-917034300	32767	6	4	1	10	3	251	0	1	1024	0	0	0	0	0	182	"CREATE VIEW sys.dm_xe_map_values AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_MAP_VALUES) 
"
2418	Parse Tree	View	-500	32767	6	4	1	8	4	251	0	1	1024	0	0	0	0	0	368	"CREATE VIEW sys.conversation_priorities AS
	SELECT
		priority_id,
		name,
		service_contract_id,
		local_service_id,
		remote_service_name,
		priority
	FROM sys.syspriorities
"
2429	Parse Tree	View	-442	32767	6	4	1	7	4	251	0	1	1024	0	0	0	0	0	346	"CREATE VIEW sys.service_contracts AS
	SELECT name,
		service_contract_id,
		principal_id
	FROM sys.service_contracts$
	WHERE has_access('SC', service_contract_id) = 1
"
2445	Parse Tree	View	-1016821558	32767	6	4	1	16	5	251	0	1	1024	0	0	0	0	0	858	"CREATE VIEW sys.availability_groups_cluster AS
	SELECT 
		group_id = ags.group_id,
		name = CONVERT(sysname, ags.name),
		resource_id = CAST(ags.resource_id AS nvarchar(40)),
		resource_group_id = CAST(ags.resource_group_id AS nvarchar(40)),
		failure_condition_level,
		health_check_timeout,
		automated_backup_preference,
		automated_backup_preference_desc
	FROM OpenRowset(TABLE DM_AVAILABILITY_GROUPS_CLUSTER) ags
"
2461	Parse Tree	View	-463422670	32767	1	4	1	6	27	251	0	1	1024	0	0	0	0	0	2984	"CREATE VIEW sys.server_audits$ AS
	SELECT
		au.id AS audit_id,
		au.name AS name,
		g.guid AS audit_guid,
		au.created AS create_date,
		au.modified AS modify_date,
		r.indepid AS principal_id,
		au.type AS type,
		n.name AS type_desc,
		convert(tinyint, au.intprop) AS on_failure,
		pv.name AS on_failure_desc,
		sysconv(bit, sysconv (int, au.status) & 0x1) AS is_state_enabled,
		sysconv(int, qd.value) AS queue_delay,
		au.status AS status,
		convert(nvarchar(3000), pd.value) AS predicate
	FROM master.sys.sysclsobjs au
	LEFT JOIN master.sys.sysguidrefs g ON g.class = 5 AND g.id= au.id AND g.subid = 0  -- GRC_AUDITGUID
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = au.id AND r.class = 69 AND r.depsubid = 0	-- SRC_AUDITOWNER
	LEFT JOIN master.sys.sysobjvalues qd ON qd.valclass = 38 AND qd.objid = au.id AND qd.subobjid = 0 AND qd.valnum = 1 -- SVC_AUDITPROPS/AUDIT_QUEUE_DELAY
	LEFT JOIN master.sys.sysobjvalues pd ON pd.valclass = 38 AND pd.objid = au.id AND pd.subobjid = 0 AND pd.valnum = 2 -- SVC_AUDITPROPS/AUDIT_PREDICATE	
	LEFT JOIN sys.sysobjvalues rd ON rd.valclass = 38 AND rd.objid = au.id AND rd.subobjid = 0 AND rd.valnum = 10  		-- SVC_AUDITPROPS/AUDIT_SCOPE	
	LEFT JOIN sys.syspalnames n ON n.class = 'AULT' AND n.value = au.type
	LEFT JOIN sys.syspalvalues pv ON pv.class = 'AUSD' AND pv.value = au.intprop
	WHERE au.class = 64 -- SOC_SECAUDIT
		AND (rd.value IS NULL OR rd.value = 16723) -- server scope audit
		AND has_access('SA', 0) = 1
"
2462	Parse Tree	View	-268	32767	6	4	1	5	10	251	0	1	1024	0	0	0	0	0	1872	"CREATE VIEW sys.resource_governor_external_resource_pools
AS
    -- ISSUE - VSTS 83011
    -- Use isnull() below because Algebrizer doesn't properly
    -- determine these columns are non-nullable.
    SELECT
        external_pool_id             = co.id,
        name                = co.name,
        max_cpu_percent     = isnull((co.status/0x100)     % 0x100, 0),
        max_memory_percent  = isnull((co.status/0x1000000) % 0x100, 0),
        max_processes     = isnull( convert(int,co.intprop), 0),
        version = isnull(convert(bigint, ov.value), 0)
    FROM
        master.sys.sysclsobjs co LEFT JOIN
        master.sys.sysobjvalues ov ON
        (
            co.id = ov.objid AND
            ov.valclass = 125 AND -- SVC_RG_EXTERNAL_POOL
            ov.subobjid = 0 AND
            ov.valnum = 1
        )
    WHERE 
        co.class = 104 AND -- SOC_RG_EXTERNAL_POOL
        has_access('RG', 0) = 1 
"
2473	Parse Tree	View	-210	32767	6	4	1	36	10	251	0	1	1024	0	0	0	0	0	986	"CREATE VIEW sys.sysprocesses AS
	SELECT 
	spid,
	kpid,
	blocked,
	waittype,
	waittime,
	lastwaittype,
	waitresource,
	dbid,
	uid = convert(smallint, uid),
	cpu,
	physical_io,
	memusage,
	login_time,
	last_batch,
	ecid,
	open_tran,
	status,
	sid,
	hostname,
	program_name,
	hostprocess,
	cmd,
	nt_domain,
	nt_username,
	net_address,
	net_library,
	loginame,
	context_info,
	sql_handle,
	stmt_start,
	stmt_end,
	request_id
	FROM OpenRowSet(TABLE SYSPROCESSES)
"
2479	Compiled Plan	Adhoc	214481994	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	136	SELECT t.* FROM sys.dm_db_column_store_row_group_operational_stats t
2483	Parse Tree	View	-521	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	386	"create VIEW sys.tempstatvals
    AS
    SELECT  *
    FROM    tempdb.sys.sysobjvalues o
    WHERE   o.valclass = 54 AND  --ESystemValueClass::SVC_TEMPSTATS
            o.objid = db_id() 
"
2489	Parse Tree	View	-798907980	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	300	"
-- add it
create view sys.dm_pdw_nodes_io_cluster_shared_drives as
select *, convert(int, null) pdw_node_id from sys.dm_io_cluster_shared_drives
"
2489	Parse Tree	View	-790906329	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	280	"
-- add it
create view sys.dm_pdw_nodes_os_dispatcher_pools as
select *, convert(int, null) pdw_node_id from sys.dm_os_dispatcher_pools
"
2489	Parse Tree	View	-290809846	32767	6	4	1	19	6	251	0	1	1024	0	0	0	0	0	256	"CREATE VIEW sys.dm_tran_global_transactions_enlistments AS
	SELECT *
	FROM OpenRowset(TABLE GLOBAL_TRANSACTIONS_ENLISTMENTS)
"
2494	Parse Tree	View	-463	32767	6	4	1	2	8	251	0	1	1024	0	0	0	0	0	864	"CREATE VIEW sys.xml_schema_collections AS
	SELECT xml_collection_id = s.id,
		schema_id = s.nsid,
		principal_id = r.indepid,
		name = s.name,
		create_date = s.created,
		modify_date = s.modified
	FROM sys.sysnsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 59 AND r.depsubid = 0	-- SRC_XSDCOLTOOWNER
	WHERE s.class = 27	-- SOC_XSDCOLLECTION
		AND (s.nsid = 4 OR has_access('XC', 0, s.id) = 1)
"
2502	Compiled Plan	Adhoc	230492266	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.plan_guides t
2505	Parse Tree	View	-405	32767	6	4	1	2	8	251	0	1	1024	0	0	0	0	0	1476	"CREATE VIEW sys.fulltext_index_columns AS
	SELECT object_id = objid,
		column_id = subobjid,
		type_column_id = 
			CASE convert(int, convert(varbinary, convert(bigint, value) % 0x100000000)) -- The bottom 4 bytes of value are the type_column_id
				WHEN convert(int, 0xffffffff) THEN NULL -- for back compat return NULL if the column id is bad (0xffffffff)
				ELSE convert(int, convert(varbinary, convert(bigint, value) % 0x100000000))
			END,
		language_id = valnum,
		statistical_semantics = 
			CASE 
				WHEN (convert(bigint, value) & 0x100000000) > 0 THEN 1 -- check for the semantic_statistic bit
				ELSE 0
			END
	FROM sys.sysobjvalues
	WHERE valclass = 42	-- SVC_FULLTEXT_COL	
	AND has_access('CO', objid) = 1
"
2505	Parse Tree	View	-405	32767	1	4	1	2	8	251	0	1	1024	0	0	0	0	0	1476	"CREATE VIEW sys.fulltext_index_columns AS
	SELECT object_id = objid,
		column_id = subobjid,
		type_column_id = 
			CASE convert(int, convert(varbinary, convert(bigint, value) % 0x100000000)) -- The bottom 4 bytes of value are the type_column_id
				WHEN convert(int, 0xffffffff) THEN NULL -- for back compat return NULL if the column id is bad (0xffffffff)
				ELSE convert(int, convert(varbinary, convert(bigint, value) % 0x100000000))
			END,
		language_id = valnum,
		statistical_semantics = 
			CASE 
				WHEN (convert(bigint, value) & 0x100000000) > 0 THEN 1 -- check for the semantic_statistic bit
				ELSE 0
			END
	FROM sys.sysobjvalues
	WHERE valclass = 42	-- SVC_FULLTEXT_COL	
	AND has_access('CO', objid) = 1
"
2508	Parse Tree	View	-489165464	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	180	"CREATE VIEW sys.dm_os_sys_memory AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_SYS_MEMORY)
"
2520	Parse Tree	View	-522168041	32767	6	4	1	8	7	251	0	1	1024	0	0	0	0	0	272	"
-- add it
create view sys.dm_pdw_nodes_os_memory_objects as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_objects
"
2527	Compiled Plan	Adhoc	434291448	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_xtp_system_memory_consumers t
2535	Parse Tree	View	-12883407	32767	6	4	1	11	11	251	0	1	1024	0	0	0	0	0	200	"CREATE VIEW sys.dm_db_xtp_transactions 
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_TRANSACTIONS)
"
2538	Parse Tree	View	-408306563	32767	6	4	1	18	6	251	0	1	1024	0	0	0	0	0	800	"
-- add it
create view sys.dm_pdw_errors as
select
	error_id	collate database_default error_id,
	source	collate database_default source,
	type	collate database_default type,
	create_time,
	pdw_node_id,
	session_id	collate database_default session_id,
	request_id	collate database_default request_id,
	spid,
	thread_id,
	details	collate database_default details
from sys._dm_pdw_errors
"
2538	Parse Tree	View	-231	32767	6	4	1	22	24	251	0	1	1024	0	0	0	0	0	2894	"CREATE VIEW sys.service_broker_endpoints AS
	SELECT
		e.name,
		endpoint_id = e.id,
		principal_id = o.indepid,
		e.protocol,
		protocol_desc = p.name,
		e.type,
		type_desc = t.name,
		state = convert(tinyint, e.bstat & 3),	-- BSTAT_STATEMASK
		state_desc = s.name,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		is_message_forwarding_enabled = sysconv(bit, e.tstat & 1),	-- TSTAT_SSB_MSGFWD
		message_forwarding_size = e.typeint,
		-- Authentication and encryption options. Identical in SSB and DBM endpoints
		connection_auth = e.authtype,		
		connection_auth_desc = ca.name,
		certificate_id = ISNULL(co.indepid, 0),
		encryption_algorithm = e.encalg,
		encryption_algorithm_desc = ag.name
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	LEFT JOIN sys.syspalvalues ca ON ca.class = 'EPCA' AND ca.value = e.authtype
	LEFT JOIN sys.syspalvalues ag ON ag.class = 'EPCE' AND ag.value = e.encalg
	LEFT JOIN sys.syssingleobjrefs co ON co.class = 25 and co.depid = e.id  AND co.depsubid = 0 -- SRC_ENDPT_CERTIFICATE
	WHERE e.type = 3
		AND has_access('HE', e.id) = 1
"
2548	Parse Tree	View	-542	32767	6	4	1	2	9	187	0	1	1024	0	0	0	0	0	1556	"CREATE VIEW sys.plan_persist_plan_in_memory AS
	SELECT
		plan_id,
		query_id,
		plan_group_id,
		engine_version,
		query_plan_hash,
		query_plan,
		is_online_index_plan,
		is_trivial_plan,
		is_parallel_plan,
		is_forced_plan,		
		CASE WHEN is_forced_plan = 1 AND convert(bit, plan_flags & 0x02) = 0 THEN 1
			 WHEN is_forced_plan = 1 AND convert(bit, plan_flags & 0x02) = 1 THEN 2
			 ELSE 0
		END as plan_forcing_type,
		convert(bit, plan_flags & 0x01) as is_natively_compiled,
		force_failure_count,
		last_force_failure_reason,
		count_compiles,
		initial_compile_start_time,
		last_compile_start_time,
		last_execution_time,
		total_compile_duration,
		last_compile_duration,
		compatibility_level
	FROM OpenRowset(TABLE QUERY_STORE_PLAN_IN_MEM)
"
2552	Parse Tree	View	-988643485	32767	6	4	1	11	5	251	0	1	1024	0	0	0	0	0	706	"
-- add it
create view sys.dm_pdw_os_event_logs as
select
	pdw_node_id,
	log_name	collate database_default log_name,
	log_source	collate database_default log_source,
	event_id,
	event_type	collate database_default event_type,
	event_message	collate database_default event_message,
	generate_time,
	write_time
from sys._dm_pdw_os_event_logs
"
2554	Parse Tree	View	-575624558	32767	6	4	1	5	7	251	0	1	1024	0	0	0	0	0	546	"CREATE VIEW sys.system_components_surface_area_configuration AS
	SELECT s.component_name, s.database_name, s.schema_name,
		s.object_name, s.state, s.type, p.name AS type_desc
	FROM sys.sac_state s
	LEFT JOIN sys.syspalnames p ON p.class = 'OBTY' AND p.value = s.type
"
2559	Parse Tree	View	-484	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	364	"CREATE VIEW sys.module_assembly_usages AS
	SELECT depid AS object_id,
		indepid AS assembly_id
	FROM sys.syssingleobjrefs
	WHERE class = 11 AND depsubid = 0 	-- SRC_MODULETOASM
"
2561	Parse Tree	View	-716703541	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	332	"
-- add it
create view sys.pdw_database_mappings as
select
	database_id,
	physical_name	collate database_default physical_name
from sys._pdw_database_mappings
"
2561	Parse Tree	View	-189344319	32767	6	4	1	3	12	251	0	1	1024	0	0	0	0	0	1152	"CREATE VIEW sys.service_message_types$ AS
	SELECT o.name,
		o.id AS message_type_id,
		p.indepid AS principal_id,
		o.type AS validation,
		v.name AS validation_desc,
		xml_collection_id = r.indepid
	FROM sys.sysbinobjs o
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 92 AND r.depsubid = 0	-- SRC_MSGTYPE_XSDTYPE
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 53 AND p.depsubid = 0	-- SRC_MSGTYPEOWNER
	LEFT JOIN sys.sysbinpals v ON v.class = 'SMVA' AND v.value = o.type
	WHERE o.class = 21 AND o.nsid = 0	-- SOC_MESSAGETYPE
"
2564	Parse Tree	View	-948333171	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	192	"CREATE VIEW sys.dm_qn_subscriptions AS
	SELECT *
	FROM OpenRowSet(TABLE SYSNOTIFICATIONSUBS)
"
2570	Parse Tree	View	-426	32767	6	4	1	34	23	251	0	1	1024	0	0	0	0	0	3516	"CREATE VIEW sys.database_principals AS
	SELECT u.name,
		u.id AS principal_id,
		u.type,
		n.name AS type_desc,
		u.dfltsch AS default_schema_name,
		u.created AS create_date,
		u.modified AS modify_date,
		r.indepid AS owning_principal_id,
		u.sid,
		sysconv(bit, case when u.id >= 16384 and u.id < 16400 then 1 else 0 end) AS is_fixed_role,
		u.authentication_type,
		aty.name AS authentication_type_desc,
		u.deflanguage as default_language_name,
		l.lcid as default_language_lcid,
		sysconv(bit, IIF(u.status & 0x20 = 0x20, 1, 0)) as allow_encrypted_value_modifications
	FROM (
		SELECT *,
			CASE 
				-- Guest is always authentication type none
				WHEN type = 'S' AND id = 2 THEN 0
				-- Users without password and without SQL SID prefix are instance auth
				WHEN type = 'S' AND password IS NULL AND cast(sid as binary(9)) <> 0x010500000000000903 THEN 1
				-- Users with passwords are database auth
				WHEN type = 'S' AND password IS NOT NULL THEN 2
				-- Windows users are always windows auth
				WHEN type = 'U' OR type = 'G' THEN 3
				-- External Users or External Groups
				WHEN type = 'E' OR type = 'X' THEN 4
				-- Users without passwords, certificate, key users, etc. have no authentication type
				ELSE 0
			END AS authentication_type
		FROM sys.sysowners) u
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = u.id AND r.class = 51 AND r.depsubid = 0	-- SRC_ROLEOWNER
	LEFT JOIN sys.syspalnames n ON n.class = 'USTY' AND n.value = u.type
	LEFT JOIN sys.syspalnames aty ON aty.class = 'DBAT' AND aty.value = u.authentication_type
	LEFT JOIN sys.syslanguages l ON u.deflanguage COLLATE catalog_default = l.name COLLATE catalog_default
	WHERE u.type <> 'L'
		AND has_access('US', u.id) = 1	-- PR_ALIAS
"
2601	Parse Tree	View	-238938091	32767	6	4	1	25	6	251	0	1	1024	0	0	0	0	0	174	"CREATE VIEW sys.dm_io_backup_tapes AS
	SELECT *
	FROM OpenRowset(TABLE TAPE_STATUS)
"
2603	Parse Tree	View	-252	32767	6	4	1	16	16	251	0	1	1024	0	0	0	0	0	2576	"CREATE VIEW sys.server_event_sessions AS
	SELECT 
		event_session_id			= c.id,
		name						= convert(sysname, c.name) collate catalog_default,
		event_retention_mode		= char(v2.subobjid), -- EMDXEEventRetention
		event_retention_mode_desc	= xeer.name collate catalog_default,
		max_dispatch_latency		= convert(INT, v1.value),
		max_memory					= v1.subobjid,
		max_event_size				= v1.valnum,
		memory_partition_mode		= char(v2.valnum), -- EMDXEMemoryPartition
		memory_partition_mode_desc	= xemp.name collate catalog_default,
		track_causality				= convert(bit, c.status & 1), -- XE_SESSION_STATUS_BIT_CAUSALITY
		startup_state				= convert(bit, c.status & 2)  -- XE_SESSION_STATUS_BIT_AUTOSTART
	FROM master.sys.sysclsobjs c
	LEFT JOIN master.sys.sysobjvalues v1 ON
		v1.valclass = 90 AND	-- SVC_XE_SESSION_PROP_1
		v1.objid = c.id
	LEFT JOIN master.sys.sysobjvalues v2 ON
		v2.valclass = 91 AND	-- SVC_XE_SESSION_PROP_2
		v2.objid = c.id
	LEFT JOIN sys.syspalnames xeer ON xeer.class = 'XEER' AND xeer.value = char(v2.subobjid)
	LEFT JOIN sys.syspalnames xemp ON xemp.class = 'XEMP' AND xemp.value = char(v2.valnum)
	WHERE c.class = 62			-- SOC_XESESSION
	AND convert(bit, c.status & 4) = 0 	-- filter out database scoped sessions	
	AND has_access ('ES', 0) = 1
"
2606	Compiled Plan	Adhoc	543349327	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.partition_schemes t
2607	Parse Tree	View	-828746209	32767	6	4	1	8	3	251	0	1	1024	0	0	0	0	0	218	"CREATE VIEW sys.dm_clr_properties AS
	SELECT
		name,
		value
	FROM OpenRowset(TABLE DM_CLR_PROPERTIES) 
"
2607	Parse Tree	View	-1040075447	32767	6	4	1	14	3	251	0	1	1024	0	0	0	0	0	216	"CREATE VIEW sys.dm_db_mirroring_past_actions AS
	SELECT * 
	FROM OpenRowSet(TABLE DBMIRROR_PAST_ACTIONS)
"
2613	Parse Tree	View	-563	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	552	"CREATE VIEW sys.column_encryption_keys AS
	SELECT sc.name as name, 
		sc.id as column_encryption_key_id,
		sc.created AS create_date,
		sc.modified AS modify_date
	FROM sys.sysclsobjs sc
	WHERE sc.class = 102 -- SOC_COLENCRYPTIONKEY
	AND has_access('CK', DB_ID()) = 1
"
2614	Parse Tree	View	-194	32767	1	4	1	9	14	251	0	1	1024	0	0	0	0	0	1566	"CREATE VIEW sys.syslanguages AS
	SELECT langid, dateformat, datefirst,
		convert(int, 0) AS upgrade,
		name, alias,
		convert(nvarchar(372), month1+N',' COLLATE catalog_default +month2+N','+month3+N','+month4+N','+month5+N','+month6
			+N','+month7+N','+month8+N','+month9+N','+month10+N','+month11+N','+month12) AS months,
		convert(nvarchar(132), shortmonth1+N',' COLLATE catalog_default +shortmonth2+N','+shortmonth3+N','+shortmonth4+N','+shortmonth5+N','+shortmonth6
			+N','+shortmonth7+N','+shortmonth8+N','+shortmonth9+N','+shortmonth10+N','+shortmonth11+N','+shortmonth12) AS shortmonths,
		convert(nvarchar(217), day2+N',' COLLATE catalog_default +day3+N','+day4+N','+day5+N','+day6+N','+day7+N','+day1) AS days,
		lcid, msglangid
	FROM OpenRowset(TABLE SYSLANG)
"
2614	Parse Tree	View	-194	32767	6	4	1	12	14	251	0	1	1024	0	0	0	0	0	1566	"CREATE VIEW sys.syslanguages AS
	SELECT langid, dateformat, datefirst,
		convert(int, 0) AS upgrade,
		name, alias,
		convert(nvarchar(372), month1+N',' COLLATE catalog_default +month2+N','+month3+N','+month4+N','+month5+N','+month6
			+N','+month7+N','+month8+N','+month9+N','+month10+N','+month11+N','+month12) AS months,
		convert(nvarchar(132), shortmonth1+N',' COLLATE catalog_default +shortmonth2+N','+shortmonth3+N','+shortmonth4+N','+shortmonth5+N','+shortmonth6
			+N','+shortmonth7+N','+shortmonth8+N','+shortmonth9+N','+shortmonth10+N','+shortmonth11+N','+shortmonth12) AS shortmonths,
		convert(nvarchar(217), day2+N',' COLLATE catalog_default +day3+N','+day4+N','+day5+N','+day6+N','+day7+N','+day1) AS days,
		lcid, msglangid
	FROM OpenRowset(TABLE SYSLANG)
"
2624	Parse Tree	View	-505	32767	6	4	1	8	8	251	0	1	1024	0	0	0	0	0	780	"CREATE VIEW sys.fulltext_stopwords AS
	SELECT 
		fts.stoplistid AS stoplist_id,
		fts.stopword,
		ftl.name AS language,
		language_id = fts.lcid
	FROM sys.sysftstops fts
	JOIN sys.fulltext_languages ftl ON fts.lcid = ftl.lcid
	JOIN sys.sysclsobjs sc ON fts.stoplistid = sc.id and sc.class = 33 and has_access ('FS', sc.id) = 1 -- join to filter stoplist according to has_access() 
"
2629	Parse Tree	View	-233577667	32767	6	4	1	16	15	251	0	1	1024	0	0	0	0	0	3666	"CREATE view sys.dm_hadr_database_replica_states
as
	SELECT 
		drs.database_id as database_id,
		drs.group_id as group_id,
		drs.replica_id as replica_id,
		drs.group_database_id as group_database_id,
		drs.is_local as is_local,
		drs.is_primary_replica as is_primary_replica,
		drs.synchronization_state as synchronization_state,
		drs.synchronization_state_desc as synchronization_state_desc,
		drs.is_commit_participant as is_commit_participant,
		drs.synchronization_health as synchronization_health,
		drs.synchronization_health_desc as synchronization_health_desc,
		drs.database_state as database_state,
		st.name as database_state_desc,
		drs.is_suspended as is_suspended,
		drs.suspend_reason as suspend_reason,
		drs.suspend_reason_desc as suspend_reason_desc,
		drs.recovery_lsn as recovery_lsn,
		drs.truncation_lsn as truncation_lsn,
		drs.last_sent_lsn as last_sent_lsn,
		drs.last_sent_time as last_sent_time,
		drs.last_received_lsn as last_received_lsn,
		drs.last_received_time as last_received_time,
		drs.last_hardened_lsn as last_hardened_lsn,
		drs.last_hardened_time as last_hardened_time,
		drs.last_redone_lsn as last_redone_lsn,
		drs.last_redone_time as last_redone_time,
		drs.log_send_queue_size as log_send_queue_size,
		drs.log_send_rate as log_send_rate,
		drs.redo_queue_size as redo_queue_size,
		drs.redo_rate as redo_rate,
		drs.filestream_send_rate as filestream_send_rate,
		drs.end_of_log_lsn as end_of_log_lsn,
		drs.last_commit_lsn as last_commit_lsn,
		drs.last_commit_time as last_commit_time,
		drs.ghost_cleanup_fence as low_water_mark_for_ghosts,
		drs.secondary_lag_seconds as secondary_lag_seconds
	FROM OpenRowset(TABLE DM_HADR_DATABASE_REPLICA_STATES) drs
		LEFT JOIN sys.syspalvalues st ON st.class = 'DBST' AND st.value = drs.database_state
"
2634	Parse Tree	View	-595068698	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	220	"
CREATE VIEW sys.dm_db_rda_migration_status
AS
SELECT * FROM OpenRowset(TABLE DM_DB_RDA_MIGRATION_STATUS)
"
2635	Parse Tree	View	-447	32767	6	4	1	15	14	251	0	1	1024	0	0	0	0	0	1854	"CREATE VIEW sys.conversation_endpoints AS
	SELECT ce.conversation_handle,
		ce.conversation_id,
		ce.is_initiator,
		ce.service_contract_id,
		ce.conversation_group_id,
		ce.service_id,
		ce.lifetime,
		ce.state,
		ce.state_desc,
		ce.far_service,
		ce.far_broker_instance,
		ce.principal_id,
		ce.far_principal_id,
		ce.outbound_session_key_identifier,
		ce.inbound_session_key_identifier,
		ce.security_timestamp,
		ce.dialog_timer,
		ce.send_sequence,
		ce.last_send_tran_id,
		ce.end_dialog_sequence,
		ce.receive_sequence,
		ce.receive_sequence_frag,
		ce.system_sequence,
		ce.first_out_of_order_sequence,
		ce.last_out_of_order_sequence,
		ce.last_out_of_order_frag,
		ce.is_system,
		ce.priority
	FROM sys.conversation_endpoints$ ce
	LEFT JOIN sys.syssingleobjrefs f ON f.depid = ce.service_id AND f.class = 21 AND f.depsubid = 0 -- SRC_SVCTOQUEUE
	WHERE has_access('CO', f.indepid) = 1
"
2641	Parse Tree	View	-50028427	32767	6	4	1	11	5	251	0	1	1024	0	0	0	0	0	474	"CREATE VIEW sys.spatial_reference_systems AS
SELECT
	spatial_reference_id, 
	authority_name,
	authorized_spatial_reference_id,
	well_known_text,
	unit_of_measure,
	unit_conversion_factor
FROM	sys.spatial_reference_systems_tvf()
"
2646	Parse Tree	View	-389	32767	6	4	1	12	9	251	0	1	1024	0	0	0	0	0	1034	"CREATE VIEW sys.system_objects AS
	SELECT o.name,
		o.id AS object_id,
		convert(int, null) AS principal_id,
		o.nsid AS schema_id,
		convert(int, 0) AS parent_object_id,
		o.type,
		n.name AS type_desc,
		o.created AS create_date,
		o.modified AS modify_date,
		convert(bit, 1) AS is_ms_shipped,
		convert(bit, 0) AS is_published,
		convert(bit, 0) AS is_schema_published
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	WHERE has_access('SO', o.id) = 1
"
2669	Parse Tree	View	-15918666	32767	6	4	1	16	4	251	0	1	1024	0	0	0	0	0	170	"CREATE VIEW sys.dm_xe_objects AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_OBJECTS) 
"
2679	Parse Tree	View	-215	32767	1	4	1	1	9	251	0	1	1024	0	0	0	0	0	910	"CREATE VIEW sys.backup_devices AS
	SELECT o.name,
		convert(tinyint, o.intprop) AS type,
		i.name AS type_desc,
		convert(nvarchar(260),v.value) AS physical_name
	FROM master.sys.sysclsobjs o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 55 AND v.objid = o.id AND v.subobjid = 0 and v.valnum = 1	-- SVC_BACKUPDEVICE:VALNUM_PHYSNAME
	LEFT JOIN sys.syspalvalues i ON i.class = 'BDTY' AND i.value = o.intprop
	WHERE o.class = 55	-- SOC_BACKUPDEVICE
"
2679	Parse Tree	View	-215	32767	6	4	1	12	9	251	0	1	1024	0	0	0	0	0	910	"CREATE VIEW sys.backup_devices AS
	SELECT o.name,
		convert(tinyint, o.intprop) AS type,
		i.name AS type_desc,
		convert(nvarchar(260),v.value) AS physical_name
	FROM master.sys.sysclsobjs o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 55 AND v.objid = o.id AND v.subobjid = 0 and v.valnum = 1	-- SVC_BACKUPDEVICE:VALNUM_PHYSNAME
	LEFT JOIN sys.syspalvalues i ON i.class = 'BDTY' AND i.value = o.intprop
	WHERE o.class = 55	-- SOC_BACKUPDEVICE
"
2683	Parse Tree	View	-47309357	32767	6	4	1	7	8	251	0	1	1024	0	0	0	0	0	292	"
-- add it
create view sys.pdw_nodes_indexes as
select *, convert(int, null) pdw_node_id, convert(int, null) distribution_id from sys.indexes
"
2691	Parse Tree	View	-814173984	32767	6	4	1	2	10	251	0	1	1024	0	0	0	0	0	1268	"CREATE VIEW sys.dm_exec_query_memory_grants AS
	SELECT A.session_id, A.request_id, A.scheduler_id, A.dop, A.request_time, A.grant_time,
	A.requested_memory_kb, A.granted_memory_kb, A.required_memory_kb, A.used_memory_kb, A.max_used_memory_kb,
	A.query_cost, A.timeout_sec,
	convert(smallint, A.is_small) as resource_semaphore_id, 
	A.queue_id, A.wait_order, A.is_next_candidate, A.wait_time_ms,
	A.plan_handle, A.sql_handle,
	A.group_id, A.pool_id, A.is_small, A.ideal_memory_kb,
	A.reserved_worker_count, A.used_worker_count, A.max_used_worker_count, A.reserved_node_bitmap
	FROM OpenRowset(TABLE DM_EXEC_QE_GRANTSINFO) A 
"
2700	Parse Tree	View	-468	32767	6	4	1	17	20	251	0	1	1024	0	0	0	0	0	2536	"CREATE VIEW sys.internal_tables AS
	SELECT o.name, o.id AS object_id, convert(int, null) AS principal_id, o.nsid AS schema_id, o.pid AS parent_object_id,
		o.type, n.name AS type_desc, o.created AS create_date, o.modified AS modify_date,
		convert(bit, 0) AS is_ms_shipped, convert(bit, 0) AS is_published, convert(bit, 0) AS is_schema_published,
		convert(tinyint, par.depsubid) AS internal_type,
		itt.name AS internal_type_desc,
		par.indepid AS parent_id,
		par.indepsubid AS parent_minor_id,
		isnull(ds.indepid, 0) AS lob_data_space_id,
		rfs.indepid AS filestream_data_space_id
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	LEFT JOIN sys.syssingleobjrefs par ON par.depid = o.id AND par.class = 40	 -- SRC_INTLTAB_PARENT
	LEFT JOIN sys.syspalvalues itt ON itt.class = 'ITTY' AND itt.value = par.depsubid
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = o.id AND ds.class = 8 AND ds.depsubid <= 1	-- SRC_INDEXTOLOBDS	
	LEFT JOIN sys.syssingleobjrefs rfs ON rfs.depid = o.id AND rfs.class = 42 AND rfs.depsubid = 0	-- SRC_OBJTOFSDS
	WHERE o.nsclass = 0 -- x_eonc_Standard
		AND o.nsid = 4 AND o.pclass = 1 AND o.type = 'IT' -- x_eunc_Object
		AND has_access('IT', par.indepid, par.depsubid) = 1
"
2703	Parse Tree	View	-515628953	32767	6	4	1	8	22	251	0	1	1024	0	0	0	0	0	2620	"CREATE VIEW sys.dm_exec_function_stats AS
	SELECT 
		database_id,
		object_id,
		type,
		n.name AS type_desc,
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,	
		max_worker_time,
		total_physical_reads,
		last_physical_reads,
		min_physical_reads,
		max_physical_reads,
		total_logical_writes,
		last_logical_writes,
		min_logical_writes,
		max_logical_writes,
		total_logical_reads,
		last_logical_reads,
		min_logical_reads,
		max_logical_reads,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time
	FROM OpenRowset (TABLE FUNCTION_STATS) o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' 
		AND n.value = o.type
	UNION ALL
	SELECT 
		database_id,
		object_id,
		CAST ('FN' AS CHAR(2)),
		CAST ('SQL_SCALAR_FUNCTION' AS NVARCHAR(60)),
		sql_handle,
		plan_handle,
		cached_time,
		last_execution_time,
		execution_count,
		total_worker_time,
		last_worker_time,
		min_worker_time,
		max_worker_time,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		0,
		total_elapsed_time,
		last_elapsed_time,
		min_elapsed_time,
		max_elapsed_time
	FROM OpenRowset (TABLE XTP_PROC_STATS, ASCII('F') + (ASCII('N') * 256))
"
2707	Parse Tree	View	-717553525	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	196	"CREATE VIEW sys.dm_db_xtp_object_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_TABLE_STATS)
"
2709	Parse Tree	View	-465074339	32767	6	4	1	11	4	251	0	1	1024	0	0	0	0	0	188	"CREATE VIEW sys.dm_tcp_listener_states AS
	SELECT *
	FROM OpenRowset(TABLE SYSTCPLISTENER)
"
2711	Parse Tree	View	-410	32767	6	4	1	5	8	187	0	1	1024	0	0	0	0	0	986	"CREATE VIEW sys.foreign_key_columns AS
	SELECT constraint_object_id = p.depid,
		constraint_column_id = p.depsubid,
		parent_object_id = p.indepid,
		parent_column_id = p.indepsubid,
		referenced_object_id = r.indepid,
		referenced_column_id = r.indepsubid
	FROM sys.syssingleobjrefs p
	JOIN sys.syssingleobjrefs r ON r.depid = p.depid AND r.class = 29 AND r.depsubid = p.depsubid	-- SRC_FK_REFERD_COL
	WHERE p.class = 28 	-- SRC_FK_PARENT_COL
		AND has_access('CO', p.indepid) = 1
"
2712	Parse Tree	View	-968503520	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	184	"CREATE view sys.dm_fts_outstanding_batches
AS
	SELECT * FROM OpenRowset(TABLE FTBATCHES)
"
2715	Parse Tree	View	-629792996	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	700	"CREATE VIEW sys.dm_hadr_auto_page_repair AS
	SELECT database_id AS database_id,
		file_id AS file_id,
		page_id AS page_id,
		error_type AS error_type,
		page_status AS page_status,
		modification_time AS modification_time
	FROM OpenRowset(TABLE DM_HADR_AUTO_PAGE_REPAIR)
	WHERE database_id < 0x7fff
		AND has_access('DB', database_id) = 1
"
2726	Parse Tree	View	-824946312	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	180	"CREATE VIEW sys.dm_os_sublatches AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_SUBLATCHES)
"
2736	Parse Tree	View	1787153412	1	1	1	1	12	4	251	0	1	1024	0	0	0	0	0	336	"
create view spt_values as
select name collate database_default as name,
	number,
	type collate database_default as type,
	low, high, status
from sys.spt_values
"
2744	Parse Tree	View	-236	32767	6	4	1	16	12	251	0	1	1024	0	0	0	0	0	1436	"CREATE VIEW sys.server_triggers AS
	SELECT o.name,
		object_id = o.id,
		parent_class = o.pclass,
		parent_class_desc = pc.name,
		parent_id = o.pid,
		type = o.type,
		type_desc = n.name,
		create_date = o.created,
		modify_date = o.modified,
		is_ms_shipped = sysconv(bit, o.status & 1),		-- OBJALL_MSSHIPPED
		is_disabled = sysconv(bit, o.status & 256) 		-- OBJTRG_DISABLED
	FROM sys.sysschobjs$ o
	LEFT JOIN sys.syspalnames n ON n.class = 'OBTY' AND n.value = o.type
	LEFT JOIN sys.syspalvalues pc ON pc.class = 'UNCL' AND pc.value = o.pclass
	WHERE o.type IN ('TA','TR') AND o.nsclass = 20 AND o.pclass = 100	-- x_eonc_TrgOnServer:x_eunc_Server
		AND has_access('TR', o.id, o.pid, o.nsclass) = 1
"
2752	Parse Tree	View	-334110873	32767	6	4	1	2	9	251	0	1	1024	0	0	0	0	0	1032	"CREATE VIEW sys.dm_db_index_usage_stats AS
	SELECT database_id, object_id, index_id, 
		user_seeks, user_scans, user_lookups, user_updates, 
		last_user_seek, last_user_scan, last_user_lookup, last_user_update,
		system_seeks, system_scans, system_lookups, system_updates, 
		last_system_seek, last_system_scan, last_system_lookup, last_system_update
		FROM OpenRowSet(TABLE LOGINDEXSTATS)

	-- Hiding Hekaton tables
	WHERE status = 0 and ISNULL(OBJECTPROPERTY(object_id, 'TableIsMemoryOptimized'), 0) = 0
"
2752	Parse Tree	View	-568248614	32767	6	4	1	3	12	251	0	1	1024	0	0	0	0	0	3520	"CREATE VIEW sys.dm_hadr_internal_availability_replica_states AS
	SELECT
		replica_id = IntArStates.replica_id,
		group_id = IntArStates.group_id,
		is_local = IntArStates.is_local,
		role = IntArStates.role,
		role_desc = CASE
			WHEN (role = 0) THEN CAST ('RESOLVING' as nvarchar(60))
			WHEN (role = 1) THEN CAST ('PRIMARY' as nvarchar(60))
			WHEN (role = 2) THEN CAST ('SECONDARY' as nvarchar(60))
			WHEN (role = 3) THEN CAST ('FORWARDER' as nvarchar(60))
			WHEN (role = 4) THEN CAST ('INVALID' as nvarchar(60))
			ELSE CAST (NULL AS nvarchar(60)) END,
		operational_state,
		operational_state_desc = CASE
			WHEN (operational_state = 0) THEN CAST ('PENDING_FAILOVER' AS nvarchar(60))
			WHEN (operational_state = 1) THEN CAST ('PENDING' AS nvarchar(60))
			WHEN (operational_state = 2) THEN CAST ('ONLINE' AS nvarchar(60))
			WHEN (operational_state = 3) THEN CAST ('OFFLINE' AS nvarchar(60))
			WHEN (operational_state = 4) THEN CAST ('FAILED' AS nvarchar(60))
			WHEN (operational_state = 5) THEN CAST ('FAILED_NO_QUORUM' AS nvarchar(60))
			WHEN (operational_state = 6) THEN CAST ('INVALID' AS nvarchar(60))
			ELSE CAST (NULL AS nvarchar(60)) END,
		connected_state,
		connected_state_desc = CASE 
			WHEN (connected_state = 0) THEN CAST ('DISCONNECTED' AS nvarchar(60))
			WHEN (connected_state = 1) THEN CAST ('CONNECTED' AS nvarchar(60))
			ELSE CAST (NULL AS nvarchar(60)) END,
		last_connect_error_number,
		last_connect_error_description,
		last_connect_error_timestamp,
		configured_database_count,
		real_replica_id = IntArStates.real_replica_id,
		write_lease_remaining_ticks = IntArStates.write_lease_remaining_ticks
	FROM
		OpenRowset(TABLE DM_HADR_INTERNAL_AVAILABILITY_REPLICA_STATES) AS IntArStates
"
2754	Parse Tree	View	-802879297	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	358	"
CREATE VIEW sys.dm_db_column_store_row_group_operational_stats AS
	SELECT * from OpenRowset (TABLE COLUMNSTORE_OPERATIONAL_STATS) rg WHERE has_access('CO', rg.object_id) = 1;
"
2754	Parse Tree	View	-547	32767	6	4	1	2	17	187	0	1	1024	0	0	0	0	0	252	"CREATE VIEW sys.plan_persist_runtime_stats_in_memory AS
	SELECT	*
	FROM OpenRowSet(TABLE QUERY_STORE_RUNTIME_STATS_IN_MEM)
"
2756	Parse Tree	View	-316061801	32767	6	4	1	18	7	251	0	1	1024	0	0	0	0	0	912	"
-- add it
create view sys.dm_pdw_exec_sessions as
select
	session_id	collate database_default session_id,
	status		collate database_default status,
	request_id	collate database_default request_id,
	security_id,
	login_name	collate database_default login_name,
	login_time,
	query_count,
	is_transactional,
	client_id	collate database_default client_id,
	app_name	collate database_default app_name,
	sql_spid
from sys._dm_pdw_exec_sessions
"
2761	Parse Tree	View	-116359285	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	256	"
-- add it
create view sys.dm_pdw_nodes_os_sys_memory as
select *, convert(int, null) pdw_node_id from sys.dm_os_sys_memory
"
2761	Parse Tree	View	-461194620	32767	6	4	1	12	7	251	0	1	1024	0	0	0	0	0	210	"CREATE VIEW sys.dm_os_memory_cache_entries AS
	SELECT *
	FROM OpenRowset(TABLE SYSMEMORYCACHEENTRIES)
"
2763	Parse Tree	View	-32276936	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	196	"CREATE VIEW sys.dm_os_process_memory AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_PROCESS_MEMORY)
"
2765	Parse Tree	View	-489	32767	6	4	1	4	9	251	0	1	1024	0	0	0	0	0	1056	"CREATE VIEW sys.system_sql_modules AS
	SELECT o.object_id,
		definition = object_definition(o.object_id),
		uses_ansi_nulls = sysconv(bit, 1),
		uses_quoted_identifier = sysconv(bit, 1),
		is_schema_bound = sysconv(bit, 0),
		uses_database_collation = sysconv(bit, 0),
		is_recompiled = sysconv(bit, 0),
		null_on_null_input = sysconv(bit, 0),
		execute_as_principal_id = convert(int, NULL),
		uses_native_compilation = sysconv(bit, 0)
	FROM sys.system_objects o
	WHERE o.type IN ('P','V','FN','IF','TF','RF','IS')
"
2767	Parse Tree	View	-64117504	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	182	"CREATE VIEW sys.dm_logpool_stats AS
	SELECT * 
	FROM OpenRowSet(TABLE DM_LOGPOOL_STATS)
"
2776	Parse Tree	View	-431	32767	6	4	1	5	8	251	0	1	1024	0	0	0	0	0	1106	"CREATE VIEW sys.assembly_files AS
		SELECT asm.objid AS assembly_id,
			convert(nvarchar(260), asm.value) collate catalog_default AS name,
			asm.subobjid AS file_id,
			case when asm.objid < 65536 then GetSystemAssemblyBytes(asm.objid) else f.imageval end AS content -- x_MinUserAssemblyId
		FROM sys.sysobjvalues asm
		LEFT JOIN sys.sysobjvalues f ON f.valclass = 10 AND f.objid = asm.objid AND f.subobjid = asm.subobjid AND f.valnum = 2
		WHERE asm.valclass = 10 AND asm.valnum = 1	-- SVC_ASSEMBLYFILE
			AND has_access('AF', asm.objid) = 1
"
2809	Parse Tree	View	-257	32767	6	4	1	2	8	251	0	1	1024	0	0	0	0	0	1024	"CREATE VIEW sys.server_principal_credentials AS
	SELECT indepid AS principal_id,
		depid AS credential_id
	FROM master.sys.sysmultiobjrefs
	WHERE class = 24 AND depsubid = 0 AND indepsubid = 0
		AND has_access('LG', indepid) = 1
	UNION	-- Adding results similar to sys.credentials view for creds added using WITH clause
	SELECT depid AS principal_id,
		indepid AS credential_id
	FROM master.sys.syssingleobjrefs
	WHERE class = 63 AND depsubid = 0 AND indepsubid = 0
		AND has_access('LG', depid) = 1
"
2811	Parse Tree	View	-438926401	32767	6	4	1	13	5	251	0	1	1024	0	0	0	0	0	236	"CREATE VIEW sys.dm_cryptographic_provider_properties AS
	SELECT *
	FROM OpenRowset(TABLE DM_CRYPTO_PROVIDER_PROPS)
"
2814	Parse Tree	View	-469313267	32767	6	4	1	6	6	251	0	1	1024	0	0	0	0	0	160	"CREATE VIEW sys.dm_os_nodes AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_NODES)
"
2819	Parse Tree	View	-568	32767	6	4	1	11	35	251	0	1	1024	0	0	0	0	0	5208	"CREATE VIEW sys.remote_data_archive_tables AS
	SELECT
		mr.depid as object_id,
		mr.indepid as remote_database_id,
		convert(sysname, v.value) as remote_table_name,
		object_definition(mr.depid, -1) AS filter_predicate,
		convert(tinyint,
					CASE
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 2 <> 0  /*INBOUND UNMIGRATE*/) THEN 1
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 2 = 0 /*OUTBOUND MIGRATE*/) THEN 0
						ELSE 0
					END) AS migration_direction,
				convert(nvarchar(60),
					CASE
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 2 <> 0 /*INBOUND UNMIGRATE*/) THEN N'INBOUND'
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 2 = 0 /*OUTBOUND MIGRATE*/) THEN N'OUTBOUND'
						ELSE N'OUTBOUND'
					END) COLLATE catalog_default AS migration_direction_desc,
				convert(bit,
					CASE
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 1 <> 0 /*NOT PAUSED*/) THEN 0
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 1 = 0 /*PAUSED*/) THEN 1
						ELSE 1
					END) AS is_migration_paused,
				convert(bit,
					CASE
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 4 <> 0 /*NOT RECONCILED*/) THEN 0
						WHEN EXISTS (SELECT 1 FROM sys.sysobjvalues WHERE objid = mr.depid AND valclass = 116 /*SVC_STRETCH*/ AND valnum = 2 /*STRETCH_TABLE_MIGRATION_STATE*/ AND convert(int, value) & 4 = 0 /*RECONCILED*/) THEN 1
						ELSE 1
					END) AS is_reconciled
	FROM sys.sysmultiobjrefs mr LEFT JOIN sys.sysobjvalues v ON mr.depid = v.objid AND v.valclass = 116 /* SVC_STRETCH */ AND v.valnum = 3 /* STRETCH_TABLE_REMOTE_TABLE_NAME */
	WHERE
	 mr.class = 27 -- MRC_STRETCH_REMOTE_DATABASE
	 AND has_access('CO', mr.depid) = 1
"
2820	Parse Tree	View	-199	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	168	"CREATE VIEW sys.syscursorrefs AS
	SELECT *
	FROM OpenRowSet(TABLE SYSCURSORREFS)
"
2841	Parse Tree	View	-452	32767	6	4	1	20	23	251	0	1	1024	0	0	0	0	0	2886	"CREATE VIEW sys.xml_schema_types AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id,
		sysconv(bit, c.status & 1) AS is_abstract,
		sysconv(bit, c.status & 2) AS allows_mixed_content,
		sysconv(bit, c.status & 4) AS is_extension_blocked,
		sysconv(bit, c.status & 8) AS is_restriction_blocked,
		sysconv(bit, c.status & 16) AS is_final_extension,
		sysconv(bit, c.status & 32) AS is_final_restriction,
		sysconv(bit, c.status & 64) AS is_final_list_member,
		sysconv(bit, c.status & 128) AS is_final_union_member
	FROM sys.sysxmlcomponent c
	LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	WHERE c.symspace = 'T'
		AND has_access('XC', c.id, c.xsdid) = 1
"
2850	Parse Tree	View	-32939601	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	204	"CREATE VIEW sys.dm_xtp_gc_queue_stats
AS
	SELECT		*
	FROM 		OpenRowset(TABLE XTP_GC_QUEUE_STATS) 
"
2852	Parse Tree	View	-394	32767	6	4	1	14	9	251	0	1	1024	0	0	0	0	0	1126	"CREATE VIEW sys.system_parameters AS
	SELECT object_id, name collate catalog_default AS name,
		parameter_id, system_type_id,
		user_type_id, max_length,
		precision, scale,
		is_output, is_cursor_ref,
		has_default_value, is_xml_document,
		default_value, xml_collection_id,
		is_readonly, is_nullable,
		encryption_type, encryption_type_desc, 
		encryption_algorithm_name, column_encryption_key_id,
		column_encryption_key_database_name collate catalog_default as column_encryption_key_database_name
	FROM sys.system_parameters$
	WHERE number = 1
"
2884	Parse Tree	View	-589	32767	6	4	1	4	9	251	0	1	1024	0	0	0	0	0	1122	"CREATE VIEW sys.external_library_files AS
	SELECT 
		co.id AS external_library_id,
		ov1.imageval AS content,
		convert(tinyint, ov1.subobjid) AS platform,
		pv.name as platform_desc
	FROM
		sys.sysclsobjs co LEFT JOIN
		sys.sysobjvalues ov1 ON
		(
			co.id = ov1.objid AND
			ov1.valclass = 129 AND -- SVC_EXTERNAL_LIBRARY
			ov1.valnum = 3 -- EXTLIB_SOURCE
		) LEFT JOIN
		sys.syspalvalues pv ON
		(
			pv.class = 'ELP' AND
			pv.value = ov1.subobjid
		)
	WHERE
		co.class = 105 AND -- SOC_EXTERNAL_LIBRARY
		has_access('EL', co.id) = 1
"
2885	Parse Tree	View	-220	32767	1	4	1	1	21	251	0	1	1024	0	0	0	0	0	3716	"CREATE VIEW sys.servers AS
	SELECT s.id AS server_id,
		s.name, s.product, s.provider,
		data_source = convert(nvarchar(4000), v.value),
		location = convert(nvarchar(4000), l.value),
		provider_string = convert(nvarchar(4000), LinkedServerProperty(s.name, 'ProviderString')),
		s.catalog,
		s.connecttimeout AS connect_timeout,
		s.querytimeout AS query_timeout,
		sysconv(bit, s.status & 4) AS is_linked,				-- SRV_NORPCMAP
		sysconv(bit, s.status & 1) AS is_remote_login_enabled,	-- SRV_RPCIN
		sysconv(bit, s.status & 2) AS is_rpc_out_enabled,		-- SRV_RPCOUT
		sysconv(bit, s.status & 8) AS is_data_access_enabled,	-- SRV_DATA
		sysconv(bit, s.status & 16) AS is_collation_compatible,	-- SRV_COLLATECOMPAT
		sysconv(bit, s.status & 64) AS uses_remote_collation,	-- SRV_USERMTCOLLATE
		convert(sysname, collationpropertyfromid(s.cid,'name')) AS collation_name,
		sysconv(bit, s.status & 128) AS lazy_schema_validation,	-- SRV_LAZYSCHCHECK
		sysconv(bit, s.status & 32) AS is_system,				-- SRV_SYSTEM
		sysconv(bit, s.status & 256) AS is_publisher,			-- SRV_PUB
		sysconv(bit, s.status & 0x200) AS is_subscriber,		-- SRV_SUB
		sysconv(bit, s.status & 0x400) AS is_distributor,		-- SRV_DIST
		sysconv(bit, s.status & 0x800) AS is_nonsql_subscriber,	-- SRV_NONSQLSUB
		~(sysconv(bit, s.status & 0x1000)) AS is_remote_proc_transaction_promotion_enabled,	-- SRV_NODTCPROMOFORRPC
		s.modate AS modify_date,							-- SRV80_USERMTCOLLATE
		sysconv(bit, s.status & 0x2000) AS is_rda_server        -- SRV_REMOTEDATAARCHIVE
	FROM master.sys.sysxsrvs s
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 25 AND v.objid = s.id AND v.subobjid = 1 AND v.valnum = 0	-- SRV_DATASRC
	LEFT JOIN sys.sysobjvalues l ON l.valclass = 25 AND l.objid = s.id AND l.subobjid = 2 AND l.valnum = 0	-- SRV_LOCATION
	WHERE s.id = 0 OR has_access('SR', s.id) = 1
"
2885	Parse Tree	View	-220	32767	6	4	1	28	21	251	0	1	1024	0	0	0	0	0	3716	"CREATE VIEW sys.servers AS
	SELECT s.id AS server_id,
		s.name, s.product, s.provider,
		data_source = convert(nvarchar(4000), v.value),
		location = convert(nvarchar(4000), l.value),
		provider_string = convert(nvarchar(4000), LinkedServerProperty(s.name, 'ProviderString')),
		s.catalog,
		s.connecttimeout AS connect_timeout,
		s.querytimeout AS query_timeout,
		sysconv(bit, s.status & 4) AS is_linked,				-- SRV_NORPCMAP
		sysconv(bit, s.status & 1) AS is_remote_login_enabled,	-- SRV_RPCIN
		sysconv(bit, s.status & 2) AS is_rpc_out_enabled,		-- SRV_RPCOUT
		sysconv(bit, s.status & 8) AS is_data_access_enabled,	-- SRV_DATA
		sysconv(bit, s.status & 16) AS is_collation_compatible,	-- SRV_COLLATECOMPAT
		sysconv(bit, s.status & 64) AS uses_remote_collation,	-- SRV_USERMTCOLLATE
		convert(sysname, collationpropertyfromid(s.cid,'name')) AS collation_name,
		sysconv(bit, s.status & 128) AS lazy_schema_validation,	-- SRV_LAZYSCHCHECK
		sysconv(bit, s.status & 32) AS is_system,				-- SRV_SYSTEM
		sysconv(bit, s.status & 256) AS is_publisher,			-- SRV_PUB
		sysconv(bit, s.status & 0x200) AS is_subscriber,		-- SRV_SUB
		sysconv(bit, s.status & 0x400) AS is_distributor,		-- SRV_DIST
		sysconv(bit, s.status & 0x800) AS is_nonsql_subscriber,	-- SRV_NONSQLSUB
		~(sysconv(bit, s.status & 0x1000)) AS is_remote_proc_transaction_promotion_enabled,	-- SRV_NODTCPROMOFORRPC
		s.modate AS modify_date,							-- SRV80_USERMTCOLLATE
		sysconv(bit, s.status & 0x2000) AS is_rda_server        -- SRV_REMOTEDATAARCHIVE
	FROM master.sys.sysxsrvs s
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 25 AND v.objid = s.id AND v.subobjid = 1 AND v.valnum = 0	-- SRV_DATASRC
	LEFT JOIN sys.sysobjvalues l ON l.valclass = 25 AND l.objid = s.id AND l.subobjid = 2 AND l.valnum = 0	-- SRV_LOCATION
	WHERE s.id = 0 OR has_access('SR', s.id) = 1
"
2907	Parse Tree	View	-104	32767	6	4	1	14	14	251	0	1	1024	0	0	0	0	0	128	"CREATE VIEW sys.all_parameters AS
 SELECT * FROM sys.parameters"
2907	Parse Tree	View	-589966475	32767	6	4	1	21	7	251	0	1	1024	0	0	0	0	0	182	"CREATE VIEW sys.dm_exec_connections AS
	SELECT *
	FROM OpenRowset(TABLE SYSCONNECTIONS)
"
2917	Parse Tree	View	-415	32767	6	4	1	6	9	251	0	1	1024	0	0	0	0	0	1442	"CREATE VIEW sys.trigger_events AS
	SELECT ee.object_id AS object_id,
		ee.event_id AS type,
		ee.event_desc AS type_desc,
		sysconv(bit, convert(int, e.value) & 1) AS is_first,	-- TRG_FIRSTFIRED
		sysconv(bit, convert(int, e.value) & 2) AS is_last,	-- TRG_LASTFIRED
		ee.group_id AS event_group_type,
		ee.group_desc AS event_group_type_desc,
		convert(bit, 1) AS is_trigger_event
	FROM sys.sysobjvalues e
	CROSS APPLY openrowset( TABLE EXPAND_EVENTS, e.objid, e.subobjid, 
		case when (e.valclass = 70 AND convert(int, e.value) & 4 != 4)	-- is user created trigger?
			then 1 else 0 end) ee
	WHERE e.valclass = 70 AND e.valnum <> 100	-- x_eunc_Server
		AND has_access('CO', e.objid) = 1	-- SVC_EXTTRIGEVT
"
2918	Parse Tree	View	-208573699	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	300	"CREATE VIEW sys.dm_hadr_database_replica_cluster_states AS
	SELECT
		*
	FROM
		OpenRowset(TABLE DM_HADR_DATABASE_REPLICA_CLUSTER_STATES) AS drcs
"
2919	Parse Tree	View	-651866945	32767	6	4	1	9	3	251	0	1	1024	0	0	0	0	0	150	"CREATE VIEW sys.user_token AS
	SELECT * FROM OpenRowset(TABLE USERROLES)
"
2950	Parse Tree	View	-241	32767	6	4	1	25	11	251	0	1	1024	0	0	0	0	0	2212	"CREATE VIEW sys.database_mirroring AS
	SELECT d.id AS database_id,
		p.guid AS mirroring_guid,
		p.state AS mirroring_state, p.state_desc AS mirroring_state_desc,
		p.role AS mirroring_role, p.role_desc AS mirroring_role_desc,
		p.role_sequence AS mirroring_role_sequence,
		p.safety_level AS mirroring_safety_level,
		p.safety_level_desc AS mirroring_safety_level_desc,
		p.safety_sequence AS mirroring_safety_sequence,
		p.partner_name AS mirroring_partner_name,
		p.partner_instance AS mirroring_partner_instance,
		p.witness_name AS mirroring_witness_name,
		p.witness_state AS mirroring_witness_state,
		p.witness_state_desc AS mirroring_witness_state_desc,
		p.failover_lsn AS mirroring_failover_lsn,
		p.connection_timeout AS mirroring_connection_timeout,
		p.redo_queue AS mirroring_redo_queue,
		p.redo_queue_type AS mirroring_redo_queue_type,
		p.end_of_log_lsn AS mirroring_end_of_log_lsn,
		p.safe_relication_lsn AS mirroring_replication_lsn
	FROM master.sys.sysdbreg d OUTER APPLY OpenRowset(TABLE DBMIRROR, d.id) p
	WHERE d.id < 0x7fff
		AND has_access('DB', d.id) = 1
"
2956	Parse Tree	View	-304925132	32767	6	4	1	4	5	251	0	1	1024	0	0	0	0	0	698	"CREATE VIEW sys.dm_tran_active_transactions AS
	SELECT
		transaction_id,
		name,
		transaction_begin_time,
		transaction_type,
		transaction_uow,
		transaction_state,
		transaction_status,
		transaction_status2,
		dtc_state,
		dtc_status,
		dtc_isolation_level,
		filestream_transaction_id
	FROM OpenRowset(TABLE ACTIVE_TRANSACTIONS)
"
2963	Parse Tree	View	-362649280	32767	6	4	1	2	6	251	0	1	1024	0	0	0	0	0	192	"CREATE VIEW sys.dm_os_worker_local_storage AS
	SELECT *
	FROM OpenRowSet(TABLE SYSWORKERTLS)
"
2971	Parse Tree	View	-494	32767	6	4	1	5	16	251	0	1	1024	0	0	0	0	0	2248	"CREATE VIEW sys.table_types AS
	SELECT t.name AS name,
		t.xtype AS system_type_id,
		t.id AS user_type_id,
		t.schid AS schema_id,
		own.indepid AS principal_id,
		t.length AS max_length,
		t.prec AS precision,
		t.scale AS scale,
		convert(sysname, collationpropertyfromid(t.collationid, 'name')) AS collation_name,
		sysconv(bit, 1 - (t.status & 1)) AS is_nullable,	-- TYPE_NOTNULL
		sysconv(bit, 1) AS is_user_defined,
		sysconv(bit, 0) AS is_assembly_type,
		sysconv(int, 0) AS default_object_id,
		sysconv(int, 0) AS rule_object_id,
		sysconv(bit, 1) AS is_table_type,
		o.indepid AS type_table_object_id,
		sysconv(bit, obj.status2 & 0x00000008) AS is_memory_optimized	-- OBJTAB2_HEKATON
	FROM sys.sysscalartypes t
	LEFT JOIN sys.syssingleobjrefs own ON own.depid = t.id AND own.class = 44 AND own.depsubid = 0	-- SRC_TYPETOOWNER
	INNER JOIN sys.syssingleobjrefs o ON o.depid = t.id AND o.class = 36 AND o.depsubid = 0	-- SRC_TYPETOTABLE
	INNER JOIN sys.sysschobjs$ obj ON o.indepid = obj.id
		-- 36==SRC_TYPETOTABLE, so only table types show up in this view
	WHERE has_access('UT', t.id) = 1
"
2982	Parse Tree	View	-436	32767	6	4	1	13	8	251	0	1	1024	0	0	0	0	0	664	"CREATE VIEW sys.data_spaces AS
	SELECT o.name AS name,
		o.id AS data_space_id,
		o.type AS type,
		c.name AS type_desc,
		sysconv(bit, o.status & 1) AS is_default,
		sysconv(bit, o.status & 0x4) AS is_system
	FROM sys.sysclsobjs o
	LEFT JOIN sys.syspalnames c ON c.class = 'DSTY' AND c.value = o.type
	WHERE o.class = 31
"
2990	Parse Tree	View	-86814675	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	210	"CREATE VIEW sys.dm_xtp_table_memory_usage$
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_MM_TABLE_USAGE)
"
3013	Parse Tree	View	-488195291	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	248	"CREATE VIEW sys.dm_tran_version_store_space_usage AS
	SELECT *
	FROM OpenRowset(TABLE DM_TRAN_VERSION_STORE_SPACE_USAGE)
"
3015	Parse Tree	View	-262	32767	6	4	1	16	12	251	0	1	1024	0	0	0	0	0	1890	"CREATE VIEW sys.server_audit_specification_details AS
	SELECT
		server_specification_id		= asp.id,
		audit_action_id 			= saa.type,
		audit_action_name 			= convert(nvarchar(60), 
											audit_action_property('name', saa.class, saa.type)),
		class 						= saa.class, -- EMDPermissionClass
		class_desc				 	= n.name,
		major_id				 	= saa.id,
		minor_id				 	= saa.subid,
		audited_principal_id		= saa.grantee,
		audited_result			 	= convert(nvarchar(60), 'SUCCESS AND FAILURE'),
		is_group				 	= sysconv(bit, 
										audit_action_property('is_group', saa.class, saa.type))
	FROM
		master.sys.sysclsobjs asp INNER JOIN 
		master.sys.sysaudacts saa ON
			(
				saa.audit_spec_id = asp.id
			) LEFT JOIN
		sys.syspalvalues n ON 
			(
				n.class = 'UNCL' AND
				n.value = saa.class
			)
	WHERE
		asp.class = 65 AND -- SOC_SECAUDITSPEC
		asp.type = 'SA' AND
		has_access('SA', 0) = 1 -- catalog security check
"
3026	Parse Tree	View	-204	32767	6	4	1	3	6	251	0	1	1024	0	0	0	0	0	160	"CREATE VIEW sys.syslockinfo AS
	SELECT *
	FROM OpenRowSet(TABLE SYSLOCKINFO)
"
3036	Parse Tree	View	-515	32767	6	4	1	15	17	187	0	1	1024	0	0	0	0	0	1968	"CREATE VIEW sys.sequences AS
	SELECT
		-- common fields
		o.name,
		o.object_id,
		o.principal_id,
		o.schema_id,
		o.parent_object_id,
		o.type,
		o.type_desc,
		o.create_date,
		o.modify_date,
		o.is_ms_shipped,
		o.is_published,
		o.is_schema_published,
		-- specific fields
		dmv.start_value,
		dmv.increment,
		dmv.minimum_value,
		dmv.maximum_value,
		is_cycling = o.is_cycling,
		is_cached = o.is_cached,
		cache_size = nullif (o.property, 0),
		dmv.system_type_id,
		user_type_id = isnull(udt.indepid, dmv.system_type_id),
		dmv.precision,
		scale = convert(tinyint, 0), -- The scale always returns 0 as only integer types are allowed.
		dmv.current_value,
		dmv.is_exhausted,
		dmv.last_used_value
	FROM sys.objects$ o
	CROSS APPLY OpenRowset(TABLE DM_DB_SEQUENCES, o.object_id) dmv
	LEFT JOIN sys.syssingleobjrefs udt ON udt.depid = o.object_id AND udt.class = 43 AND udt.depsubid = 0	-- SRC_OBJTOTYPE
	WHERE o.type = 'SO' -- MDOT_SEQUENCE
"
3045	Parse Tree	View	-277581021	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	204	"CREATE VIEW sys.dm_db_file_space_usage AS
	SELECT *
	FROM OpenRowset(TABLE DM_DB_FILE_SPACE_USAGE)
"
3047	Parse Tree	View	-721159007	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	244	"CREATE VIEW sys.dm_tran_global_recovery_transactions AS
	SELECT *
	FROM OpenRowset(TABLE GLOBAL_TRANSACTIONS_RECOVERY)
"
3047	Parse Tree	View	-457	32767	6	4	1	26	21	251	0	1	1024	0	0	0	0	0	2394	"CREATE VIEW sys.xml_schema_wildcards AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id,
		c.enum AS process_content,
		p.name AS process_content_desc,
		sysconv(bit, c.status & 1) AS disallow_namespaces
	FROM sys.sysxmlcomponent c LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	LEFT JOIN sys.sysbinpals p ON p.class = 'XWPC' AND p.value = c.enum
	WHERE c.symspace = 'N'
		AND has_access('XC', c.id, c.xsdid) = 1
"
3053	Parse Tree	View	-897487264	32767	6	4	1	14	7	251	0	1	1024	0	0	0	0	0	180	"CREATE VIEW sys.dm_xe_sessions AS
	SELECT *
	FROM OpenRowset(TABLE DM_XE_SESSIONS, 0) 
"
3054	Parse Tree	View	-570928251	32767	6	4	1	3	3	251	0	1	1024	0	0	0	0	0	290	"CREATE VIEW sys.event_notification_event_types AS
	SELECT type, type_name, parent_type
	FROM OpenRowset(TABLE event_notification_event_types)
"
3058	Parse Tree	View	-399	32767	6	4	1	6	43	251	0	1	1024	0	0	0	0	0	8378	"CREATE VIEW sys.partitions AS
	WITH partitions_columnstore(partition_id, object_id, index_id, partition_number, hobt_id, 
					rows, status, filestream_filegroup_id, data_compression, data_compression_desc)
	AS
	(
	SELECT
		rs.rowsetid AS partition_id,
		rs.idmajor AS object_id, -- The following 3 columns form a unique
		rs.idminor AS index_id,  -- Composite ID for a partition.
		rs.numpart AS partition_number, -- This is the third column
		rs.rowsetid AS hobt_id,
		-- To get the rows, we first check if ALUCOUNT has any rows related to the partition.
		-- ALUCOUNT is a tvf that fetches the row count for a partition.
		-- sysrowsets does not maintain the row count all the time for columnstore 
		-- e.g. when the tuple mover compresses row groups.
		-- So use ALUCOUNT to get the row count.
		isnull(ct.rows, rs.rcrows) as rows,
		rs.status as status,
		rs.fgidfs as filestream_filegroup_id,
		cmprlevel AS data_compression,
		cl.name AS data_compression_desc
	FROM sys.sysrowsets rs OUTER APPLY OpenRowset(TABLE ALUCOUNT, rs.rowsetid, 0, 0, 0) ct
		LEFT JOIN sys.syspalvalues cl ON cl.class = 'CMPL' AND cl.value = cmprlevel
		WHERE rs.ownertype = 1 and sysconv(bit, rs.status & 0x00010000) = 1 -- Consider only columnstore base indexes
	),
	partitions_rowstore(partition_id, object_id, index_id, partition_number, hobt_id, 
				rows, status, filestream_filegroup_id, data_compression, data_compression_desc)
	AS
	(
	SELECT
		rs.rowsetid AS partition_id,
		rs.idmajor AS object_id, -- The following 3 columns form a unique
		rs.idminor AS index_id,  -- Composite ID for a partition.
		rs.numpart AS partition_number, -- This is the third column
		rs.rowsetid AS hobt_id,
		rs.rcrows as rows,
		rs.status as status,
		rs.fgidfs as filestream_filegroup_id,
		cmprlevel AS data_compression,
		cl.name AS data_compression_desc
	FROM sys.sysrowsets rs 
		LEFT JOIN sys.syspalvalues cl ON cl.class = 'CMPL' AND cl.value = cmprlevel
		WHERE rs.ownertype = 1 and sysconv(bit, rs.status & 0x00010000) = 0 -- Ignore columnstore base indexes and orphaned rows.
	)
	
	-- Result is a union of rowstore and columnstore partitions.
	
	-- Get rowstore partitions
	SELECT 
		partition_id,
		object_id,
		index_id,
		partition_number,
		hobt_id,
		isnull(ct.rows, p.rows) AS rows,
		filestream_filegroup_id,
		data_compression,
		data_compression_desc	
		from partitions_rowstore p OUTER APPLY OpenRowset(TABLE ALUCOUNT, p.partition_id, 0, 0, p.object_id) ct
	
	union all
	
	-- For columnstore the total rows in a partition is sum of the rows in 
	-- compressed row groups, deltastores, minus the rows in delete buffer and delete bitmap.
	-- P1 below gives the columnstore base index
	-- P2 gives the rows in delete bitmaps, delta stores and delete buffers
	-- 
	-- NOTE: While calculating rows, even though we use a LEFT JOIN we do NOT expect
	-- P2.rows to be NULL. This is because there will at least be a delete bitmap present which
	-- returns 0 for P2.rows. Hence the check isnull(P2.rows, 0) is not required.
	-- And by using LEFT JOIN we can SEEK on partition_id that offers better performance.
	SELECT 
		P1.partition_id,
		P1.object_id,
		P1.index_id,
		P1.partition_number,
		P1.hobt_id,
		(P1.rows + P2.rows) AS rows,
		P1.filestream_filegroup_id,
		P1.data_compression,
		P1.data_compression_desc
	FROM 
		partitions_columnstore as P1
	LEFT JOIN 
		(SELECT 
			rs.idmajor AS object_id,
			rs.idminor AS index_id,
			rs.numpart AS partition_number,
			SUM(CASE -- ownertype 2 corresponds to delete bitmaps and 4 to delete buffers
					WHEN ownertype IN (2, 4) THEN -isnull(ct.rows, rs.rcrows) -- Flip sign of delete bitmaps and delete buffers
					ELSE isnull(ct.rows, rs.rcrows) -- delta stores are ownertype 3 and included here.
				END)
				AS rows
		FROM sys.sysrowsets rs OUTER APPLY OpenRowset(TABL"
3068	Compiled Plan	Adhoc	574876496	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.dm_clr_appdomains t
3090	Parse Tree	View	-594	32767	6	4	1	2	4	187	0	1	1024	0	0	0	0	0	240	"CREATE VIEW sys.plan_persist_wait_stats_in_memory AS
	SELECT	*
	FROM OpenRowSet(TABLE QUERY_STORE_WAIT_STATS_IN_MEM)
"
3091	Parse Tree	View	-225	32767	1	4	1	1	7	251	0	1	1024	0	0	0	0	0	802	"CREATE VIEW sys.messages AS
	SELECT id AS message_id,
		msglangid AS language_id,
		convert(tinyint, severity) AS severity,
		sysconv(bit, status & 128) AS is_event_logged,	-- MSG80_EVENTLOG
		text
	FROM master.sys.sysusermsgs
	WHERE id > 50000	-- x_MDMessageIdUsrFmt
	UNION ALL
	SELECT message_id,
		language_id,
		severity,
		is_event_logged,
		text
	FROM OpenRowset(TABLE SYSERRORS)
"
3091	Parse Tree	View	-225	32767	6	4	1	5	7	251	0	1	1024	0	0	0	0	0	802	"CREATE VIEW sys.messages AS
	SELECT id AS message_id,
		msglangid AS language_id,
		convert(tinyint, severity) AS severity,
		sysconv(bit, status & 128) AS is_event_logged,	-- MSG80_EVENTLOG
		text
	FROM master.sys.sysusermsgs
	WHERE id > 50000	-- x_MDMessageIdUsrFmt
	UNION ALL
	SELECT message_id,
		language_id,
		severity,
		is_event_logged,
		text
	FROM OpenRowset(TABLE SYSERRORS)
"
3092	Parse Tree	View	-784887024	32767	6	3	1	25	22	251	0	1	1024	0	0	0	0	0	2176	"CREATE VIEW INFORMATION_SCHEMA.KEY_COLUMN_USAGE
AS
SELECT
	DB_NAME()				AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(f.schema_id)		AS CONSTRAINT_SCHEMA,
	f.name					AS CONSTRAINT_NAME,
	DB_NAME()				AS TABLE_CATALOG,
	SCHEMA_NAME(p.schema_id)		AS TABLE_SCHEMA,
	p.name					AS TABLE_NAME,
	col_name(k.parent_object_id, k.parent_column_id)
						AS COLUMN_NAME,
	k.constraint_column_id			AS ORDINAL_POSITION
FROM
	sys.foreign_keys f JOIN sys.foreign_key_columns k
		ON k.constraint_object_id = f.object_id
	JOIN sys.tables	p ON p.object_id = f.parent_object_id
UNION
SELECT
	DB_NAME()				AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(k.schema_id)		AS CONSTRAINT_SCHEMA,
	k.name					AS CONSTRAINT_NAME,
	DB_NAME()				AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)		AS TABLE_SCHEMA,
	t.name					AS TABLE_NAME,
	col_name(c.object_id, c.column_id)	AS COLUMN_NAME,
	c.key_ordinal				AS ORDINAL_POSITION
FROM
	sys.key_constraints k JOIN sys.index_columns c
		ON c.object_id = k.parent_object_id
		AND c.index_id = k.unique_index_id
	JOIN sys.tables t ON t.object_id = k.parent_object_id
"
3101	Parse Tree	View	-536	32767	6	4	1	2	13	251	0	1	1024	0	0	0	0	0	1146	"CREATE VIEW sys.query_context_settings AS
	SELECT
		context_settings_id,
		CONVERT(varbinary(8), set_options) AS 'set_options',
		language_id,
		date_format,
		date_first,
		CONVERT(varbinary(2), status) AS 'status',
		required_cursor_options,
		acceptable_cursor_options,
		merge_action_type,
		default_schema_id,
		is_replication_specific,
		CONVERT(varbinary(1), status2) AS 'is_contained'
	FROM (
		SELECT * FROM sys.plan_persist_context_settings
		UNION ALL
		SELECT TOP 0 * FROM OpenRowSet(TABLE QUERY_STORE_CONTEXT_SETTINGS)
	) AS ContextSettings
"
3108	Parse Tree	View	-968843074	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	234	"CREATE VIEW sys.dm_exec_query_parallel_workers AS
	SELECT A.*
	FROM OpenRowset(TABLE DM_EXEC_PARALLEL_WORKERS) A 
"
3112	Parse Tree	View	-478	32767	6	4	1	4	4	251	0	1	1024	0	0	0	0	0	432	"CREATE VIEW sys.message_type_xml_schema_collection_usages AS
	SELECT depid AS message_type_id,
		indepid AS xml_collection_id
	FROM sys.syssingleobjrefs
	WHERE class = 92 AND depsubid = 0	-- SRC_MSGTYPE_XSDTYPE
"
3118	Compiled Plan	Adhoc	186615832	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM INFORMATION_SCHEMA.VIEWS t
3119	Parse Tree	View	-445705453	32767	6	3	1	20	10	251	0	1	1024	0	0	0	0	0	882	"CREATE VIEW INFORMATION_SCHEMA.VIEW_TABLE_USAGE
AS
SELECT DISTINCT
	DB_NAME()					AS VIEW_CATALOG,
	SCHEMA_NAME(v.schema_id)	AS VIEW_SCHEMA,
	v.name						AS VIEW_NAME,
	DB_NAME()					AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS TABLE_SCHEMA,
	t.name						AS TABLE_NAME
FROM
	 sys.objects t,
	 sys.views v,
	 sys.sql_dependencies d
WHERE
	d.class < 2
	AND d.object_id = v.object_id
	AND d.referenced_major_id = t.object_id
"
3123	Parse Tree	View	-420	32767	6	4	1	22	13	251	0	1	1024	0	0	0	0	0	946	"CREATE VIEW sys.synonyms AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		base_object_name = convert(nvarchar(1035), v.value) collate catalog_default
	FROM sys.objects$ o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 4 AND v.objid = o.object_id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_SYNBASEOBJ
	WHERE o.type = 'SN'
"
3126	Parse Tree	View	-544912451	32767	6	4	1	11	4	251	0	1	1024	0	0	0	0	0	244	"CREATE VIEW sys.dm_filestream_file_io_handles AS
    SELECT *
    FROM OpenRowset(TABLE DM_FILESTREAM_FILE_IO_HANDLES)
"
3142	Parse Tree	View	-42584168	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	256	"
-- add it
create view sys.dm_pdw_nodes_os_wait_stats as
select *, convert(int, null) pdw_node_id from sys.dm_os_wait_stats
"
3142	Parse Tree	View	-686562332	32767	6	4	1	28	10	251	0	1	1024	0	0	0	0	0	1378	"CREATE VIEW sys.dm_audit_actions AS
--	SELECT * FROM OpenRowset(TABLE DM_AUDIT_ACTIONS) dm
	SELECT REVERSE(CONVERT(char(4), CONVERT(BINARY(4), [action_id]))) as [action_id], 
		[action_name] as [name], 
		(SELECT spt.name 
			from master.dbo.spt_values spt where spt.type='EOD' AND spt.number = CONVERT(smallint, dm.class_id)) as [class_desc], 
		[covering_action_name],
		(SELECT spt.name 
			from master.dbo.spt_values spt where spt.type='EOD' AND spt.number = CONVERT(smallint, dm.parent_class_id)) as [parent_class_desc], 
		[covering_parent_action_name], 
		[configuration_level],
		[containing_group_name],
		[action_in_log]
	FROM OpenRowset(TABLE DM_AUDIT_ACTIONS) dm
"
3149	Parse Tree	View	-243150105	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	190	"CREATE VIEW sys.dm_os_memory_pools AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_MEMORY_POOLS) 
"
3156	Parse Tree	View	-667123516	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	548	"CREATE VIEW sys.dm_db_xtp_table_memory_stats
AS
	SELECT
		object_id,
		memory_allocated_for_table_kb,
		memory_used_by_table_kb,
		memory_allocated_for_indexes_kb,
		memory_used_by_indexes_kb
	FROM
		sys.dm_db_xtp_table_memory_stats$
	WHERE database_id = db_id()
"
3164	Parse Tree	View	-40957419	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	472	"
-- add it
create view sys.dm_pdw_nodes_os_buffer_pool_extension_configuration as
	select
		state,
		state_description,
		current_size_in_kb,
		convert(int, null) pdw_node_id
	from OpenRowset(TABLE DM_OS_BPOOLEXTENSION_CONFIG)
"
3166	Parse Tree	View	-477795258	32767	6	4	1	6	7	251	0	1	1024	0	0	0	0	0	790	"CREATE VIEW sys.dm_xtp_system_memory_consumers
AS
	SELECT
	memory_consumer_id,
	memory_consumer_type,
	memory_consumer_type_desc,
	memory_consumer_desc,
	lookaside_id,
	allocated_bytes,
	used_bytes,
	allocation_count,
	partition_count,
	sizeclass_count,
	min_sizeclass,
	max_sizeclass,
	memory_consumer_address
	FROM sys.dm_xtp_consumer_memory_usage
	WHERE database_id IS NULL
"
3166	Parse Tree	View	-557	32767	6	4	1	17	10	251	0	1	1024	0	0	0	0	0	664	"CREATE VIEW sys.security_policies AS
	SELECT name, object_id, principal_id, schema_id, parent_object_id,
		type, type_desc,
		create_date, modify_date,
		is_ms_shipped, is_enabled, is_not_for_replication,
		uses_database_collation,
		is_security_policy_schema_bound as is_schema_bound
	FROM sys.objects$
	WHERE type = 'SP'
"
3170	Compiled Plan	Adhoc	38715904	6	0	-2	2	1	27	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.sequences t
3170	Compiled Plan	Adhoc	38715904	6	0	-2	2	1	27	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.sequences t
3174	Parse Tree	View	-136776973	32767	6	3	1	17	10	251	0	1	1024	0	0	0	0	0	816	"CREATE VIEW INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE
AS
SELECT
	DB_NAME()			AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS TABLE_SCHEMA,
	t.name				AS TABLE_NAME,
	DB_NAME()			AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(c.schema_id)	AS CONSTRAINT_SCHEMA,
	c.name				AS CONSTRAINT_NAME
FROM
	sys.objects c JOIN sys.tables t
		ON t.object_id = c.parent_object_id
WHERE
	c.type IN ('C' ,'UQ' ,'PK' ,'F')
"
3177	Parse Tree	View	-499	32767	6	4	1	4	16	251	0	1	1024	0	0	0	0	0	2030	"CREATE VIEW sys.change_tracking_tables AS
	SELECT oUserTable.id AS object_id, 
		sysconv(bit, oUserTable.status & 134217728) AS is_track_columns_updated_on,	-- OBJTAB_TRACKCOLUMNS
		change_tracking_min_valid_version(oUserTable.id) as min_valid_version, 
		cast(ISNULL(csnlastinvalid.value, 0) as bigint) as begin_version,
		change_tracking_cleanup_version() as cleanup_version
	FROM sys.sysschobjs$ oIntlTable
	INNER JOIN sys.syssingleobjrefs par ON par.depid = oIntlTable.id AND par.class = 40 AND par.depsubid = 209 -- SRC_INTLTAB_PARENT, ITT_ChangeTrackingTable
	INNER JOIN sys.sysschobjs$ oUserTable ON par.indepid = oUserTable.id
	LEFT JOIN sys.sysobjvalues csnlastinvalid ON csnlastinvalid.objid = oUserTable.id and csnlastinvalid.valclass=95 and csnlastinvalid.valnum=1 -- SVC_CHANGE_TRACKING_SETTINGS 	= 95
	WHERE oIntlTable.nsclass = 0 -- x_eonc_Standard
		AND oIntlTable.nsid = 4 AND oIntlTable.pclass = 1 AND oIntlTable.type = 'IT' -- x_eunc_Object
		AND has_access('CO', oUserTable.id) = 1
"
3180	Parse Tree	View	-546218045	32767	6	4	1	15	6	251	0	1	1024	0	0	0	0	0	272	"
-- add it
create view sys.dm_pdw_nodes_os_loaded_modules as
select *, convert(int, null) pdw_node_id from sys.dm_os_loaded_modules
"
3188	Parse Tree	View	-441	32767	6	4	1	13	5	251	0	1	1024	0	0	0	0	0	460	"CREATE VIEW sys.service_message_types AS
	SELECT name,
		message_type_id,
		principal_id,
		validation,
		validation_desc,
		xml_collection_id
	FROM sys.service_message_types$
	WHERE has_access('MT', message_type_id) = 1
"
3195	Parse Tree	View	-959262707	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	226	"CREATE VIEW sys.dm_exec_query_optimizer_memory_gateways AS
	SELECT A.*
	FROM OpenRowset(TABLE DM_QO_GATES) A 
"
3201	Parse Tree	View	-4281319	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	312	"CREATE VIEW sys.dm_clr_loaded_assemblies AS
	SELECT
		assembly_id,
		appdomain_address,
		load_time
	FROM OpenRowset(TABLE DM_CLR_LOADED_ASSEMBLIES) 
"
3218	Parse Tree	View	-136165994	32767	6	4	1	3	7	251	0	1	1024	0	0	0	0	0	236	"
-- add it
create view sys.dm_pdw_nodes_os_nodes as
select *, convert(int, null) pdw_node_id from sys.dm_os_nodes
"
3232	Parse Tree	View	-209	32767	6	4	1	8	4	251	0	1	1024	0	0	0	0	0	158	"CREATE VIEW sys.sysperfinfo AS
	SELECT * from sys.dm_os_performance_counters
"
3243	Parse Tree	View	-151	32767	6	4	1	1	21	251	0	1	1024	0	0	0	0	0	3778	"CREATE VIEW sys.syscolumns$ AS
	SELECT name, id, xtype,
		typestat = convert(tinyint, status & 3), -- (1-is_nullable) + is_ansi_padded * 2
		xusertype = convert(smallint, utype),
		length, xprec = prec,
		xscale = scale,
		colid = convert(smallint, colid),
		xoffset = convert(smallint, 0),
		bitpos = convert(tinyint, 0),
		reserved = convert(tinyint, 0),
		colstat = convert(smallint, (status & 512)/128 + (status & 1024)/32), -- is_output*4 + is_cursor_ref*32
		cdefault = dflt,
		domain = chk,
		number = convert(smallint, case number when 1 then 1 - objectproperty(id, 'isscalarfunction') else number end),
		colorder = convert(smallint, colid),
		autoval = convert(varbinary(8000), null),
		offset  = convert(smallint, 0),
		collationid = columnproperty(id, name, 'collationid'),
		language = convert(int, 0),
		status = convert(tinyint, (status & 2 + 1 - (status & 1))*8 + (status & 512)/8), -- is_nullable*8 + is_ansi_padded*16 + is_output*64 (parameter)
		type = xtypetotds(xtype, 1 - (status & 1)),	-- is_nullable
		usertype = convert(smallint, columnproperty(id, name, 'oldusertype')),
		printfmt = convert(varchar(255), null),
		prec = convert(smallint, case when xtype in (34, 35, 99) then null	-- ntext, image, text
				when xtype = 36 then prec	-- uniqueidentifier
				when length = -1 then -1	-- new style large objects
				else odbcprec(xtype, length, prec) end),
		scale = odbcscale(xtype, scale),
		iscomputed = convert(int, 0),
		isoutparam = convert(int, (status & 512)/512),	-- is_output
		isnullable = convert(int, 1 - (status & 1)),	-- is_nullable
		collation = convert(sysname, columnpropertyex(id, name, 'collation')),
		tdscollation = convert(binary(5), columnpropertyex(id, name, 'tdscollation'))
	FROM sys.syscolpars
	WHERE (status & 4096) = 4096
		  AND (serverproperty('EngineEdition') != 5 OR (status & 0x08000000) != 0)
"
3252	Parse Tree	View	-1067705889	32767	6	4	1	4	7	251	0	1	1024	0	0	0	0	0	236	"CREATE VIEW sys.dm_resource_governor_resource_pool_volumes AS
	SELECT *
	FROM OpenRowSet(TABLE DM_RG_POOL_VOLUMES)
"
3253	Parse Tree	View	-462	32767	6	4	1	17	16	251	0	1	1024	0	0	0	0	0	1766	"CREATE VIEW sys.transmission_queue AS
	SELECT conversation_handle = S.handle,
		to_service_name = Q.tosvc,
		to_broker_instance = Q.tobrkrinst,
		from_service_name = Q.fromsvc,
		service_contract_name = Q.svccontr,
		enqueue_time = Q.enqtime,
		message_sequence_number = Q.msgseqnum,
		message_type_name = Q.msgtype,
		is_conversation_error = sysconv(bit, Q.status & 2),
		is_end_of_dialog = sysconv(bit, Q.status & 4),
		message_body = ISNULL(Q.msgbody, B.msgbody),
		transmission_status = GET_TRANSMISSION_STATUS (S.handle),
		priority = R.priority
	FROM sys.sysxmitqueue Q
	LEFT JOIN sys.sysxmitbody B WITH (NOLOCK) ON Q.msgref = B.msgref
	INNER JOIN sys.sysdesend S WITH (NOLOCK) on Q.dlgid = S.diagid AND Q.finitiator = S.initiator
	INNER JOIN sys.sysdercv R WITH (NOLOCK) ON Q.dlgid = R.diagid AND Q.finitiator = R.initiator
	WHERE is_member('db_owner') = 1
"
3258	Parse Tree	View	-841805201	32767	6	4	1	9	4	251	0	1	1024	0	0	0	0	0	170	"CREATE VIEW sys.dm_os_waiting_tasks AS
	SELECT *
	FROM OpenRowSet(TABLE SYSWAITS)
"
3263	Parse Tree	View	-698074232	32767	6	4	1	10	6	251	0	1	1024	0	0	0	0	0	780	"
-- add it
create view sys.dm_pdw_sql_requests as
select
	request_id	collate database_default request_id,
	step_index,
	pdw_node_id,
	distribution_id,
	status	collate database_default status,
	error_id	collate database_default error_id,
	start_time,
	end_time,
	total_elapsed_time,
	row_count,
	spid,
	command	collate database_default command
from sys._dm_pdw_sql_requests
"
3264	Parse Tree	View	-404	32767	6	4	1	20	21	251	0	1	1024	0	0	0	0	0	2892	"CREATE VIEW sys.fulltext_indexes AS
	SELECT fti.id AS object_id,
		fti.indid AS unique_index_id,
		ftc.indepid AS fulltext_catalog_id,
		sysconv(bit, fti.status & 8) AS is_enabled,		--FTIND_ACTIVE
		convert(char(1), substring('OMxA',1+(fti.status&3),1)) AS change_tracking_state,	--FTIND_CHANGETRACKING | FTIND_AUTOUPDATE
		ts.name AS change_tracking_state_desc,
		sysconv(bit, fti.status & 16) AS has_crawl_completed,	--FTIND_CRAWLCOMPLETED
		fti.crtype AS crawl_type,
		ct.name AS crawl_type_desc,
		fti.crstart AS crawl_start_date,
		fti.crend AS crawl_end_date,
		fti.crtsnext AS incremental_timestamp,
		case ISNULL(fts.indepid,0)  -- NULL means using system default, change it to 0.
			WHEN -2 then NULL -- -2 means disabled, change it to null
			ELSE ISNULL(fts.indepid, 0)
		end AS stoplist_id,
		ftp.indepid AS property_list_id,
		fti.fgid AS data_space_id
	FROM sys.sysftinds fti
	LEFT JOIN sys.syssingleobjrefs ftc ON ftc.depid = fti.id AND ftc.class = 39 AND ftc.depsubid = 0 -- SRC_FTITABTOCAT
	LEFT JOIN sys.syssingleobjrefs fts ON fts.depid = fti.id AND fts.class = 41 AND fts.depsubid = 0 -- SRC_FTITABTOSTOP
	LEFT JOIN sys.syssingleobjrefs ftp ON ftp.depid = fti.id AND ftp.class = 103 AND ftp.depsubid = 0 
	LEFT JOIN sys.syspalvalues ts ON ts.class = 'FITS' AND ts.value = fti.status & 3
	LEFT JOIN sys.syspalnames ct ON ct.class = 'FTCT' AND ct.value = fti.crtype
	WHERE has_access('CO', fti.id) = 1
"
3271	Parse Tree	View	-297851139	32767	6	4	1	29	15	251	0	1	1024	0	0	0	0	0	256	"
-- add it
create view sys.dm_pdw_nodes_exec_sessions as
select *, convert(int, null) pdw_node_id from sys.dm_exec_sessions
"
3284	Parse Tree	View	-819096169	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	410	"
CREATE VIEW sys.dm_exec_session_wait_stats AS
	SELECT session_id, wait_type, waiting_tasks_count, wait_time_ms, max_wait_time_ms, signal_wait_time_ms
	FROM OpenRowset(TABLE SYSDMEXECSESSIONWAITSTATS)
"
3289	Parse Tree	View	-882452774	32767	6	4	1	3	5	251	0	1	1024	0	0	0	0	0	462	"
-- add it
create view sys.dm_pdw_wait_stats as
select
	pdw_node_id,
	wait_name	collate database_default wait_name,
	max_wait_time,
	request_count,
	signal_time,
	completed_count,
	wait_time
from sys._dm_pdw_wait_stats
"
3296	Parse Tree	View	-599	32767	6	4	1	10	7	251	0	1	1024	0	0	0	0	0	934	"
CREATE VIEW sys.database_automatic_tuning_mode AS
SELECT
	tun_opt.desired_state,
	spn_des.name AS desired_state_desc,
	tun_opt.actual_state,
	spn_act.name AS actual_state_desc
FROM
	OpenRowset(TABLE DATABASE_AUTOMATIC_TUNING_MODE) AS tun_opt
LEFT JOIN sys.syspalnames AS spn_des
	ON spn_des.class = 'ATAR' AND tun_opt.desired_state = spn_des.value
LEFT JOIN sys.syspalnames AS spn_act
	ON spn_act.class = 'ATAR' AND tun_opt.actual_state = spn_act.value
"
3297	Parse Tree	View	-230	32767	6	4	1	31	24	251	0	1	1024	0	0	0	0	0	2960	"CREATE VIEW sys.soap_endpoints AS
	SELECT e.name,
		endpoint_id = e.id,
		principal_id = o.indepid,
		e.protocol,
		protocol_desc = p.name,
		e.type,
		type_desc = t.name,
		state = convert(tinyint, bstat & 3),	-- BSTAT_STATEMASK
		state_desc = s.name,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		is_sql_language_enabled = sysconv(bit, e.tstat & 8),		-- TSTAT_SOAP_SQL
		wsdl_generator_procedure = e.wsdlproc,
		default_database = e.dfltdb,
		default_namespace = e.dfltns,
		default_result_schema = convert(tinyint, e.tstat & 7),		-- TSTAT_SOAP_RSLTSCHMASK
		default_result_schema_desc = rs.name,
		is_xml_charset_enforced = sysconv(bit, e.tstat & 16),		-- TSTAT_SOAP_XMLCHARSET
		is_session_enabled = sysconv(bit, e.tstat & 32),			-- TSTAT_SOAP_SESSION
		session_timeout = e.typeint,
		login_type = sl.name,
		header_limit = e.maxconn
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	LEFT JOIN sys.syspalvalues rs ON rs.class = 'SPRS' AND rs.value = e.tstat & 7
	LEFT JOIN sys.syspalvalues sl ON sl.class = 'SPSL' AND sl.value = e.tstat & 64
	WHERE e.type = 1
		AND has_access('HE', e.id) = 1
"
3307	Parse Tree	View	-541	32767	6	4	1	5	6	251	0	1	1024	0	0	0	0	0	404	"CREATE VIEW sys.query_store_runtime_stats_interval AS
	SELECT	*
	FROM sys.plan_persist_runtime_stats_interval
	UNION ALL
	SELECT	TOP 0 *
	FROM OpenRowSet(TABLE QUERY_STORE_RUNTIME_STATS_INTERVAL)
"
3310	Parse Tree	View	-511266813	32767	6	4	1	15	5	251	0	1	1024	0	0	0	0	0	224	"CREATE VIEW sys.dm_os_memory_cache_clock_hands AS
	SELECT *
	FROM OpenRowSet(TABLE SYSMEMORYCACHECLOCKHANDS)
"
3316	Parse Tree	View	-927327483	32767	6	4	1	20	17	251	0	1	1024	0	0	0	0	0	256	"
-- add it
create view sys.dm_pdw_nodes_exec_requests as
select *, convert(int, null) pdw_node_id from sys.dm_exec_requests
"
3327	Parse Tree	View	-398433593	32767	6	4	1	16	8	251	0	1	1024	0	0	0	0	0	268	"
-- add it
create view sys.dm_pdw_nodes_exec_connections as
select *, convert(int, null) pdw_node_id from sys.dm_exec_connections
"
3329	Parse Tree	View	-425	32767	32767	4	1	1	7	251	0	1	1024	0	0	0	0	0	516	"CREATE VIEW sys.schemas AS
	SELECT s.name, schema_id = s.id,
		principal_id = r.indepid
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 50 AND r.depsubid = 0 -- SRC_SCHEMAOWNER
	WHERE s.class = 50	-- SOC_SCHEMA
"
3329	Parse Tree	View	-425	32767	4	4	1	1	7	187	0	1	1024	0	0	0	0	0	516	"CREATE VIEW sys.schemas AS
	SELECT s.name, schema_id = s.id,
		principal_id = r.indepid
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 50 AND r.depsubid = 0 -- SRC_SCHEMAOWNER
	WHERE s.class = 50	-- SOC_SCHEMA
"
3329	Parse Tree	View	-425	32767	1	4	1	3	7	251	0	1	1024	0	0	0	0	0	516	"CREATE VIEW sys.schemas AS
	SELECT s.name, schema_id = s.id,
		principal_id = r.indepid
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 50 AND r.depsubid = 0 -- SRC_SCHEMAOWNER
	WHERE s.class = 50	-- SOC_SCHEMA
"
3329	Parse Tree	View	-425	32767	6	4	1	12	7	251	0	1	1024	0	0	0	0	0	516	"CREATE VIEW sys.schemas AS
	SELECT s.name, schema_id = s.id,
		principal_id = r.indepid
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 50 AND r.depsubid = 0 -- SRC_SCHEMAOWNER
	WHERE s.class = 50	-- SOC_SCHEMA
"
3362	Parse Tree	View	-251	32767	6	4	1	11	9	251	0	1	1024	0	0	0	0	0	1070	"CREATE VIEW sys.server_event_session_targets AS
	SELECT 
		event_session_id = v.objid,
		target_id		 = v.subobjid,
		name			 = convert(sysname, v.value) collate catalog_default,
		package			 = convert(sysname, p.name) collate catalog_default,
		module			 = convert(sysname, m.name) collate catalog_default
	FROM master.sys.sysobjvalues v
	LEFT JOIN master.sys.sysqnames p ON p.nid = v.valnum
	LEFT JOIN master.sys.sysqnames m ON m.nid = p.qid
	WHERE v.valclass = 57			-- SVC_XE_SESSION_TARGET
	AND has_access ('ES', 0) = 1
"
3365	Parse Tree	View	-783733354	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	172	"CREATE VIEW sys.dm_os_wait_stats AS
	SELECT *
	FROM OpenRowset(TABLE SYSWAITSTATS)
"
3369	Parse Tree	View	-994514904	32767	6	4	1	7	10	251	0	1	1024	0	0	0	0	0	206	"CREATE VIEW sys.dm_exec_query_profiles AS
		SELECT *
		FROM OpenRowset (TABLE DM_EXEC_QUERY_PROFILES)"
3372	Parse Tree	View	-562	32767	6	4	1	13	11	251	0	1	1024	0	0	0	0	0	1512	"CREATE VIEW sys.column_master_keys AS
	SELECT 
		sc.name as name, 
		sc.id as column_master_key_id,
		sc.created AS create_date,
		sc.modified AS modify_date,
		convert(sysname, sov2.value) collate catalog_default as key_store_provider_name,
		convert(nvarchar(4000), sov1.value) collate catalog_default as key_path
	FROM sys.sysclsobjs sc
	INNER JOIN sys.sysobjvalues sov1 ON sov1.valclass = 114 /*SVC_COL_MASTER_KEY_VERSION*/ and sov1.objid = sc.id and sov1.valnum = 0 -- KEY_PATH
	INNER JOIN sys.sysobjvalues sov2 ON sov2.valclass = 114 /*SVC_COL_MASTER_KEY_VERSION*/ and sov2.objid = sc.id and sov2.subobjid = sov1.subobjid and sov2.valnum = 1 -- KEY_STORE_NAME
	WHERE sc.class = 101 -- SOC_COLMASTERKEY
	AND has_access('CM', DB_ID()) = 1
"
3373	Parse Tree	View	-193	32767	6	4	1	13	19	251	0	1	1024	0	0	0	0	0	2412	"
CREATE VIEW sys.syscacheobjects (bucketid, cacheobjtype, objtype, objid, dbid, dbidexec, uid, refcounts, 
		usecounts, pagesused, setopts, langid, dateformat, status, lasttime, maxexectime, avgexectime, lastreads,
		lastwrites, sqlbytes, sql) AS
	SELECT 	pvt.bucketid, pvt.cacheobjtype, pvt.objtype, 
			CONVERT(int, pvt.objectid), CONVERT(smallint, pvt.dbid),
			CONVERT(smallint, pvt.dbid_execute), CONVERT(smallint, pvt.user_id),
			pvt.refcounts, pvt.usecounts, pvt.size_in_bytes / 8192,
			CONVERT(int, pvt.set_options), CONVERT(smallint, pvt.language_id),
			CONVERT(smallint, pvt.date_format), CONVERT(int, pvt.status),
			CONVERT(bigint, 0), CONVERT(bigint, 0), CONVERT(bigint, 0), CONVERT(bigint, 0), CONVERT(bigint, 0), 
			CONVERT(int, LEN(CONVERT(nvarchar(max), fgs.text)) * 2), CONVERT(nvarchar(3900), fgs.text)
	FROM (SELECT ecp.*, epa.attribute, epa.value
		FROM sys.dm_exec_cached_plans ecp OUTER APPLY sys.dm_exec_plan_attributes(ecp.plan_handle) epa) as ecpa
	PIVOT (MAX(ecpa.value) for ecpa.attribute IN (""set_options"", ""objectid"", ""dbid"", ""dbid_execute"", ""user_id"", ""language_id"", ""date_format"", ""status"")) as pvt
	OUTER APPLY sys.dm_exec_sql_text(pvt.plan_handle) fgs
"
3383	Parse Tree	View	-504	32767	6	4	1	5	8	251	0	1	1024	0	0	0	0	0	748	"CREATE VIEW sys.fulltext_stoplists AS
	SELECT 
		o.id AS stoplist_id,
		o.name AS name,
		o.created AS create_date,
		o.modified AS modify_date,
		p.indepid as principal_id 
	FROM sys.sysclsobjs o 
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 101 AND p.depsubid = 0	--SRC_FTSTPLIST_OWNER
	where o.class = 33
		AND has_access ('FS', o.id) = 1
"
3394	Parse Tree	View	-446	32767	6	4	1	4	7	251	0	1	1024	0	0	0	0	0	590	"CREATE VIEW sys.conversation_groups AS
	SELECT cg.conversation_group_id,
		cg.service_id,
		cg.is_system
	FROM sys.conversation_groups$ cg
	JOIN sys.syssingleobjrefs r ON r.depid = cg.service_id AND r.class = 21 AND r.depsubid = 0 -- SRC_SVCTOQUEUE
	WHERE has_access('CO', r.indepid) = 1
"
3395	Compiled Plan	Adhoc	780142916	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.service_queue_usages t
3399	Parse Tree	View	-275746705	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	734	"CREATE VIEW sys.dm_hadr_internal_availability_group_states AS
	SELECT
		group_id = IntAgStates.group_id,
		primary_replica = IntAgStates.primary_replica,
		configured_replica_count = IntAgStates.configured_replica_count,
		local_replica_role = IntAgStates.local_replica_role
	FROM
		OpenRowset(TABLE DM_HADR_INTERNAL_AVAILABILITY_GROUP_STATES) AS IntAgStates
"
3405	Parse Tree	View	-388	32767	6	4	1	14	12	251	0	1	1024	0	0	0	0	0	900	"CREATE VIEW sys.extended_procedures AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		dll_name = convert(nvarchar(260), v.value)
	FROM sys.objects$ o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 5 AND v.objid = o.object_id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_XPDLLNAME
	WHERE o.type = 'X '
"
3410	Parse Tree	View	-252014800	32767	6	4	1	5	4	251	0	1	1024	0	0	0	0	0	536	"
-- add it
create view sys.pdw_health_component_properties as
select
	component_id,
	property_id,
	property_name	collate database_default property_name,
	physical_name	collate database_default physical_name,
	is_key
from sys._pdw_health_component_properties
"
3422	Parse Tree	View	-255517258	32767	6	4	1	9	6	251	0	1	1024	0	0	0	0	0	720	"CREATE VIEW sys.dm_clr_appdomains AS
	SELECT
		appdomain_address,
		appdomain_id,
		appdomain_name,
		creation_time,
		db_id,
		user_id,
		state,
		strong_refcount,
		weak_refcount,
		cost,
		value,
		compatibility_level,
		total_processor_time_ms,
		total_allocated_memory_kb,
		survived_memory_kb
	FROM OpenRowset(TABLE DM_CLR_APPDOMAINS) 
"
3429	Parse Tree	View	-840336043	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	228	"CREATE VIEW sys.dm_exec_background_job_queue AS
	SELECT *
	FROM OpenRowSet(TABLE DM_EXEC_BACKGROUND_JOB_QUEUE)
"
3434	Parse Tree	View	-407809822	32767	6	4	1	11	4	251	0	1	1024	0	0	0	0	0	468	"
-- add it
create view sys.dm_exec_compute_nodes as
select
	compute_node_id,
	type collate database_default type,
	name collate database_default name,
	address collate database_default address
from sys._dm_exec_compute_nodes
"
3436	Parse Tree	View	-411581074	32767	6	4	1	2	40	251	0	1	1024	0	0	0	0	0	4696	"CREATE VIEW sys.dm_exec_query_stats AS
	SELECT
		sql_handle, statement_start_offset, statement_end_offset, plan_generation_num,
		plan_handle, creation_time, last_execution_time, execution_count, total_worker_time,
		last_worker_time, min_worker_time, max_worker_time, total_physical_reads, last_physical_reads,
		min_physical_reads, max_physical_reads, total_logical_writes, last_logical_writes, min_logical_writes,
		max_logical_writes, total_logical_reads, last_logical_reads, min_logical_reads, max_logical_reads,
		total_clr_time, last_clr_time, min_clr_time, max_clr_time, total_elapsed_time,
		last_elapsed_time, min_elapsed_time, max_elapsed_time, query_hash, query_plan_hash,
		total_rows, last_rows, min_rows, max_rows, statement_sql_handle, statement_context_id,
		total_dop, last_dop, min_dop, max_dop,
		total_grant_kb, last_grant_kb, min_grant_kb, max_grant_kb,
		total_used_grant_kb, last_used_grant_kb, min_used_grant_kb, max_used_grant_kb,
		total_ideal_grant_kb, last_ideal_grant_kb, min_ideal_grant_kb, max_ideal_grant_kb,
		total_reserved_threads, last_reserved_threads, min_reserved_threads, max_reserved_threads,
		total_used_threads, last_used_threads, min_used_threads, max_used_threads,
		total_columnstore_segment_reads, last_columnstore_segment_reads, min_columnstore_segment_reads, max_columnstore_segment_reads,
		total_columnstore_segment_skips, last_columnstore_segment_skips, min_columnstore_segment_skips, max_columnstore_segment_skips,
		total_spills, last_spills, min_spills, max_spills
	FROM OpenRowset (TABLE QUERY_STATS)
	UNION ALL
	SELECT
		sql_handle, statement_start_offset, statement_end_offset, NULL,
		plan_handle, creation_time, last_execution_time, execution_count, total_worker_time,
		last_worker_time, min_worker_time, max_worker_time, 0, 0,
		0, 0, 0, 0, 0,
		0, 0, 0, 0, 0,
		0, 0, 0, 0, total_elapsed_time,
		last_elapsed_time, min_elapsed_time, max_elapsed_time, NULL, NULL,
		NULL, NULL, NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL,
		NULL, NULL, NULL, NULL, -- columnstore_segment_reads
		NULL, NULL, NULL, NULL, -- columnstore_segment_skips
		NULL, NULL, NULL, NULL  -- spills
	FROM OpenRowset (TABLE XTP_STMT_STATS)
"
3438	Parse Tree	View	-214	32767	6	4	1	16	10	251	0	1	1024	0	0	0	0	0	1470	"CREATE VIEW sys.database_mirroring_witnesses AS
	SELECT database_name = w.name,
		principal_server_name = w.psrv,
		mirror_server_name = w.ssrv,
		safety_level = w.safety,
		safety_level_desc = s.name,
		safety_sequence_number = w.safetysequence,
		role_sequence_number = w.rolesequence,
		mirroring_guid = w.logshippingid,
		family_guid = w.familyid,
		is_suspended = sysconv(bit, 1 - w.status & 1),
		is_suspended_sequence_number = w.statussequence,
		partner_sync_state = dbmw.sync_state,
		partner_sync_state_desc = dbmw.sync_state_desc
	FROM master.sys.syslogshippers w
	LEFT JOIN sys.syspalvalues s ON s.class = 'DBSL' AND s.value = w.safety
	OUTER APPLY OpenRowset(TABLE DBMIRROR_WITNESS, w.logshippingid) dbmw
"
3450	Parse Tree	View	-206396075	32767	6	4	1	21	7	251	0	1	1024	0	0	0	0	0	1120	"
-- add it
create view sys.dm_exec_distributed_request_steps as
select
	execution_id	collate database_default execution_id,
	step_index,
	operation_type	collate database_default operation_type,
	distribution_type	collate database_default distribution_type,
	location_type	collate database_default location_type,
	status		collate database_default status,
	error_id	collate database_default error_id,
	start_time,
	end_time,
	total_elapsed_time,
	row_count,
	command		collate database_default command
from sys._dm_exec_distributed_request_steps
"
3457	Compiled Plan	Adhoc	929963295	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM INFORMATION_SCHEMA.SCHEMATA t
3459	Parse Tree	View	-467	32767	6	4	1	32	18	251	0	1	1024	0	0	0	0	0	2678	"CREATE VIEW sys.certificates AS
	SELECT c.name,
		c.id AS certificate_id,
		r.indepid AS principal_id,
		c.encrtype AS pvt_key_encryption_type,
		ce.name AS pvt_key_encryption_type_desc,
		sysconv(bit, ~c.status & 0x1) AS is_active_for_begin_dialog,
		convert(nvarchar(442), certproperty(c.id, 'issuer_name')) AS issuer_name,
		convert(nvarchar(64),  certproperty(c.id, 'cert_serial_number')) AS cert_serial_number,
		convert(varbinary(85), certproperty(c.id, 'sid')) AS sid,
		convert(nvarchar(128), certproperty(c.id, 'string_sid')) AS string_sid,
		convert(nvarchar(4000),certproperty(c.id, 'subject')) AS subject,
		convert(datetime, certproperty(c.id, 'expiry_date')) AS expiry_date,
		convert(datetime, certproperty(c.id, 'start_date')) AS start_date,
		c.thumbprint AS thumbprint,
		convert(nvarchar(260), v.value) AS attested_by,
		c.lastpkeybackup AS pvt_key_last_backup_date,
		convert(int, certproperty(c.id, 'key_length')) AS key_length
	FROM sys.syscerts c
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = c.id AND r.class = 62 AND r.depsubid = 0	-- SRC_CERTOWNER
	LEFT JOIN sys.syspalnames ce ON ce.class = 'CETY' AND ce.value = c.encrtype
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 33 AND v.objid = c.id AND v.subobjid = 0 AND v.valnum = 0	-- SVC_CRATTESTINGDLLPATH
	WHERE has_access('CE', c.id) = 1
"
3464	Parse Tree	View	-119413159	32767	6	4	1	11	4	251	0	1	1024	0	0	0	0	0	206	"CREATE VIEW sys.dm_server_audit_status AS
	SELECT *
	FROM OpenRowset(TABLE DM_SERVER_AUDIT_STATUS) 
"
3470	Parse Tree	View	-409	32767	6	4	1	26	18	187	0	1	1024	0	0	0	0	0	1804	"CREATE VIEW sys.foreign_keys AS
	SELECT o.name, o.object_id, o.principal_id, o.schema_id, o.parent_object_id,
		o.type, o.type_desc, o.create_date, o.modify_date,
		o.is_ms_shipped, o.is_published, o.is_schema_published,
		f.indepid AS referenced_object_id,
		f.indepsubid AS key_index_id,
		o.is_disabled, o.is_not_for_replication, o.is_not_trusted,
		o.delete_referential_action,	-- ERefAct
		d.name AS delete_referential_action_desc,
		o.update_referential_action,	-- ERefAct
		u.name AS update_referential_action_desc,
		o.is_system_named
	FROM sys.objects$ o
	LEFT JOIN sys.syssingleobjrefs f ON f.depid = o.object_id AND f.class = 27 AND f.depsubid = 0	-- SRC_FK_REFD_INDEX
	LEFT JOIN sys.syspalvalues d ON d.class = 'FKRA' AND d.value = o.delete_referential_action
	LEFT JOIN sys.syspalvalues u ON u.class = 'FKRA' AND u.value = o.update_referential_action
	WHERE o.type = 'F '
"
3484	Parse Tree	View	-46687631	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	188	"CREATE VIEW sys.dm_os_memory_nodes AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_MEMORY_NODES)
"
3492	Parse Tree	View	-529134704	32767	6	4	1	11	5	251	0	1	1024	0	0	0	0	0	178	"CREATE view sys.dm_fts_active_catalogs
AS
	SELECT * FROM OpenRowset(TABLE FTCATALOGS)
"
3503	Parse Tree	View	-235	32767	6	4	1	25	26	251	0	1	1024	0	0	0	0	0	3162	"CREATE VIEW sys.database_mirroring_endpoints AS
	SELECT
		e.name,
		endpoint_id = e.id,
		principal_id = o.indepid,
		e.protocol,
		protocol_desc = p.name,
		e.type,
		type_desc = t.name,
		state = convert(tinyint, e.bstat & 3),	-- BSTAT_STATEMASK
		state_desc = s.name,
		sysconv(bit, case when e.affinity = -1 then 1 else 0 end) AS is_admin_endpoint, 
		role = convert(tinyint, e.tstat & 7),		-- TSTAT_DM_ROLEMASK
		role_desc = cr.name,
		sysconv(bit, case when e.encalg = 0 then 0 else 1 end) AS is_encryption_enabled,
		-- Authentication and encryption options. Identical in SSB and DBM endpoints
		connection_auth = e.authtype,		
		connection_auth_desc = ca.name,
		certificate_id = ISNULL(co.indepid, 0),
		encryption_algorithm = e.encalg,
		encryption_algorithm_desc = ag.name
	FROM master.sys.sysendpts e
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = e.id AND o.class = 60 AND o.depsubid = 0	-- SRC_ENDPTLOGINOWNER
	LEFT JOIN sys.syspalvalues p ON p.class = 'EPPR' AND p.value = e.protocol
	LEFT JOIN sys.syspalvalues t ON t.class = 'EPTY' AND t.value = e.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'EPST' AND s.value = e.bstat & 3
	LEFT JOIN sys.syspalvalues cr ON cr.class = 'EPMR' AND cr.value = e.tstat & 7
	LEFT JOIN sys.syspalvalues ca ON ca.class = 'EPCA' AND ca.value = e.authtype
	LEFT JOIN sys.syspalvalues ag ON ag.class = 'EPCE' AND ag.value = e.encalg
	LEFT JOIN sys.syssingleobjrefs co ON co.class = 25 and co.depid = e.id  AND co.depsubid = 0  -- SRC_ENDPT_CERTIFICATE
	WHERE e.type = 4
		AND has_access('HE', e.id) = 1
"
3513	Parse Tree	View	-546	32767	6	4	1	2	3	187	0	1	1024	0	0	0	0	0	246	"CREATE VIEW sys.plan_persist_query_text_in_memory AS
	SELECT
		*
	FROM OpenRowset(TABLE QUERY_STORE_QUERY_TEXT_IN_MEM)
"
3517	Parse Tree	View	-217345680	32767	6	4	1	4	67	251	0	1	1024	0	0	0	0	0	11928	"CREATE VIEW sys.sql_expression_dependencies$ AS
	SELECT
		dp.depid AS referencing_id,
		0 as referencing_minor_id,
		dp.depclass AS referencing_class,
		i.name AS referencing_class_desc,
		s.name as referencing_schema_name,
		o2.name as referencing_entity_name,
		sysconv(bit, 0) AS is_schema_bound_reference,
		dp.indepclass AS referenced_class,
		i2.name AS referenced_class_desc,
		dp.indepserver AS referenced_server_name,
		dp.indepdb AS referenced_database_name,
		dp.indepschema AS referenced_schema_name,
		dp.indepname AS referenced_entity_name,
		Entity_Id(dp.indepserver, dp.indepdb, dp.indepschema, dp.indepname, dp.indepclass, sysconv(bit, dp.status & 1), dp.depid) AS referenced_id,
		0 as referenced_minor_id,
		NULL as referenced_minor_name,
		sysconv(bit, dp.status & 1) AS is_caller_dependent,
		sysconv(bit, dp.status & 4) AS is_ambiguous,
		sysconv(bit, 0) AS is_selected,
		sysconv(bit, 0) AS is_updated,
		sysconv(bit, 0) AS is_select_all,
		sysconv(bit, 0) AS is_insert_all
	FROM sys.syssoftobjrefs dp 
		LEFT JOIN sys.syspalvalues i ON i.class = 'UNCL' AND i.value = dp.depclass
		LEFT JOIN sys.syspalvalues i2 ON i2.class = 'UNCL' AND i2.value = dp.indepclass
		LEFT JOIN sys.sysschobjs$ o2 ON o2.id = dp.depid AND ((o2.nsclass = 0 AND o2.pclass = 1) OR o2.type IN ('TA','TR')) -- x_eonc_Standard:x_eunc_Object
		LEFT JOIN sys.sysclsobjs s ON s.id = o2.nsid AND s.class = 50	-- SOC_SCHEMA
	UNION ALL 		-- Can be a union all because we only store non-schema-bound dependencies in syssoftobjrefs and we select only schema bound dependencies 
					-- from sysmultiobjrefs.
	SELECT
		dp.depid AS referencing_id,
		dp.depsubid as referencing_minor_id,
		sysconv(tinyint, CASE WHEN dp.class = 5 AND (dp.status & 8)=0 THEN 7 WHEN dp.class = 5 THEN 9 ELSE 1 END) AS referencing_class,
		i2.name AS referencing_class_desc,
		s.name as referencing_schema_name,
		o2.name as referencing_entity_name,
		sysconv(bit, 1) AS is_schema_bound_reference,
		sysconv(tinyint, CASE dp.class 
			WHEN 1 THEN 1  -- MRC_EXPRTOOBJ       -> OBJECT_OR_COLUMN
			WHEN 2 THEN 6  -- MRC_EXPRTOTYPE      -> TYPE
			WHEN 3 THEN 10 -- MRC_EXPRTOXMLNS     -> XML_SCHEMA_COLLECTION
			WHEN 4 THEN 21 -- MRC_EXPRTOPRTFUNC   -> PARTITION_FUNCTION
			WHEN 5 THEN 1  -- MRC_EXPRFILTERTOOBJ -> OBJECT_OR_COLUMN
			WHEN 6 THEN 7  -- MRC_EXPRTOINDEX     -> INDEX
			END) AS referenced_class,
		i.name AS referenced_class_desc,
		NULL AS referenced_server_name,
		NULL AS referenced_database_name,
		CASE dp.class 
			WHEN 1 THEN SCHEMA_NAME(o.nsid)  -- MRC_EXPRTOOBJ       -> object schema name
			WHEN 2 THEN SCHEMA_NAME(t.schid) -- MRC_EXPRTOTYPE      -> type schema name
			WHEN 3 THEN SCHEMA_NAME(x.nsid)  -- MRC_EXPRTOXMLNS     -> XML schema collection schema name
			WHEN 4 THEN NULL                 -- MRC_EXPRTOPRTFUNC   -> partition functions are DB-scoped
			WHEN 5 THEN SCHEMA_NAME(o.nsid)  -- MRC_EXPRFILTERTOOBJ -> object schema name
			WHEN 6 THEN SCHEMA_NAME(o.nsid)  -- MRC_EXPRTOINDEX     -> parent object schema name
			END AS referenced_schema_name,
		CASE dp.class 
			WHEN 1 THEN o.name  -- MRC_EXPRTOOBJ  -> object name
			WHEN 2 THEN t.name  -- MRC_EXPRTOTYPE -> type name
			WHEN 3 THEN x.name  -- MRC_EXPRTOXMLNS -> XML schema collection name
			WHEN 4 THEN pf.name -- MRC_EXPRTOPRTFUNC -> partition function name
			WHEN 5 THEN o.name  -- MRC_EXPRFILTERTOOBJ -> object name
			WHEN 6 THEN o.name  -- MRC_EXPRTOINDEX -> parent object name
			END AS referenced_entity_name,
		dp.indepid AS referenced_id,
		dp.indepsubid as referenced_minor_id,
		CASE dp.class 
			WHEN 1 THEN c.name   -- MRC_EXPRTOOBJ       -> column name
			WHEN 5 THEN c.name   -- MRC_EXPRFILTERTOOBJ -> column name
			WHEN 6 THEN idx.name -- MRC_EXPRTOINDEX     -> index name
			ELSE NULL
			END AS referenced_minor_name,
		sysconv(bit, 0) AS is_ca"
3523	Parse Tree	View	-187256606	32767	6	4	1	16	5	251	0	1	1024	0	0	0	0	0	772	"
-- add it
create view sys.dm_exec_compute_node_errors as
select
	error_id	collate database_default error_id,
	source	collate database_default source,
	type	collate database_default type,
	create_time,
	compute_node_id,
	execution_id	collate database_default execution_id,
	spid,
	thread_id,
	details	collate database_default details
from sys._dm_exec_compute_node_errors
"
3524	Parse Tree	View	-922655422	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	218	"CREATE VIEW sys.dm_db_session_space_usage  AS
	SELECT *
	FROM OpenRowset(TABLE DM_DB_SESSION_SPACE_USAGE)
"
3524	Parse Tree	View	-488	32767	6	4	1	2	10	251	0	1	1024	0	0	0	0	0	1232	"CREATE VIEW sys.system_internals_allocation_units AS
	SELECT au.auid AS allocation_unit_id,
		au.type,
		ip.name AS type_desc,
		au.ownerid AS container_id,
		au.fgid AS filegroup_id,
		isnull(ct.reserved_pages, au.pcreserved) AS total_pages,
		isnull(ct.used_pages, au.pcused) AS used_pages,
		isnull(ct.data_pages, au.pcdata) AS data_pages,
		au.pgfirst AS first_page,
		au.pgroot AS root_page,
		au.pgfirstiam AS first_iam_page
	FROM sys.sysallocunits au OUTER APPLY OpenRowset(TABLE ALUCOUNT, au.ownerid, au.type, 0, 0) ct
	LEFT JOIN sys.syspalvalues ip ON ip.class = 'AUTY' AND ip.value = au.type
"
3526	Parse Tree	View	-214867882	32767	6	4	1	27	7	251	0	1	1024	0	0	0	0	0	1098	"CREATE VIEW sys.dm_tran_locks AS
	SELECT	resource_type,
			resource_subtype,
			resource_database_id,
			resource_description,
			resource_associated_entity_id,
			resource_lock_partition,
			request_mode,
			request_type,
			request_status,
			request_reference_count,
			request_lifetime,
			request_session_id,
			request_exec_context_id,
			request_request_id,
			request_owner_type,
			request_owner_id,
			request_owner_guid,
			request_owner_lockspace_id,
			lock_owner_address
	FROM OpenRowSet(TABLE SYSLOCKINFORMATION)
"
3535	Parse Tree	View	-430	32767	6	4	1	18	12	251	0	1	1024	0	0	0	0	0	1616	"CREATE VIEW sys.assemblies AS
	SELECT s.name AS name, 
		r.indepid AS principal_id,
		s.id AS assembly_id,
		convert(nvarchar(4000), assemblyproperty(s.name, 'CLRName')) collate Latin1_General_BIN AS clr_name,
		convert(tinyint, s.intprop) AS permission_set,
		i.name AS permission_set_desc,
		sysconv(bit, s.status & 1) AS is_visible,	-- ASM_EXPLICIT_REG
		s.created AS create_date,
		s.modified AS modify_date,
		convert(bit, case when s.id < 65536 then 0 else 1 end) AS is_user_defined       -- x_MinUserAssemblyID
	FROM sys.sysclsobjs s
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = s.id AND r.class = 52 AND r.depsubid = 0	-- SRC_ASMOWNER
	LEFT JOIN sys.syspalvalues i ON i.class = 'ASPS' AND i.value = s.intprop
	WHERE s.class = 10
		AND has_access('AS', s.id) = 1	-- SOC_ASSEMBLY
		
"
3538	Parse Tree	View	-620952411	32767	6	4	1	2	19	251	0	1	1024	0	0	0	0	0	5288	"CREATE VIEW sys.dm_db_xtp_table_memory_stats$
AS
	SELECT	C.object_id,
		C.database_id,
		-- 'V.table_allocated_bytes' are the allocated bytes for table allocators as found in 'sys.dm_xtp_consumer_memory_usage'.
		V.table_allocated_bytes / 1024 AS memory_allocated_for_table_kb, 
		-- 'V.allocated_byte_sum' are the bytes used by by table rows as found in 'sys.dm_xtp_table_memory_usage'.
		-- Note: This really should be equivalent to the used bytes reported by 'sys.dm_xtp_consumer_memory_usage'.
		T.allocated_byte_sum / 1024 AS memory_used_by_table_kb,
		-- 'C.index_allocated_bytes' are the bytes allocated for indexes for this table as found in 'sys.dm_xtp_consumer_memory_usage'.
		C.index_allocated_bytes / 1024 AS memory_allocated_for_indexes_kb,
		-- 'C.index_used_bytes' are the bytes used by indexes in this table as found in 'sys.dm_xtp_consumer_memory_usage'.
		C.index_used_bytes / 1024 AS memory_used_by_indexes_kb
	-- GROUP BYs here and below are needed because some user tables have multiple internal tables in Hekaton representing them, and hence
	-- multiple entries in 'sys.dm_xtp_table_memory_usage' and 'sys.dm_xtp_consumer_memory_usage'
	FROM (SELECT
		object_id,
		database_id,
		SUM(allocated_bytes) as allocated_byte_sum
	  FROM sys.dm_xtp_table_memory_usage$ 
	  GROUP BY database_id, object_id) T
	-- Force merge joins to ensure good plans/performance.  Due to the lack of stats for the underlying STVFs
	-- that make us this view, we get poor cardinality estimates which leads to a slow nested loops join plan.
	INNER MERGE JOIN
	  (SELECT 
		object_id, 
		database_id, 
		sum(allocated_bytes) as index_allocated_bytes,
		sum(used_bytes) as index_used_bytes
	  FROM sys.dm_xtp_consumer_memory_usage
	  -- range index memory consumers have type VARHEAP and non-null index id
	  -- hash index memory consumers have type HASH
	  WHERE memory_consumer_type = 3 /*hash*/ OR (memory_consumer_type = 2 /*VARHEAP*/ AND index_id IS NOT NULL)
	  GROUP BY database_id, object_id) C
	-- Add a 0 = 0 equijoin predicate to ensure that a merge join is always possible
	-- even if we have an explicit object_id = X predicate.
	ON (C.object_id = T.object_id AND C.database_id = T.database_id AND 0 * C.database_id = 0 * T.database_id)
	LEFT MERGE JOIN
	  (SELECT object_id, database_id, SUM(allocated_bytes) as table_allocated_bytes
	  FROM sys.dm_xtp_consumer_memory_usage
	  WHERE memory_consumer_type = 2 /* VARHEAP */ AND index_id IS NULL
	  GROUP BY database_id, object_id) V
	ON (V.object_id = T.object_id AND V.database_id = T.database_id AND 0 * V.database_id = 0 * T.database_id)
"
3545	Parse Tree	View	-806458395	32767	6	3	1	33	13	251	0	1	1024	0	0	0	0	0	1260	"CREATE VIEW INFORMATION_SCHEMA.TABLE_CONSTRAINTS
AS
SELECT
	DB_NAME()			AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(c.schema_id)	AS CONSTRAINT_SCHEMA,
	c.name				AS CONSTRAINT_NAME,
	DB_NAME()			AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS TABLE_SCHEMA,
	t.name				AS TABLE_NAME,
	CASE c.type
		WHEN 'C ' THEN	'CHECK'
		WHEN 'UQ' THEN	'UNIQUE'
		WHEN 'PK' THEN	'PRIMARY KEY'
		WHEN 'F ' THEN	'FOREIGN KEY'
	  END				AS CONSTRAINT_TYPE,
	'NO'				AS IS_DEFERRABLE,
	'NO'				AS INITIALLY_DEFERRED
FROM
	sys.objects c LEFT JOIN sys.tables t
	ON t.object_id	= c.parent_object_id
WHERE
	c.type IN ('C' ,'UQ' ,'PK' ,'F')
"
3548	Parse Tree	View	-594107644	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	226	"CREATE VIEW sys.dm_tran_current_transaction AS
	SELECT * 
	FROM OpenRowset(TABLE DM_TRAN_CURRENT_TRANSACTION)
"
3548	Parse Tree	View	-898665619	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	260	"
-- add it
create view sys.dm_pdw_nodes_clr_properties as
select *, convert(int, null) pdw_node_id from sys.dm_clr_properties
"
3549	Parse Tree	View	-729637661	32767	6	3	1	23	14	251	0	1	1024	0	0	0	0	0	1126	"CREATE VIEW INFORMATION_SCHEMA.VIEW_COLUMN_USAGE
AS
SELECT
	DB_NAME()					AS VIEW_CATALOG,
	SCHEMA_NAME(v.schema_id)	AS VIEW_SCHEMA,
	v.name						AS VIEW_NAME,
	DB_NAME()					AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)	AS TABLE_SCHEMA,
	t.name						AS TABLE_NAME,
	c.name						AS COLUMN_NAME
FROM
	sys.views v JOIN sys.sql_dependencies d ON d.object_id = v.object_id
	JOIN sys.objects t ON t.object_id = d.referenced_major_id
	JOIN sys.columns c ON c.object_id = d.referenced_major_id
		AND c.column_id = d.referenced_minor_id
WHERE
	d.class < 2
"
3557	Parse Tree	View	-272908812	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	794	"CREATE VIEW sys.availability_group_listeners AS
	SELECT
		group_id = agl.group_id,
		listener_id = CAST(agl.listener_id AS nvarchar(36)),
		dns_name = CAST(agl.dns_name AS nvarchar(63)),
		port = CAST(agl.port AS int),
		is_conformant = agl.is_conformant,
		ip_configuration_string_from_cluster = agl.ip_configuration_string_from_cluster
	FROM
		sys.dm_hadr_internal_ag_listeners AS agl
"
3559	Parse Tree	View	-1047118026	32767	6	4	1	8	4	251	0	1	1024	0	0	0	0	0	144	"CREATE VIEW sys.openkeys AS
	SELECT * FROM OpenRowset(TABLE OPENKEYS)
"
3568	Parse Tree	View	-256	32767	6	4	1	10	16	251	0	1	1024	0	0	0	0	0	2310	"CREATE VIEW sys.cryptographic_providers AS
	SELECT
		co.id AS provider_id,
		co.name,
		g.guid as guid,	
		convert(nvarchar(10), co.intprop) + '.' + -- Major (MAX INT => 10 chars)
		convert(nvarchar(3), (convert(bigint,p2.value)/(power(2,24)))) + '.' + 	  -- Minor [p2.value >> 24] (1 byte => 3 chars)
		convert(nvarchar(5), (convert(bigint,p2.value)/power(2,8)) & 65535) + '.' + -- Build [p2.value >> 8 & 0x0000FFFF] (2 bytes => 5 chars)
		convert(nvarchar(3), (convert(bigint,p2.value) & 255)) as version,		  -- Revision [p2.value & 0x000000FF] (1 byte => 3 chars)
		convert(nvarchar(520), p.value) as dll_path, 
		sysconv(bit, co.status & 1) AS is_enabled
	FROM master.sys.sysclsobjs co
	LEFT JOIN master.sys.sysguidrefs g ON g.class = 4 AND g.id= co.id AND g.subid = 0  -- GRC_CPGUID
	LEFT JOIN master.sys.sysobjvalues p ON p.valclass = 47 AND p.objid = co.id AND p.subobjid = 0 AND p.valnum = 1 -- SVC_CRYPTOPROVIDER/PROV_DLLPATH_PROP
	LEFT JOIN master.sys.sysobjvalues p2 ON p2.valclass = 47 AND p2.objid = co.id AND p2.subobjid = 0 AND p2.valnum = 2 -- SVC_CRYPTOPROVIDER/PROV_DLLPATH_VER
	WHERE co.class = 63 -- SOC_CRYPTOPROVIDER
"
3570	Parse Tree	View	-680277963	32767	6	4	1	20	15	251	0	1	1024	0	0	0	0	0	2224	"CREATE VIEW sys.database_query_store_options AS
	SELECT
		desired_state,
		d.name as desired_state_desc,
		actual_state,
		a.name as actual_state_desc,
		readonly_reason,
		current_storage_size_mb,
		flush_interval_seconds,
		interval_length_minutes,
		max_storage_size_mb,
		stale_query_threshold_days,
		max_plans_per_query,
		query_capture_mode,
		c.name as query_capture_mode_desc,
		size_based_cleanup_mode,
		r.name as size_based_cleanup_mode_desc,
		wait_stats_capture_mode,
		w.name as wait_stats_capture_mode_desc,
		convert(nvarchar(4000), N'') COLLATE Latin1_General_CI_AS_KS_WS  as actual_state_additional_info
	FROM OpenRowSet(TABLE QUERY_STORE_OPTIONS)
	LEFT JOIN  sys.syspalvalues a ON a.class = 'QDST' AND a.value = actual_state
	LEFT JOIN  sys.syspalvalues d ON d.class = 'QDST' AND d.value = desired_state
	LEFT JOIN  sys.syspalvalues c ON c.class = 'QDCM' AND c.value = query_capture_mode
	LEFT JOIN  sys.syspalvalues r ON r.class = 'QDRP' AND r.value = size_based_cleanup_mode
	LEFT JOIN  sys.syspalvalues w ON w.class = 'QDWS' AND w.value = wait_stats_capture_mode
"
3573	Parse Tree	View	-693561101	32767	6	3	1	122	49	251	0	1	1024	0	0	0	0	0	8872	"CREATE VIEW INFORMATION_SCHEMA.ROUTINES
AS
SELECT
	DB_NAME()					AS SPECIFIC_CATALOG,
	SCHEMA_NAME(o.schema_id)	AS SPECIFIC_SCHEMA,
	o.name						AS SPECIFIC_NAME,
	DB_NAME()					AS ROUTINE_CATALOG,
	SCHEMA_NAME(o.schema_id)	AS ROUTINE_SCHEMA,
	o.name						AS ROUTINE_NAME,
	convert(nvarchar(20), CASE
		WHEN o.type IN ('P','PC')
		THEN 'PROCEDURE'
		ELSE 'FUNCTION' END)		AS ROUTINE_TYPE,
	convert(sysname, null)			AS MODULE_CATALOG,
	convert(sysname, null) collate catalog_default		AS MODULE_SCHEMA,
	convert(sysname, null) collate catalog_default		AS MODULE_NAME,
	convert(sysname, null)			AS UDT_CATALOG,
	convert(sysname, null) collate catalog_default		AS UDT_SCHEMA,
	convert(sysname, null) collate catalog_default		AS UDT_NAME,
	convert(sysname, CASE
		WHEN o.type IN ('TF', 'IF', 'FT') THEN N'TABLE'
		ELSE ISNULL(TYPE_NAME(c.system_type_id),
			TYPE_NAME(c.user_type_id)) END)		AS DATA_TYPE,
	COLUMNPROPERTY(c.object_id, c.name, 'charmaxlen')	AS CHARACTER_MAXIMUM_LENGTH,
	COLUMNPROPERTY(c.object_id, c.name, 'octetmaxlen')	AS CHARACTER_OCTET_LENGTH,
	convert(sysname, null)			AS COLLATION_CATALOG,
	convert(sysname, null) collate catalog_default		AS COLLATION_SCHEMA,
	convert(sysname, CASE
		WHEN c.system_type_id IN (35, 99, 167, 175, 231, 239)	-- [n]char/[n]varchar/[n]text
		THEN DATABASEPROPERTYEX(DB_NAME(), 'collation') END)	AS COLLATION_NAME,
	convert(sysname, null)			AS CHARACTER_SET_CATALOG,
	convert(sysname, null) collate catalog_default		AS CHARACTER_SET_SCHEMA,
	convert(sysname, CASE
		WHEN c.system_type_id IN (35, 167, 175)
		THEN SERVERPROPERTY('sqlcharsetname') -- char/varchar/text
		WHEN c.system_type_id IN (99, 231, 239)
		THEN N'UNICODE'	-- nchar/nvarchar/ntext
		END)				AS CHARACTER_SET_NAME,
	convert(tinyint, CASE -- int/decimal/numeric/real/float/money
		WHEN c.system_type_id IN (48, 52, 56, 59, 60, 62, 106, 108, 122, 127) THEN c.precision
		END)										AS NUMERIC_PRECISION,
	convert(smallint, CASE	-- int/money/decimal/numeric
		WHEN c.system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
		WHEN c.system_type_id IN (59, 62) THEN 2 END)	AS NUMERIC_PRECISION_RADIX, -- real/float
	convert(int, CASE	-- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN NULL
		ELSE ODBCSCALE(c.system_type_id, c.scale) END)	AS NUMERIC_SCALE,
	convert(smallint, CASE -- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN ODBCSCALE(c.system_type_id, c.scale) END)	AS DATETIME_PRECISION,
	convert(nvarchar(30), null)			AS INTERVAL_TYPE,
	convert(smallint, null)				AS INTERVAL_PRECISION,
	convert(sysname, null)				AS TYPE_UDT_CATALOG,
	convert(sysname, null) collate catalog_default	AS TYPE_UDT_SCHEMA,
	convert(sysname, null) collate catalog_default	AS TYPE_UDT_NAME,
	convert(sysname, null)				AS SCOPE_CATALOG,
	convert(sysname, null) collate catalog_default		AS SCOPE_SCHEMA,
	convert(sysname, null) collate catalog_default		AS SCOPE_NAME,
	convert(bigint, null)				AS MAXIMUM_CARDINALITY,
	convert(sysname, null)				AS DTD_IDENTIFIER,
	convert(nvarchar(30), CASE
		WHEN o.type IN ('P ', 'FN', 'TF', 'IF') THEN 'SQL'
		ELSE 'EXTERNAL' END)			AS ROUTINE_BODY,
	convert(nvarchar(4000),
		OBJECT_DEFINITION(o.object_id))	AS ROUTINE_DEFINITION,
	convert(sysname, null)				AS EXTERNAL_NAME,
	convert(nvarchar(30), null)			AS EXTERNAL_LANGUAGE,
	convert(nvarchar(30), null)			AS PARAMETER_STYLE,
	convert(nvarchar(10), CASE
		WHEN ObjectProperty(o.object_id, 'IsDeterministic') = 1
		THEN 'YES' ELSE 'NO' END)		AS IS_DETERMINISTIC,
	convert(nvarchar(30), CASE
		WHEN o.type IN ('P', 'PC') THEN 'MODIFIES'
		ELSE 'READS' END)				AS SQL_DATA_ACCESS,
	convert(nvarchar(10), CASE
		WHEN o.type in ('P', 'PC') THEN null
		WHEN o.null_on_null_input = 1 THEN 'YES'
		ELSE 'NO' END)				AS IS_NULL_CALL,
	convert(sysname, null)				AS SQL_PAT"
3578	Parse Tree	View	-567	32767	6	4	1	5	8	251	0	1	1024	0	0	0	0	0	914	"CREATE VIEW sys.remote_data_archive_databases AS
	SELECT 
		sc.id as remote_database_id,
		sc.name as remote_database_name,
		sc.intprop as data_source_id,
		convert(bit, case when eds.credential_id = 0 then 1 else 0 end) as federated_service_account
	FROM sys.sysclsobjs sc LEFT OUTER JOIN sys.external_data_sources eds
		ON sc.intprop = eds.data_source_id
	WHERE sc.class = 103 -- SOC_STRETCH_REMOTE_DATABASE
	 AND has_access('DB', DB_ID()) = 1
"
3579	Parse Tree	View	-198	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	174	"CREATE VIEW sys.syscursorcolumns AS
	SELECT *
	FROM OpenRowSet(TABLE SYSCURSORCOLS)
"
3590	Parse Tree	View	-140	32767	6	4	1	6	24	251	0	1	1024	0	0	0	0	0	3202	"-- Note: gid (max group id) not maintained, shiloh logic not correct anyway
--
CREATE VIEW sys.sysusers AS
	SELECT uid = convert(smallint, u.id),
		status = convert(smallint, case u.type
			when 'U' then 12 when 'G' then 4 when 'A' then 32 else 0 end),
		u.name, u.sid,
		roles = convert(varbinary(2048), null),
		createdate = u.created,
		updatedate = u.modified,
		altuid = convert(smallint, r.indepid),
		password = convert(varbinary(256), null),
		gid = convert(smallint, case u.type when 'R' then u.id else 0 end),
		environ = convert(varchar(255), null),
		hasdbaccess = convert(int, case when p.state in ('G','W') then 1 else 0 end),
		islogin = convert(int, case u.type when 'A' then 0 when 'R' then 0 else 1 end),
		isntname = convert(int, case u.type when 'U' then 1 when 'G' then 1 else 0 end),	-- USR_SID_EXTERNAL
		isntgroup = convert(int, case u.type when 'G' then 1 else 0 end),
		isntuser = convert(int, case u.type when 'U' then 1 else 0 end),	-- USR_SID_EXTERNAL
		issqluser = convert(int, case u.type when 'S' then 1 else 0 end),
		isaliased = convert(int, 0),   -- Aliases were deprecated and removed
		issqlrole = convert(int, case u.type when 'R' then 1 else 0 end),
		isapprole = convert(int, case u.type when 'A' then 1 else 0 end)
	FROM sys.sysowners u
	LEFT JOIN sys.sysprivs p ON p.class = 0 AND p.id = 0 AND p.subid = 0 AND p.grantee = u.id AND p.grantor = 1 AND p.type = 'CO'
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = u.id AND r.depsubid = 0 AND r.class = case u.type when 'R' then 51 end -- SRC_ROLEOWNER
	WHERE has_access('US', u.id) = 1
"
3595	Compiled Plan	Adhoc	776088704	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_db_mirroring_past_actions t
3600	Parse Tree	View	-451	32767	6	4	1	20	19	251	0	1	1024	0	0	0	0	0	1974	"CREATE VIEW sys.xml_schema_components AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id
	FROM sys.sysxmlcomponent c
	LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	WHERE has_access('XC', c.id, c.xsdid) = 1
"
3611	Parse Tree	View	-273579653	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	202	"CREATE VIEW sys.dm_broker_activated_tasks AS
    SELECT * FROM OpenRowset (TABLE SBACTIVATEDTASKS)
"
3611	Parse Tree	View	-393	32767	6	4	1	21	21	187	0	1	1024	0	0	0	0	0	2854	"CREATE VIEW sys.parameters AS
	SELECT object_id, p.name,
		parameter_id, system_type_id,
		user_type_id, max_length,
		precision, scale,
		is_output, is_cursor_ref,
		has_default_value, is_xml_document,
		default_value, xml_collection_id,
		is_readonly, is_nullable,
		convert(int, (convert(bigint, sov.value) / 0x100) % 0x100) as encryption_type,
		convert(nvarchar(64), v1.name) as encryption_type_desc,
		convert(sysname, v2.name) as encryption_algorithm_name,
		sor.indepid as column_encryption_key_id,
		convert(sysname, sov2.value) collate catalog_default as column_encryption_key_database_name
	FROM sys.parameters$ p
	LEFT JOIN sys.sysobjvalues sov ON sov.valclass = 121 /*SVC_PARAM_ENCRYPTION_MD*/ and sov.objid = p.object_id and sov.subobjid = p.parameter_id and sov.valnum = 0 -- TYPE_AND_ALGORITHM
	LEFT JOIN sys.sysobjvalues sov2 ON sov2.valclass = 121 /*SVC_PARAM_ENCRYPTION_MD*/ and sov2.objid = p.object_id and sov2.subobjid = p.parameter_id and sov2.valnum = 2 -- CEK_DATABASE_NAME
	LEFT JOIN sys.syssingleobjrefs sor ON sor.class = 114 /*SRC_PARAM_TO_COL_ENCRYPTION_KEY*/ and sov.objid = sor.depid and sov.subobjid = sor.depsubid
	LEFT JOIN sys.syspalvalues v1 ON v1.class = 'CET' AND v1.value = convert(int, (convert(bigint, sov.value) / 0x100) % 0x100)
	LEFT JOIN sys.syspalvalues v2 ON v2.class = 'CEA' AND v2.value = convert(int, convert(bigint, sov.value) % 0x100)
	WHERE number = 1
"
3624	Parse Tree	View	-536625975	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	236	"CREATE VIEW sys.dm_xtp_transaction_recent_rows
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_TRANSACTION_RECENT_ROWS)
"
3625	Compiled Plan	Adhoc	593487442	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.fulltext_stopwords t
3641	Parse Tree	View	-25821478	32767	6	4	1	11	6	251	0	1	1024	0	0	0	0	0	208	"CREATE VIEW sys.dm_tran_global_transactions AS
	SELECT *
	FROM OpenRowset(TABLE GLOBAL_TRANSACTIONS)
"
3643	Parse Tree	View	-588	32767	6	4	1	10	13	251	0	1	1024	0	0	0	0	0	2002	"CREATE VIEW sys.external_libraries AS
	SELECT 
		co.id AS external_library_id,
		convert(sysname, ov1.value) collate catalog_default AS name,
		sor.indepid AS principal_id,
		convert(sysname, ov2.value) collate catalog_default AS language,
		CASE sor.indepid
			WHEN 1 THEN 0 -- DBO
			ELSE 1
		END AS scope,
		CASE sor.indepid
			WHEN 1 THEN 'PUBLIC' -- DBO
			ELSE 'PRIVATE'
		END collate Latin1_General_CI_AS_KS_WS AS scope_desc
	FROM
		sys.sysclsobjs co LEFT JOIN
		sys.sysobjvalues ov1 ON
		(
			co.id = ov1.objid AND
			ov1.valclass = 129 AND -- SVC_EXTERNAL_LIBRARY
			ov1.valnum = 1 -- EXTLIB_NAME
		) LEFT JOIN
		sys.sysobjvalues ov2 ON
		(
			co.id = ov2.objid AND
			ov2.valclass = 129 AND -- SVC_EXTERNAL_LIBRARY
			ov2.valnum = 2 -- EXTLIB_RUNTIME
		) LEFT JOIN
		sys.syssingleobjrefs sor ON
		(
			sor.depid = co.id AND sor.class = 122 -- SRC_EXTERNAL_LIBRARY_OWNER
		)
	WHERE
		co.class = 105 AND -- SOC_EXTERNAL_LIBRARY
		has_access('EL', co.id) = 1
"
3644	Parse Tree	View	-219	32767	6	4	1	19	11	251	0	1	1024	0	0	0	0	0	1310	"CREATE VIEW sys.server_permissions AS
	SELECT p.class, cn.name AS class_desc,
		p.id AS major_id,
		p.subid AS minor_id,
		p.grantee AS grantee_principal_id,
		p.grantor AS grantor_principal_id,
		p.type, permission_name(p.class, p.type) AS permission_name,
		p.state, sn.name AS state_desc
	FROM master.sys.sysprivs p
	LEFT JOIN sys.syspalvalues cn ON cn.class = 'UNCL' AND cn.value = p.class
	LEFT JOIN sys.syspalnames sn ON sn.class = 'PRST' AND sn.value = p.state
	WHERE p.class >= 100
		AND (has_access('LG', p.grantee, p.grantor) = 1 OR has_access('CT', p.class, p.id) = 1)
		AND p.type <> 'EXTR' -- exclude trusted execute permission
"
3647	Parse Tree	View	-758382325	32767	6	4	1	2	12	251	0	1	1024	0	0	0	0	0	2378	"CREATE VIEW sys.dm_db_xtp_checkpoint_stats
AS
	SELECT	[last_lsn_processed],
			[end_of_log_lsn],
			[bytes_to_end_of_log],
			[log_consumption_rate],
			[active_scan_time_in_ms],
			[total_wait_time_in_ms],
			[waits_for_io_count],
			[io_wait_time_in_ms],
			[waits_for_new_log_count],
			[new_log_wait_time_in_ms],
			[idle_attempts_count],
			[tx_segments_dispatched_count],
			[segment_bytes_dispatched],
			[bytes_serialized],
			[serializer_user_time_in_ms],
			[serializer_kernel_time_in_ms],
			[xtp_log_bytes_consumed],
			[checkpoints_closed],
			[last_closed_checkpoint_ts],
			[hardened_recovery_lsn],
			[hardened_root_file_guid],
			[hardened_root_file_watermark],
			[hardened_truncation_lsn],
			[log_bytes_since_last_close],
			[time_since_last_close_in_ms],
			[current_checkpoint_id],
			[current_checkpoint_segment_count],
			[recovery_lsn_candidate],
			[outstanding_checkpoint_count],
			[closing_checkpoint_id],
			[recovery_checkpoint_id],
			[recovery_checkpoint_ts],
			[bootstrap_recovery_lsn],
			[bootstrap_root_file_guid],
			[internal_error_code],
			[bytes_of_large_data_serialized]
	FROM OpenRowset(TABLE XTP_CKPTV2)
"
3650	Parse Tree	View	-240827362	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	176	"CREATE VIEW sys.dm_os_latch_stats AS
	SELECT *
	FROM OpenRowset(TABLE SYSLATCHSTATS)
"
3650	Compiled Plan	Adhoc	530466603	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_server_audit_status t
3666	Parse Tree	View	-103	32767	1	4	1	2	22	251	0	1	1024	0	0	0	0	0	116	"CREATE VIEW sys.all_columns AS
 SELECT * FROM sys.columns"
3666	Parse Tree	View	-103	32767	6	4	1	25	22	251	0	1	1024	0	0	0	0	0	116	"CREATE VIEW sys.all_columns AS
 SELECT * FROM sys.columns"
3666	Compiled Plan	Prepared	664033039	1	0	-2	2	1	17	251	0	1	1024	0	0	0	0	0	810	"(@P0 int,@P1 datetime2)select object_id,
       name,
       create_date,
       modify_date,
       parsename(base_object_name, 3) as origin_db_name,
       parsename(base_object_name, 2) as origin_schema_name,
       parsename(base_object_name, 1) as origin_object_name,
       object_id(base_object_name)    as origin_id
from SchoolManagement.sys.synonyms
where schema_id = @P0
  and modify_date >= @P1                "
3676	Parse Tree	View	-593859324	32767	6	4	1	7	3	251	0	1	1024	0	0	0	0	0	188	"create view sys.dm_os_cluster_properties
as
	select *
	from OpenRowset(TABLE FCI_CONFIGS)
"
3676	Parse Tree	View	-414	32767	6	4	1	8	9	251	0	1	1024	0	0	0	0	0	1246	"CREATE VIEW sys.events AS
	SELECT ee.object_id AS object_id,
		ee.event_id AS type,
		ee.event_desc AS type_desc,
		sysconv(bit, 71 - e.valclass) AS is_trigger_event,
		ee.group_id AS event_group_type,
		ee.group_desc AS event_group_type_desc
	FROM sys.sysobjvalues e
	CROSS APPLY openrowset( TABLE EXPAND_EVENTS, e.objid, e.subobjid, 
		case when (e.valclass = 70 AND convert(int, e.value) & 4 != 4) OR e.valclass = 71  -- is user created trigger?
			then 1 else 0 end) ee
	WHERE e.valclass in (70,71) AND e.valnum <> 100	-- x_eunc_Server
		AND has_access('CO', e.objid) = 1	-- SVC_EXTTRIGEVT, SVC_ASYNTRGEVT
"
3677	Parse Tree	View	-812330516	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	268	"CREATE VIEW sys.dm_hadr_internal_ag_listener_addresses AS
	SELECT *
	FROM OpenRowset(TABLE DM_HADR_INTERNAL_AG_LISTENER_ADDRESSES)
"
3677	Parse Tree	View	-770418002	32767	6	4	1	9	5	251	0	1	1024	0	0	0	0	0	210	"CREATE VIEW sys.dm_database_encryption_keys AS
	SELECT * FROM OpenRowset(TABLE DATABASEENCRYPTIONKEYS)
"
3678	Parse Tree	View	-471491896	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	260	"
-- add it
create view sys.dm_pdw_nodes_os_dispatchers as
select *, convert(int, null) pdw_node_id from sys.dm_os_dispatchers
"
3687	Parse Tree	View	-523840689	32767	6	4	1	12	7	251	0	1	1024	0	0	0	0	0	872	"
-- add it
create view sys.dm_exec_external_work as
select
	execution_id	collate database_default execution_id,
	step_index,
	dms_step_index,
	work_id,
	compute_node_id,
	type	collate database_default type,
	input_name 	collate database_default input_name,
	read_location,
	bytes_processed,
	length,
	start_time,
	end_time,
	total_elapsed_time,
	status	collate database_default status
from sys._dm_exec_external_work
"
3709	Parse Tree	View	-240	32767	1	4	1	3	13	251	0	1	1024	0	0	0	0	0	1376	"CREATE VIEW sys.credentials AS
	SELECT
		co.id AS credential_id,
		co.name,
		convert(nvarchar(4000), ov.value) as credential_identity,
		co.created as create_date,
		co.modified as modify_date,
		n.name as target_type,
		r.indepid AS target_id
	FROM master.sys.sysclsobjs co
	LEFT JOIN master.sys.sysobjvalues ov ON ov.valclass = 28 AND ov.objid = co.id AND ov.subobjid = 0 AND ov.valnum = 1
	LEFT JOIN master.sys.syssingleobjrefs r ON r.depid = co.id AND r.class = co.intprop AND r.depsubid = 0	
	LEFT JOIN sys.syspalvalues n ON n.class = 'SRCL' AND n.value = co.intprop
	WHERE co.class = 57
		AND co.type = '' -- Server Scope Credentials 
		AND has_access('CR', 0) = 1
"
3709	Parse Tree	View	-240	32767	6	4	1	12	13	251	0	1	1024	0	0	0	0	0	1376	"CREATE VIEW sys.credentials AS
	SELECT
		co.id AS credential_id,
		co.name,
		convert(nvarchar(4000), ov.value) as credential_identity,
		co.created as create_date,
		co.modified as modify_date,
		n.name as target_type,
		r.indepid AS target_id
	FROM master.sys.sysclsobjs co
	LEFT JOIN master.sys.sysobjvalues ov ON ov.valclass = 28 AND ov.objid = co.id AND ov.subobjid = 0 AND ov.valnum = 1
	LEFT JOIN master.sys.syssingleobjrefs r ON r.depid = co.id AND r.class = co.intprop AND r.depsubid = 0	
	LEFT JOIN sys.syspalvalues n ON n.class = 'SRCL' AND n.value = co.intprop
	WHERE co.class = 57
		AND co.type = '' -- Server Scope Credentials 
		AND has_access('CR', 0) = 1
"
3715	Parse Tree	View	-727844710	32767	6	4	1	6	4	251	0	1	1024	0	0	0	0	0	184	"CREATE VIEW sys.dm_os_dispatchers AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_DISPATCHERS)
"
3719	Parse Tree	View	-551	32767	6	4	1	6	8	251	0	1	1024	0	0	0	0	0	1684	"
CREATE VIEW sys.column_store_row_groups AS

	SELECT rg.parent_object_id as [object_id],
		rg.parent_index_id as [index_id],
		rg.parent_part_number as [partition_number],
		rg.[row_group_id],
		rg.[delta_store_hobt_id],
		rg.[state],
		sd.[name] as state_description,
		rg.[total_rows],
		rg.[deleted_rows],
		rg.[size_in_bytes]
	FROM 
	(sys.syspalvalues sd 
	INNER hash JOIN 
	-- First parameter determines which table to open
	-- Second parameter determines the object id passed in
	-- Third parameter determines which view to show,
	-- 1 is to show dm_db_column_store_row_group_physical_stats
	-- 0 is to show fn_column_store_row_groups or column_store_row_groups
	OpenRowset(TABLE COLUMNSTORE_ROW_GROUPS, 0, 0) rg
		ON sd.class = 'CSRG' AND sd.value = rg.state) 
	WHERE has_access('CO', rg.parent_object_id) = 1;
"
3719	Parse Tree	View	-84833463	32767	6	4	1	8	5	251	0	1	1024	0	0	0	0	0	674	"
-- add it
create view sys.dm_pdw_os_performance_counters as
select
	pdw_node_id,
	counter_name	collate database_default counter_name,
	counter_category	collate database_default counter_category,
	instance_name	collate database_default instance_name,
	counter_value,
	last_update_time
from sys._dm_pdw_os_performance_counters
"
3723	Parse Tree	View	-528723827	32767	6	4	1	2	7	251	0	1	1024	0	0	0	0	0	1626	"CREATE VIEW sys.dm_tran_database_transactions AS
	SELECT 
		transaction_id,
		database_id,
		database_transaction_begin_time,
		database_transaction_type,
		database_transaction_state,
		database_transaction_status,
		database_transaction_status2,
		database_transaction_log_record_count,
		database_transaction_replicate_record_count,
		database_transaction_log_bytes_used,
		database_transaction_log_bytes_reserved,
		database_transaction_log_bytes_used_system,
		database_transaction_log_bytes_reserved_system,
		database_transaction_begin_lsn,
		database_transaction_last_lsn,
		database_transaction_most_recent_savepoint_lsn,
		database_transaction_commit_lsn,
		database_transaction_last_rollback_lsn,
		database_transaction_next_undo_lsn
	FROM OpenRowset(TABLE DATABASE_TRANSACTIONS)
"
3724	Parse Tree	View	-242583247	32767	6	4	1	4	3	251	0	1	1024	0	0	0	0	0	212	"CREATE VIEW sys.fulltext_languages AS
	SELECT lcid, name 
	FROM OpenRowSet(TABLE SYSFULLTEXTLANGUAGES)
"
3724	Parse Tree	View	-242583247	32767	1	4	1	9	3	251	0	1	1024	0	0	0	0	0	212	"CREATE VIEW sys.fulltext_languages AS
	SELECT lcid, name 
	FROM OpenRowSet(TABLE SYSFULLTEXTLANGUAGES)
"
3736	Parse Tree	View	-558058590	32767	6	4	1	14	3	251	0	1	1024	0	0	0	0	0	176	"CREATE VIEW sys.dm_os_host_info AS
	SELECT *
	FROM OpenRowset(TABLE DM_OS_HOST_INFO)
"
3738	Parse Tree	View	-249426774	32767	6	4	1	8	7	251	0	1	1024	0	0	0	0	0	466	"CREATE VIEW sys.dm_hadr_internal_wsfc_ag_replicas AS
	SELECT
		ags.ag_id, reps.*
	FROM
		OpenRowset(TABLE DM_HADR_INTERNAL_WSFC_AGS) AS ags
	CROSS APPLY
		OpenRowset(TABLE DM_HADR_INTERNAL_WSFC_AG_REPLICAS, ags.ag_id) AS reps
"
3741	Parse Tree	View	-435	32767	6	4	1	2	4	251	0	1	1024	0	0	0	0	0	386	"CREATE VIEW sys.partition_range_values AS
	SELECT objid AS function_id,
		subobjid AS boundary_id,
		valnum AS parameter_id,
		value AS value
	FROM sys.sysobjvalues
	WHERE valclass = 30
"
3750	Parse Tree	View	-921856217	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	572	"CREATE VIEW sys.availability_read_only_routing_lists  AS
	SELECT
		replica_id = reps.ag_replica_id,
		rrls.*
	FROM
		sys.dm_hadr_internal_wsfc_ag_replicas AS reps
	CROSS APPLY
		OpenRowset(TABLE DM_HADR_INTERNAL_AG_READONLY_ROUTING_LIST, reps.ag_id, reps.ag_replica_id) AS rrls
"
3773	Parse Tree	View	-826815797	32767	6	4	1	5	5	251	0	1	1024	0	0	0	0	0	272	"
-- add it
create view sys.dm_pdw_nodes_os_memory_brokers as
select *, convert(int, null) pdw_node_id from sys.dm_os_memory_brokers
"
3774	Parse Tree	View	-261	32767	6	4	1	7	9	251	0	1	1024	0	0	0	0	0	1022	"CREATE VIEW sys.server_audit_specifications AS
	SELECT
		asp.id AS server_specification_id,
		asp.name AS name,
		asp.created AS create_date,
		asp.modified AS modify_date,
		g.guid AS audit_guid,
		sysconv(bit, sysconv (int, asp.status) & 0x1) AS is_state_enabled
	FROM master.sys.sysclsobjs asp
	LEFT JOIN master.sys.sysguidrefs g ON g.class = 6 AND g.id = asp.id AND g.subid = 0  -- GRC_SRVAUDITSPECGUID
	WHERE asp.class = 65 AND asp.type = 'SA' -- SOC_SECAUDITSPEC
		AND has_access('SA', 0) = 1
"
3777	Parse Tree	View	-785018874	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	310	"
-- add it
create view sys.dm_pdw_feature_switches as
select
	[name] collate database_default name,
	[is_enabled]
from sys._dm_pdw_feature_switches
"
3780	Parse Tree	View	-332991205	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	334	"CREATE VIEW sys.conversation_groups$ AS
	SELECT conversation_group_id = i.id,
		i.service_id,
		is_system = convert (bit, i.status & 1)
	FROM sys.sysconvgroup i;
"
3781	Compiled Plan	Adhoc	360675097	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.registered_search_property_lists t
3784	Parse Tree	View	-572	32767	6	4	1	12	15	251	0	1	1024	0	0	0	0	0	1992	"CREATE VIEW sys.database_scoped_credentials AS
    SELECT
        co.name,
        ISNULL(p.indepid, 1) AS principal_id, -- 1: Default DBO owner
        co.id AS credential_id,
        convert(nvarchar(4000), ov.value) as credential_identity,
        co.created as create_date,
        co.modified as modify_date,
        n.name as target_type,
        r.indepid AS target_id
    FROM sys.sysclsobjs co
    LEFT JOIN sys.sysobjvalues ov ON ov.valclass = 28 AND ov.objid = co.id AND ov.subobjid = 0 AND ov.valnum = 1
    LEFT JOIN sys.syssingleobjrefs r ON r.depid = co.id AND r.class = co.intprop AND r.depsubid = 0  
    LEFT JOIN sys.syssingleobjrefs p ON p.depid = co.id AND p.class = 121 AND p.depsubid = 0 -- SRC_DB_SCOPED_CRED_OWNER
    LEFT JOIN sys.syspalvalues n ON n.class = 'SRCL' AND n.value = co.intprop
    WHERE co.class = 57
        AND co.type = '1' -- Database Scope Credentials
		AND has_access('DC', co.id) = 1 -- View Database Scoped Credential permission.
"
3785	Parse Tree	View	-203	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	482	"CREATE VIEW sys.sysdevices AS
	SELECT name, size=convert(int, 0),
		low=convert(int, 0),
		high=convert(int, 0),
		status=convert(smallint, 16),
		cntrltype=convert(smallint, type),
		phyname = physical_name
	FROM sys.backup_devices
"
3791	Parse Tree	View	-908838470	32767	6	4	1	4	6	251	0	1	1024	0	0	0	0	0	194	"CREATE VIEW sys.dm_db_xtp_index_stats
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_INDEX_STATS)
"
3795	Parse Tree	View	-514	32767	6	4	1	8	7	251	0	1	1024	0	0	0	0	0	1016	"CREATE VIEW sys.registered_search_properties AS
	SELECT 
		ftp.property_list_id AS property_list_id,
		ftp.property_id AS property_id,
		ftp.property_name AS property_name,
		ftp.guid_identifier AS property_set_guid,
		ftp.int_identifier AS property_int_id,
		ftp.string_description AS property_description
	FROM sys.sysftproperties ftp
	JOIN sys.sysclsobjs sc ON ftp.property_list_id = sc.id and sc.class = 66 and has_access ('FP', sc.id) = 1 -- join to filter property according to has_access() 
"
3806	Parse Tree	View	-456	32767	6	4	1	24	20	251	0	1	1024	0	0	0	0	0	2284	"CREATE VIEW sys.xml_schema_attributes AS
	SELECT xml_component_id = c.id,
		xml_collection_id = c.xsdid,
		xml_namespace_id = c.uriord,
		is_qualified = sysconv(bit, c.qual),
		name = q.name,
		symbol_space = c.symspace,
		s.name AS symbol_space_desc,
		c.kind,
		k.name AS kind_desc,
		derivation = c.deriv,
		d.name AS derivation_desc,
		b.indepid AS base_xml_component_id,
		o.indepid AS scoping_xml_component_id,
		sysconv(bit, c.status & 1) AS is_default_fixed,
		sysconv(bit, c.status & 2) AS must_be_qualified,
		c.defval AS default_value
	FROM sys.sysxmlcomponent c LEFT JOIN sys.sysqnames q ON c.nameid = q.nid
	LEFT JOIN sys.syssingleobjrefs b ON b.depid = c.id AND b.class = 82 AND b.depsubid = 0	-- SRC_XMLCOMPDERIVE
	LEFT JOIN sys.syssingleobjrefs o ON o.depid = c.id AND o.class = 81 AND o.depsubid = 0	-- SRC_XMLCOMPOWNCOMP
	LEFT JOIN sys.sysbinpals k ON k.class = 'XCKI' AND k.value = c.kind
	LEFT JOIN sys.sysbinpals d ON d.class = 'XCDR' AND d.value = c.deriv
	LEFT JOIN sys.sysbinpals s ON s.class = 'XCSS' AND s.value = c.symspace
	WHERE c.symspace = 'A'
		AND has_access('XC', c.id, c.xsdid) = 1
"
3807	Parse Tree	View	-817648642	32767	6	4	1	6	5	251	0	1	1024	0	0	0	0	0	408	"CREATE VIEW sys.dm_os_buffer_pool_extension_configuration AS
	SELECT 
		path, 
		file_id, 
		state, 
		state_description, 
		current_size_in_kb
	FROM OpenRowset(TABLE DM_OS_BPOOLEXTENSION_CONFIG)
"
3817	Parse Tree	View	-398	32767	6	4	1	18	32	251	0	1	1024	0	0	0	0	0	5266	"CREATE VIEW sys.xml_indexes AS
	SELECT i.id AS object_id,
		i.name AS name,
		i.indid AS index_id,
		i.type,
		n.name AS type_desc,
		sysconv(bit, i.status & 0x8) AS is_unique,			-- IS_IND_UNIQUE
		isnull(ds.indepid, 1) AS data_space_id,
		sysconv(bit, i.status & 0x4) AS ignore_dup_key,		-- IS_IND_DPKEYS
		sysconv(bit, i.status & 0x20) AS is_primary_key,		-- IS_IND_PRIMARY
		sysconv(bit, i.status & 0x40) AS is_unique_constraint,	-- IS_IND_UNIQUE_CO
		i.fillfact AS fill_factor,
		sysconv(bit, i.status & 0x10) AS is_padded,				-- IS_IND_PADINDEX
		sysconv(bit, i.status & 0x80) AS is_disabled,			-- IS_IND_OFFLINE
		sysconv(bit, i.status & 0x100) AS is_hypothetical,		-- IS_IND_ITWINDEX
		sysconv(bit, i.status & 0x02000000) AS is_ignored_in_optimization,	-- IS_IND_IGNORE_IN_OPTIMIZATION
		sysconv(bit, 1 - (i.status & 512)/512) AS allow_row_locks,		-- IS_IND_NO_ROWLOCK
		sysconv(bit, 1 - (i.status & 1024)/1024) AS allow_page_locks,	-- IS_IND_NO_PAGELOCK
		ui.indepsubid AS using_xml_index_id,
		char(CASE when (i.tinyprop = 80) OR (i.tinyprop = 82) OR (i.tinyprop = 86) then nullif(i.tinyprop, 0) else null end) AS secondary_type,
		CASE when (i.tinyprop = 80) OR (i.tinyprop = 82) OR (i.tinyprop = 86) then s.name else null end AS secondary_type_desc,
		sysconv(bit, 0) AS has_filter,
		convert(nvarchar(max), NULL) AS filter_definition,
		convert(tinyint, q.value) AS xml_index_type,
		convert(nvarchar(60), q.name) AS xml_index_type_description,
		convert(int, p.indepsubid) AS path_id,
		sysconv(bit, i.status & 0x08000000) AS auto_created	-- IS_IND_AUTO_CREATED
	FROM sys.sysidxstats i
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = i.id AND ds.class = 7 AND ds.depsubid = i.indid	-- SRC_INDEXTODS	
	LEFT JOIN sys.syssingleobjrefs ui ON ui.depid = i.id AND (ui.class = 100 OR ui.class = 110) AND ui.depsubid = i.indid	-- SRC_XMLUSINGINDEX or SRC_SELECTIVEXMLUSINGINDEX
	LEFT JOIN sys.syspalvalues n ON n.class = 'IDXT' and n.value = i.type
	LEFT JOIN sys.syspalvalues s ON s.class = 'XITY' AND s.value = i.tinyprop
	LEFT JOIN sys.syspalvalues q ON q.class = 'XIT2' AND q.value = (CASE i.tinyprop WHEN 0 THEN 0
																					WHEN 76 THEN 2
																					WHEN 80 THEN 1
																					WHEN 82 THEN 1
																					WHEN 86 THEN 1
																					WHEN 83 THEN 3
																					ELSE NULL END)
	LEFT JOIN sys.syssingleobjrefs p ON p.class = 111 AND p.depid = i.id AND p.depsubid = i.indid	-- SRC_SELECTIVEXMLINDEX_USINGPATH
	WHERE (i.indid >= 256000 and i.indid < 257000) -- is index id within XML index range?
		AND has_access('CO', i.id) = 1
"
3827	Compiled Plan	Adhoc	324760359	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.dm_os_sys_info t
3842	Parse Tree	View	-779543734	32767	6	4	1	6	3	251	0	1	1024	0	0	0	0	0	230	"CREATE VIEW sys.dm_os_memory_node_access_stats AS
	SELECT *
	FROM OpenRowSet(TABLE DM_OS_MEMORYNODEACCESSSTATS)
"
3850	Parse Tree	View	-224	32767	1	4	1	4	5	251	0	1	1024	0	0	0	0	0	436	"CREATE VIEW sys.configurations AS
	SELECT configuration_id,
		name,
		value,
		minimum,
		maximum,
		value_in_use,
		description,
		is_dynamic,
		is_advanced
	FROM sys.configurations$
	WHERE is_not_use = 0
"
3850	Parse Tree	View	-224	32767	6	4	1	10	5	251	0	1	1024	0	0	0	0	0	436	"CREATE VIEW sys.configurations AS
	SELECT configuration_id,
		name,
		value,
		minimum,
		maximum,
		value_in_use,
		description,
		is_dynamic,
		is_advanced
	FROM sys.configurations$
	WHERE is_not_use = 0
"
3860	Parse Tree	View	-535	32767	6	4	1	11	19	251	0	1	1024	0	0	0	0	0	3184	"CREATE VIEW sys.hash_indexes AS
	SELECT i.id AS object_id,
		i.name AS name,
		i.indid AS index_id,
		i.type,
		n.name AS type_desc,
		sysconv(bit, i.status & 0x8) AS is_unique,			-- IS_IND_UNIQUE
		0 AS data_space_id,
		sysconv(bit, i.status & 0x4) AS ignore_dup_key,		-- IS_IND_DPKEYS
		sysconv(bit, i.status & 0x20) AS is_primary_key,	-- IS_IND_PRIMARY
		sysconv(bit, i.status & 0x40) AS is_unique_constraint,	-- IS_IND_UNIQUE_CO
		i.fillfact AS fill_factor,
		sysconv(bit, i.status & 0x10) AS is_padded,		-- IS_IND_PADINDEX
		sysconv(bit, i.status & 0x80) AS is_disabled,		-- IS_IND_OFFLINE
		sysconv(bit, i.status & 0x100) AS is_hypothetical,	-- IS_IND_ITWINDEX
		sysconv(bit, i.status & 0x02000000) AS is_ignored_in_optimization,	-- IS_IND_IGNORE_IN_OPTIMIZATION
		sysconv(bit, 1 - (i.status & 512)/512) AS allow_row_locks,		-- IS_IND_NO_ROWLOCK
		sysconv(bit, 1 - (i.status & 1024)/1024) AS allow_page_locks,		-- IS_IND_NO_PAGELOCK
		sysconv(bit, i.status & 0x20000) AS has_filter,	-- IS_HAS_FILTER
		case when (i.status & 0x20000) != 0 then object_definition(i.id, i.indid, 7) else NULL end AS filter_definition, -- x_euncIndex
		i.intprop AS bucket_count,
		sysconv(bit, i.status & 0x08000000) AS auto_created	-- IS_IND_AUTO_CREATED
	FROM sys.sysidxstats i
	LEFT JOIN sys.syssingleobjrefs ds ON ds.depid = i.id AND ds.class = 7 AND ds.depsubid = i.indid	-- SRC_INDEXTODS
	LEFT JOIN sys.syspalvalues n ON n.class = 'IDXT' and n.value = i.type
	WHERE (i.status & 1) <> 0 AND i.type = 7 -- HASH indexes are type 7
		AND has_access('CO', i.id) = 1	-- IS_INDEX
"
3861	Compiled Plan	Adhoc	775155205	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.partition_functions t
3862	Parse Tree	View	-990054276	32767	6	4	1	2	8	251	0	1	1024	0	0	0	0	0	162	"CREATE VIEW sys.dm_os_threads AS
	SELECT *
	FROM OpenRowSet(TABLE SYSTHREADS)
"
3871	Parse Tree	View	-477	32767	6	4	1	2	5	251	0	1	1024	0	0	0	0	0	392	"CREATE VIEW sys.parameter_xml_schema_collection_usages AS
	SELECT id AS object_id,
		colid AS parameter_id,
		xmlns AS xml_collection_id
	FROM sys.syscolpars
	WHERE number = 1 AND xmlns > 0
"
3882	Parse Tree	View	-419	32767	6	4	1	5	6	251	0	1	1024	0	0	0	0	0	512	"CREATE VIEW sys.numbered_procedure_parameters AS
	SELECT object_id, procedure_number = number,
		name, parameter_id,
		system_type_id, user_type_id,
		max_length, precision,
		scale, is_output, is_cursor_ref
	FROM sys.parameters$
	WHERE number > 1
"
3886	Compiled Plan	Adhoc	856926937	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_server_registry t
3889	Parse Tree	View	-575913176	32767	6	4	1	5	3	251	0	1	1024	0	0	0	0	0	172	"CREATE VIEW sys.dm_xtp_threads
AS
	SELECT
	*
	FROM OpenRowset(TABLE XTP_THREADS)
"
3889	Compiled Plan	Adhoc	108498388	6	0	-2	2	1	30	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.dm_db_mirroring_auto_page_repair t
3889	Compiled Plan	Adhoc	108498388	6	0	-2	2	2	30	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.dm_db_mirroring_auto_page_repair t
3916	Parse Tree	View	-741323372	32767	6	4	1	22	15	251	0	1	1024	0	0	0	0	0	2230	"CREATE VIEW sys.dm_broker_connections AS
    SELECT 
	    connection_id,
	    transport_stream_id,
	    state,
	    state_desc = sn.name,
	    connect_time,
	    login_time,
	    authentication_method,
	    principal_name,
	    remote_user_name,
	    last_activity_time,
	    is_accept,
	    login_state,
	    login_state_desc = ln.name,
	    peer_certificate_id,
	    encryption_algorithm = encalg,
	    encryption_algorithm_desc = ag.name,
	    receives_posted,
	    is_receive_flow_controlled,
	    sends_posted,
	    is_send_flow_controlled,
	    total_bytes_sent,
	    total_bytes_received,
	    total_fragments_sent,
	    total_fragments_received,
	    total_sends,
	    total_receives,
	    peer_arbitration_id
    FROM OpenRowset (TABLE SBCONNECTIONENDPOINTS) as c
    LEFT OUTER JOIN sys.syspalvalues ag ON ag.class = 'EPET' AND ag.value = c.encalg
    LEFT OUTER JOIN sys.syspalvalues sn ON sn.class = 'EPCS' AND sn.value = c.state
    LEFT OUTER JOIN sys.syspalvalues ln ON ln.class = 'EPLS' AND ln.value = c.login_state
        WHERE c.endpoint_type = 0 -- x_eetBroker
"
3930	Parse Tree	View	-595902434	32767	6	3	1	20	23	251	0	1	1024	0	0	0	0	0	2598	"CREATE VIEW INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE
AS
SELECT
	KCU.TABLE_CATALOG,
	KCU.TABLE_SCHEMA,
	KCU.TABLE_NAME,
	KCU.COLUMN_NAME,
	KCU.CONSTRAINT_CATALOG,
	KCU.CONSTRAINT_SCHEMA,
	KCU.CONSTRAINT_NAME
FROM	
	INFORMATION_SCHEMA.KEY_COLUMN_USAGE KCU
UNION ALL
SELECT
	DB_NAME()				AS TABLE_CATALOG,
	SCHEMA_NAME(u.schema_id)		AS TABLE_SCHEMA,
	u.name					AS TABLE_NAME,
	col_name(d.referenced_major_id, d.referenced_minor_id)
						AS COLUMN_NAME,
	DB_NAME()				AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(k.schema_id)		AS CONSTRAINT_SCHEMA,
	k.name					AS CONSTRAINT_NAME
FROM	
	sys.check_constraints k JOIN sys.objects u ON u.object_id = k.parent_object_id
	JOIN sys.sql_dependencies d ON d.class = 1
		AND d.object_id = k.object_id
		AND d.column_id = 0
		AND d.referenced_major_id = u.object_id
WHERE u.type <> 'TF' -- skip constraints in TVFs.
UNION ALL
SELECT
	DB_NAME()				AS TABLE_CATALOG,
	SCHEMA_NAME(t.schema_id)		AS TABLE_SCHEMA,
	t.name					AS TABLE_NAME,
	col_name(f.object_id, f.column_id)	AS COLUMN_NAME,
	DB_NAME()				AS CONSTRAINT_CATALOG,
	SCHEMA_NAME(r.schema_id)		AS CONSTRAINT_SCHEMA,
	r.name					AS CONSTRAINT_NAME
FROM
	sys.objects t JOIN sys.columns f ON f.object_id = t.object_id
	JOIN sys.objects r ON r.object_id = f.rule_object_id
"
3931	Parse Tree	View	-435799990	32767	6	3	1	66	37	251	0	1	1024	0	0	0	0	0	5986	"CREATE VIEW INFORMATION_SCHEMA.PARAMETERS
AS
SELECT
	DB_NAME()						AS SPECIFIC_CATALOG,
	SCHEMA_NAME(o.schema_id)		AS SPECIFIC_SCHEMA,
	o.name							AS SPECIFIC_NAME,
	c.parameter_id					AS ORDINAL_POSITION,
	convert(nvarchar(10), CASE
		WHEN c.parameter_id = 0 THEN 'OUT'
		WHEN c.is_output = 1 THEN 'INOUT'
		ELSE 'IN' END)					AS PARAMETER_MODE,
	convert(nvarchar(10), CASE WHEN
		c.parameter_id = 0 THEN 'YES' ELSE 'NO' END)	AS IS_RESULT,
	convert(nvarchar(10), 'NO')				AS AS_LOCATOR,
	c.name							AS PARAMETER_NAME,
	ISNULL(TYPE_NAME(c.system_type_id), u.name)		AS DATA_TYPE,
	COLUMNPROPERTY(c.object_id, c.name, 'charmaxlen')	AS CHARACTER_MAXIMUM_LENGTH,
	COLUMNPROPERTY(c.object_id, c.name, 'octetmaxlen')	AS CHARACTER_OCTET_LENGTH,
	convert(sysname, null)					AS COLLATION_CATALOG,
	convert(sysname, null) collate catalog_default			AS COLLATION_SCHEMA,
	convert(sysname, CASE
		WHEN c.system_type_id IN (35, 99, 167, 175, 231, 239) THEN	-- [n]char/[n]varchar/[n]text
		SERVERPROPERTY('collation') END)		AS COLLATION_NAME,
	convert( sysname, null)					AS CHARACTER_SET_CATALOG,
	convert( sysname, null) collate catalog_default			AS CHARACTER_SET_SCHEMA,
	convert( sysname, CASE
		WHEN c.system_type_id IN (35, 167, 175) THEN SERVERPROPERTY('sqlcharsetname')	-- char/varchar/text
		WHEN c.system_type_id IN (99, 231, 239) THEN N'UNICODE'	-- nchar/nvarchar/ntext
		END)						AS CHARACTER_SET_NAME,
	convert(tinyint, CASE -- int/decimal/numeric/real/float/money
		WHEN c.system_type_id IN (48, 52, 56, 59, 60, 62, 106, 108, 122, 127) THEN c.precision
		END)										AS NUMERIC_PRECISION,
	convert(smallint, CASE	-- int/money/decimal/numeric
		WHEN c.system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
		WHEN c.system_type_id IN (59, 62) THEN 2 END)	AS NUMERIC_PRECISION_RADIX, -- real/float
	convert(int, CASE	-- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN NULL
		ELSE ODBCSCALE(c.system_type_id, c.scale) END)	AS NUMERIC_SCALE,
	convert(smallint, CASE -- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN ODBCSCALE(c.system_type_id, c.scale) END)	AS DATETIME_PRECISION,
	convert(nvarchar(30), null)				AS INTERVAL_TYPE,
	convert(smallint, null)					AS INTERVAL_PRECISION,
	convert(sysname, CASE WHEN u.schema_id <> 4
		THEN DB_NAME() END)						AS USER_DEFINED_TYPE_CATALOG,
	convert(sysname, CASE WHEN u.schema_id <> 4
		THEN SCHEMA_NAME(u.schema_id) END)		AS USER_DEFINED_TYPE_SCHEMA,
	convert(sysname, CASE WHEN u.schema_id <> 4
		THEN u.name END)							AS USER_DEFINED_TYPE_NAME,
	convert(sysname, null)					AS SCOPE_CATALOG,
	convert(sysname, null) collate catalog_default		AS SCOPE_SCHEMA,
	convert(sysname, null) collate catalog_default		AS SCOPE_NAME
FROM
	sys.objects o JOIN sys.parameters c ON c.object_id = o.object_id
	JOIN sys.types u ON u.user_type_id = c.user_type_id
WHERE
	o.type IN ('P','FN','TF', 'IF', 'IS', 'AF','PC', 'FS', 'FT')
"
3936	Parse Tree	View	-498	32767	6	4	1	19	141	251	0	1	1024	0	0	0	0	0	11598	"CREATE VIEW sys.spatial_index_tessellations
AS
	-- GEOMETRY_GRID indexes have a scheme id of 1 and are output by this clause.
	--
	SELECT 
	objid AS object_id, 
	subobjid AS index_id, 
	tes.name AS tessellation_scheme,
	convert(float, [2]) AS bounding_box_xmin, 
	convert(float, [3]) AS bounding_box_ymin,
	convert(float, [4]) AS bounding_box_xmax,
	convert(float, [5]) AS bounding_box_ymax,
	convert(smallint, case [6] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_1_grid,
	d1.name AS level_1_grid_desc,
	convert(smallint, case [7] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_2_grid,
	d2.name AS level_2_grid_desc,
	convert(smallint, case [8] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_3_grid,
	d3.name AS level_3_grid_desc,
	convert(smallint, case [9] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_4_grid,
	d4.name AS level_4_grid_desc,
	convert(int, [10]) AS cells_per_object
	FROM
	(
		SELECT objid, subobjid, i.intprop as scheme_id, valnum, value FROM sys.sysobjvalues v
		LEFT JOIN sys.sysidxstats i ON i.id = v.objid and i.indid = v.subobjid
		WHERE v.subobjid >= 384000 AND v.subobjid <= 385000 
			AND has_access('CO', i.id) = 1
			AND i.intprop = 1
	) AS SourceTable
	PIVOT
	(
		MIN(value) FOR valnum IN ([2], [3], [4], [5], [6], [7], [8], [9], [10])
	) AS PivotTable
	LEFT JOIN sys.syspalvalues tes ON tes.class = 'EISP' and tes.value = scheme_id
	LEFT JOIN sys.syspalvalues d1 ON d1.class = 'EISD' and d1.value = [6]
	LEFT JOIN sys.syspalvalues d2 ON d2.class = 'EISD' and d2.value = [7]
	LEFT JOIN sys.syspalvalues d3 ON d3.class = 'EISD' and d3.value = [8]
	LEFT JOIN sys.syspalvalues d4 ON d4.class = 'EISD' and d4.value = [9]

	UNION ALL

	-- GEOGRAPHY_GRID indexes have a scheme id of 2 and are output by this clause.
	-- The bounding box columns are null for geography indexes.

	SELECT 
	objid AS object_id, 
	subobjid AS index_id, 
	tes.name AS tessellation_scheme,
	null AS bounding_box_xmin, 
	null AS bounding_box_ymin,
	null AS bounding_box_xmax,
	null AS bounding_box_ymax,
	convert(smallint, case [2] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_1_grid,
	d1.name AS level_1_grid_desc,
	convert(smallint, case [3] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_2_grid,
	d2.name AS level_2_grid_desc,
	convert(smallint, case [4] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_3_grid,
	d3.name AS level_3_grid_desc,
	convert(smallint, case [5] when 1 then 4 when 2 then 16 when 3 then 64 when 4 then 256 else NULL end) AS level_4_grid,
	d4.name AS level_4_grid_desc,
	convert(int, [6]) AS cells_per_object
	FROM
	(
		SELECT objid, subobjid, i.intprop as scheme_id, valnum, value FROM sys.sysobjvalues v
		LEFT JOIN sys.sysidxstats i ON i.id = v.objid and i.indid = v.subobjid
		WHERE v.subobjid >= 384000 AND v.subobjid <= 385000 
			AND has_access('CO', i.id) = 1
			AND i.intprop = 2
	) AS SourceTable
	PIVOT
	(
		MIN(value) FOR valnum IN ([2], [3], [4], [5], [6])
	) AS PivotTable
	LEFT JOIN sys.syspalvalues tes ON tes.class = 'EISP' and tes.value = scheme_id
	LEFT JOIN sys.syspalvalues d1 ON d1.class = 'EISD' and d1.value = [2]
	LEFT JOIN sys.syspalvalues d2 ON d2.class = 'EISD' and d2.value = [3]
	LEFT JOIN sys.syspalvalues d3 ON d3.class = 'EISD' and d3.value = [4]
	LEFT JOIN sys.syspalvalues d4 ON d4.class = 'EISD' and d4.value = [5]

	UNION ALL

	-- GEOMETRY_AUTO_GRID indexes have a scheme id of 3 and are output by this clause.
	--
	SELECT 
	objid AS object_id, 
	subobjid AS index_id, 
	tes.name AS tessellation_scheme,
	convert(float, [2]) AS bounding_box_xmin, 
	convert(float, [3]) AS bounding_box_"
3937	Parse Tree	View	-129	32767	6	4	1	2	28	251	0	1	1024	0	0	0	0	0	3248	"-- Return system objects in master database context
CREATE VIEW sys.syscomments AS
	SELECT o.id AS id,
		convert(smallint, case when o.type in ('P', 'RF') then 1 else 0 end) AS number,
		s.colid, s.status,
		convert(varbinary(8000), s.text) AS ctext,
		convert(smallint, 2 + 4 * (s.status & 1)) AS texttype,
		convert(smallint, 0) AS language,
		sysconv(bit, s.status & 1) AS encrypted,
		sysconv(bit, 0) AS compressed,
		s.text
	FROM sys.sysschobjs$ o CROSS APPLY OpenRowset(TABLE SQLSRC, o.id, 0) s
	WHERE o.nsclass = 0 -- x_eonc_Standard
		AND o.pclass = 1 -- x_eunc_Object
		AND o.type IN ('C','D','P','R','V','X','FN','IF','TF','RF','IS','TR')
	AND (DB_ID() = 1 AND has_access('AO', o.id) = 1 OR has_access('CO', o.id) = 1)
	UNION ALL
	SELECT c.object_id AS id,
		convert(smallint, c.column_id) AS number,
		s.colid, s.status,
		convert(varbinary(8000), s.text) AS ctext,
		convert(smallint, 2 + 4 * (s.status & 1)) AS texttype,
		convert(smallint, 0) AS language,
		sysconv(bit, s.status & 1) AS encrypted,
		sysconv(bit, 0) AS compressed,
		s.text
	FROM sys.computed_columns c CROSS APPLY OpenRowset(TABLE SQLSRC, c.object_id, c.column_id) s
	UNION ALL
	SELECT p.object_id AS id,
		convert(smallint, p.procedure_number) AS number,
		s.colid, s.status,
		convert(varbinary(8000), s.text) AS ctext,
		convert(smallint, 2 + 4 * (s.status & 1)) AS texttype,
		convert(smallint, 0) AS language,
		sysconv(bit, s.status & 1) AS encrypted,
		sysconv(bit, 0) AS compressed,
		s.text
	FROM sys.numbered_procedures p CROSS APPLY OpenRowset(TABLE SQLSRC, p.object_id, p.procedure_number) s
"
3942	Parse Tree	View	-331432826	32767	6	3	1	17	13	251	0	1	1024	0	0	0	0	0	2030	"
CREATE VIEW INFORMATION_SCHEMA.SEQUENCES
AS
SELECT
      DB_NAME() AS SEQUENCE_CATALOG,
      SCHEMA_NAME(s.schema_id) AS SEQUENCE_SCHEMA,
      s.name AS SEQUENCE_NAME,
      ISNULL(TYPE_NAME(s.system_type_id), t.name) AS DATA_TYPE,
      s.precision AS NUMERIC_PRECISION,
      convert(smallint, CASE  -- int/money/decimal/numeric
            WHEN s.system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
            WHEN s.system_type_id IN (59, 62) THEN 2
            END) AS NUMERIC_PRECISION_RADIX,    -- real/float
      ODBCSCALE(s.system_type_id, s.scale) AS NUMERIC_SCALE,
      s.start_value AS START_VALUE,
      s.minimum_value AS MINIMUM_VALUE,
      s.maximum_value AS MAXIMUM_VALUE,
      s.increment AS INCREMENT,
      s.is_cycling AS CYCLE_OPTION,
      t.name AS DECLARED_DATA_TYPE,
      t.precision AS DECLARED_NUMERIC_PRECISION,
      t.scale AS DECLARED_NUMERIC_SCALE
FROM
      sys.sequences as s
      JOIN sys.types t ON s.user_type_id = t.user_type_id;
"
3947	Parse Tree	View	-440	32767	6	4	1	11	17	251	0	1	1024	0	0	0	0	0	1928	"CREATE VIEW sys.fulltext_catalogs AS
	SELECT fulltext_catalog_id = o.id,
		name = o.name,
		path = convert(nvarchar(260),v.value),
		is_default = sysconv(bit,o.status & 1),					--FTCSTAT_DEFAULT
		is_accent_sensitivity_on = sysconv(bit,o.status & 2),	--FTCSTAT_ACCENT_SENSITIVE
		data_space_id = r.indepid,
		file_id = f.indepid,
		principal_id = p.indepid,
		is_importing = sysconv(bit,o.status & 4)	--FTCSTAT_IMPORTING
	FROM sys.sysclsobjs o
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 41 AND v.objid = o.id AND v.subobjid = 0 and v.valnum = 0	--SVC_FTCATPATH
	LEFT JOIN sys.syssingleobjrefs r ON r.depid = o.id AND r.class = 45 AND r.depsubid = 0	-- SRC_FTCATTODS
	LEFT JOIN sys.syssingleobjrefs p ON p.depid = o.id AND p.class = 46 AND p.depsubid = 0	-- SRC_FTCATOWNER
	LEFT JOIN sys.syssingleobjrefs f ON f.depid = o.id AND f.class = 16 AND f.depsubid = 0	-- SRC_FTCATTOFILE
	WHERE o.class = 32	--SOC_FTCAT
		AND has_access('FT', o.id) = 1
"
3953	Parse Tree	View	-855650752	32767	6	4	1	3	6	251	0	1	1024	0	0	0	0	0	138	"create view sys.traces as select * from OpenRowset(TABLE SYSTRACES)
"
3958	Parse Tree	View	-584644668	32767	6	4	1	3	4	251	0	1	1024	0	0	0	0	0	348	"
-- add it
create view sys.pdw_replicated_table_cache_state as
select
	object_id,
	[state]	collate database_default [state]
from sys._pdw_replicated_table_cache_state
"
3958	Parse Tree	View	-883068723	32767	6	3	1	46	32	251	0	1	1024	0	0	0	0	0	4986	"CREATE VIEW INFORMATION_SCHEMA.COLUMNS
AS
SELECT
	DB_NAME()									AS TABLE_CATALOG,
	SCHEMA_NAME(o.schema_id)						AS TABLE_SCHEMA,
	o.name										AS TABLE_NAME,
	c.name										AS COLUMN_NAME,
	COLUMNPROPERTY(c.object_id, c.name, 'ordinal')		AS ORDINAL_POSITION,
	convert(nvarchar(4000),
		OBJECT_DEFINITION(c.default_object_id))			AS COLUMN_DEFAULT,
	convert(varchar(3), CASE c.is_nullable
		WHEN 1 THEN 'YES' ELSE 'NO' END)			AS IS_NULLABLE,
	ISNULL(TYPE_NAME(c.system_type_id), t.name)		AS DATA_TYPE,
	COLUMNPROPERTY(c.object_id, c.name, 'charmaxlen')	AS CHARACTER_MAXIMUM_LENGTH,
	COLUMNPROPERTY(c.object_id, c.name, 'octetmaxlen')	AS CHARACTER_OCTET_LENGTH,
	convert(tinyint, CASE -- int/decimal/numeric/real/float/money
		WHEN c.system_type_id IN (48, 52, 56, 59, 60, 62, 106, 108, 122, 127) THEN c.precision
		END)										AS NUMERIC_PRECISION,
	convert(smallint, CASE	-- int/money/decimal/numeric
		WHEN c.system_type_id IN (48, 52, 56, 60, 106, 108, 122, 127) THEN 10
		WHEN c.system_type_id IN (59, 62) THEN 2 END)	AS NUMERIC_PRECISION_RADIX,	-- real/float
	convert(int, CASE	-- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN NULL
		ELSE ODBCSCALE(c.system_type_id, c.scale) END)	AS NUMERIC_SCALE,
	convert(smallint, CASE -- datetime/smalldatetime
		WHEN c.system_type_id IN (40, 41, 42, 43, 58, 61) THEN ODBCSCALE(c.system_type_id, c.scale) END)	AS DATETIME_PRECISION,
	convert(sysname, null)					AS CHARACTER_SET_CATALOG,
	convert(sysname, null) collate catalog_default	AS CHARACTER_SET_SCHEMA,
	convert(sysname, CASE
		WHEN c.system_type_id IN (35, 167, 175)	-- char/varchar/text
			THEN COLLATIONPROPERTY(c.collation_name, 'sqlcharsetname')
		WHEN c.system_type_id IN (99, 231, 239)	-- nchar/nvarchar/ntext
			THEN N'UNICODE'
		END)						AS CHARACTER_SET_NAME,
	convert(sysname, null)				AS COLLATION_CATALOG,
	convert(sysname, null) collate catalog_default		AS COLLATION_SCHEMA,
	c.collation_name					AS COLLATION_NAME,
	convert(sysname, CASE WHEN c.user_type_id > 256
		THEN DB_NAME() END)			AS DOMAIN_CATALOG,
	convert(sysname, CASE WHEN c.user_type_id > 256
		THEN SCHEMA_NAME(t.schema_id)
		END)						AS DOMAIN_SCHEMA,
	convert(sysname, CASE WHEN c.user_type_id > 256  
		THEN TYPE_NAME(c.user_type_id)
		END)						AS DOMAIN_NAME
FROM
	sys.objects o JOIN sys.columns c ON c.object_id = o.object_id
	LEFT JOIN sys.types t ON c.user_type_id = t.user_type_id
WHERE
	o.type IN ('U', 'V')
"
3964	Parse Tree	View	-1005108080	32767	6	4	1	10	5	251	0	1	1024	0	0	0	0	0	536	"
-- add it
create view sys.dm_pdw_nodes as
select
	pdw_node_id,
	type collate database_default type,
	name collate database_default name,
	address collate database_default address,
	is_passive,
	region collate database_default region
from sys._dm_pdw_nodes
"
3976	Parse Tree	View	-1003894161	32767	6	4	1	9	3	251	0	1	1024	0	0	0	0	0	224	"CREATE view sys.dm_hadr_instance_node_map
as
	SELECT 
	*
	FROM OpenRowset(TABLE DM_HADR_INSTANCE_NODE_MAP)
"
3980	Parse Tree	View	-266	32767	6	4	1	2	3	251	0	1	1024	0	0	0	0	0	316	"CREATE VIEW sys.resource_governor_resource_pool_affinity
AS
	SELECT pool_id, processor_group, scheduler_mask
	FROM OpenRowSet(TABLE SYS_RG_POOL_AFFINITY)
"
3991	Parse Tree	View	-208	32767	6	4	1	2	2	251	0	1	1024	0	0	0	0	0	156	"CREATE VIEW sys.sysopentapes AS
	SELECT * FROM OpenRowset (TABLE OPENTAPES)
"
4000	Parse Tree	View	-532309064	32767	6	4	1	8	13	251	0	1	1024	0	0	0	0	0	1848	"CREATE VIEW sys.parameters$ AS
	SELECT c.id AS object_id,
		c.number, c.name,
		c.colid AS parameter_id,
		c.xtype AS system_type_id,
		c.utype AS user_type_id,
		c.length AS max_length,
		c.prec AS precision,
		c.scale AS scale,
		sysconv(bit, c.status & 512) AS is_output,		-- CPM_OUTPUT
		sysconv(bit, c.status & 1024) AS is_cursor_ref,	-- CPM_CURSORREF
		sysconv(bit, isnull(v.objid, 0)) AS has_default_value,
		sysconv(bit, c.status & 2048) AS is_xml_document, -- CPM_XML_DOC		
		v.value AS default_value,
		xmlns AS xml_collection_id,
		sysconv(bit, c.status & 4194304) AS is_readonly, -- CPM_IS_READONLY = 0x00400000
		sysconv(bit, 1 - (c.status & 1)) AS is_nullable -- CPM_NOTNULL  = 0x00000001
	FROM sys.syscolpars c
	LEFT JOIN sys.sysobjvalues v ON v.valclass = 9 AND v.objid = c.id AND v.subobjid = c.colid AND v.valnum = 0	-- SVC_PARAMDEFAULT
	WHERE number > 0 AND has_access('CO', c.id) = 1
"
4205	Compiled Plan	Adhoc	740814204	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.dm_filestream_file_io_handles t
4237	Compiled Plan	Adhoc	33841652	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_os_waiting_tasks t
4268	Compiled Plan	Adhoc	461051091	6	0	-2	2	1	38	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.syscacheobjects t
4601	Compiled Plan	Adhoc	925655850	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.availability_groups_cluster t
4601	Compiled Plan	Adhoc	925655850	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.availability_groups_cluster t
4642	Compiled Plan	Adhoc	481642452	6	0	-2	3	3	19	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.all_objects t
4667	Compiled Plan	Adhoc	611585020	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.fulltext_system_stopwords t
4731	Compiled Plan	Adhoc	37989334	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_os_windows_info t
5035	Compiled Plan	Adhoc	109458795	6	0	-2	2	1	177	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.spatial_index_tessellations t
5035	Compiled Plan	Adhoc	109458795	6	0	-2	2	1	177	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.spatial_index_tessellations t
5061	Compiled Plan	Adhoc	516256975	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.query_store_runtime_stats_interval t
5138	Compiled Plan	Adhoc	404558528	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.database_recovery_status t
5138	Compiled Plan	Adhoc	404558528	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.database_recovery_status t
5450	Compiled Plan	Adhoc	704706098	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_os_memory_clerks t
5455	Compiled Plan	Adhoc	756724658	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.database_scoped_configurations t
5580	Compiled Plan	Adhoc	221570772	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_io_pending_io_requests t
5649	Compiled Plan	Adhoc	72837326	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.server_event_session_fields t
5672	Compiled Plan	Adhoc	123615419	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_broker_connections t
5672	Compiled Plan	Adhoc	123615419	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_broker_connections t
5730	Compiled Plan	Adhoc	265820751	6	0	-2	2	1	19	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.computed_columns t
5730	Compiled Plan	Adhoc	265820751	6	0	-2	2	2	19	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.computed_columns t
5873	Compiled Plan	Adhoc	712848000	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.column_store_row_groups t
5982	Compiled Plan	Adhoc	887560844	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	60	SELECT t.* FROM sys.openkeys t
6001	Compiled Plan	Adhoc	758645181	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_db_xtp_object_stats t
6001	Compiled Plan	Adhoc	758645181	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_db_xtp_object_stats t
6040	Compiled Plan	Adhoc	891495072	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM SchoolManagement.dbo.Homework t
6187	Compiled Plan	Adhoc	438573021	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	120	SELECT t.* FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS t
6187	Compiled Plan	Adhoc	438573021	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	120	SELECT t.* FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS t
6187	Compiled Plan	Adhoc	438573021	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	120	SELECT t.* FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS t
6213	Compiled Plan	Adhoc	209308119	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_os_virtual_address_dump t
6465	Compiled Plan	Adhoc	265600824	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.dm_os_host_info t
6494	Compiled Plan	Adhoc	271368793	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_exec_function_stats t
6661	Compiled Plan	Adhoc	65489175	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_os_schedulers t
6668	Compiled Plan	Adhoc	162344297	6	0	-2	2	3	22	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM INFORMATION_SCHEMA.VIEW_COLUMN_USAGE t
6830	Compiled Plan	Adhoc	184429292	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.foreign_key_columns t
6857	Compiled Plan	Adhoc	284311765	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_exec_cached_plans t
6883	Compiled Plan	Adhoc	827620844	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_io_cluster_valid_path_names t
6933	Compiled Plan	Adhoc	417835147	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_os_spinlock_stats t
6961	Compiled Plan	Adhoc	217723470	6	0	-2	2	1	10	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.master_key_passwords t
6961	Compiled Plan	Adhoc	217723470	6	0	-2	2	2	10	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.master_key_passwords t
7076	Compiled Plan	Adhoc	759678926	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	114	SELECT t.* FROM SchoolManagement.sys.trace_xe_event_map t
7144	Compiled Plan	Adhoc	430351331	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.dm_os_hosts t
7191	Compiled Plan	Adhoc	779556750	6	0	-2	2	1	220	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.databases t
7191	Compiled Plan	Adhoc	779556750	6	0	-2	2	2	220	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.databases t
7283	Compiled Plan	Adhoc	832395318	6	0	-2	3	3	8	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.dm_hadr_cluster t
7441	Compiled Plan	Adhoc	229446187	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.query_store_query_text t
7446	Compiled Plan	Adhoc	724284359	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	124	SELECT t.* FROM sys.resource_governor_resource_pool_affinity t
7510	Compiled Plan	Adhoc	316205715	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_column_store_object_pool t
7561	Compiled Plan	Adhoc	14557868	6	0	-2	2	3	14	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.endpoints t
7614	Compiled Plan	Adhoc	923729252	6	0	-2	2	2	15	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.resource_governor_resource_pools t
7639	Compiled Plan	Adhoc	394283300	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.partition_range_values t
7649	Compiled Plan	Adhoc	287552626	6	0	-2	2	3	16	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.external_libraries t
7660	Compiled Plan	Adhoc	393343092	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.dm_clr_properties t
7850	Compiled Plan	Adhoc	66883020	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_exec_distributed_requests t
7918	Compiled Plan	Adhoc	357134990	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.conversation_endpoints t
7918	Compiled Plan	Adhoc	357134990	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.conversation_endpoints t
7959	Compiled Plan	Adhoc	823086670	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_os_cluster_nodes t
8082	Compiled Plan	Adhoc	834229197	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	132	SELECT t.* FROM sys.dm_resource_governor_external_resource_pools t
8133	Compiled Plan	Adhoc	194065010	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_exec_external_work t
8276	Compiled Plan	Adhoc	85607303	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM SchoolManagement.dbo.Attendance t
8384	Compiled Plan	Adhoc	63162272	6	0	-2	2	2	22	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.resource_governor_workload_groups t
8549	Compiled Plan	Adhoc	968146066	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.credentials t
8549	Compiled Plan	Adhoc	968146066	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.credentials t
8552	Compiled Plan	Adhoc	162664683	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.dm_os_dispatchers t
8675	Compiled Plan	Adhoc	754137946	6	0	-2	2	3	14	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_db_missing_index_details t
8686	Compiled Plan	Adhoc	427390922	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.dm_os_server_diagnostics_log_configurations t
8778	Compiled Plan	Adhoc	293587505	6	0	-2	2	1	22	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.assembly_types t
8778	Compiled Plan	Adhoc	293587505	6	0	-2	2	2	22	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.assembly_types t
9375	Compiled Plan	Prepared	428958056	6	0	-2	2	1	5	4473	0	1	1156	0	0	0	0	0	338	"()
 select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SchoolManagement].[sys].[filetable_updates_2105058535] with (readpast) order by table_id"
9659	Compiled Plan	Adhoc	494159437	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM INFORMATION_SCHEMA.ROUTINE_COLUMNS t
9659	Compiled Plan	Adhoc	494159437	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM INFORMATION_SCHEMA.ROUTINE_COLUMNS t
9659	Compiled Plan	Adhoc	494159437	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM INFORMATION_SCHEMA.ROUTINE_COLUMNS t
9672	Compiled Plan	Adhoc	704680129	6	0	-2	2	3	18	251	0	1	1024	0	0	0	0	0	114	SELECT t.* FROM sys.dm_hadr_availability_replica_states t
9818	Compiled Plan	Adhoc	335063675	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_repl_tranhash t
9854	Compiled Plan	Adhoc	117374712	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.dm_db_xtp_nonclustered_index_stats t
9986	Compiled Plan	Adhoc	113693906	6	0	-2	2	1	40	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.server_event_session_actions t
9986	Compiled Plan	Adhoc	113693906	6	0	-2	2	1	40	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.server_event_session_actions t
10041	Compiled Plan	Adhoc	334136837	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	136	SELECT t.* FROM sys.fulltext_semantic_language_statistics_database t
10086	Compiled Plan	Adhoc	413734750	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_xtp_transaction_stats t
10108	Compiled Plan	Adhoc	532174730	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	122	SELECT t.* FROM sys.dm_tran_global_transactions_enlistments t
10119	Compiled Plan	Adhoc	538702867	6	0	-2	2	3	12	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_exec_trigger_stats t
10173	Compiled Plan	Adhoc	796160982	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_hash_index_stats t
10173	Compiled Plan	Adhoc	796160982	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_hash_index_stats t
10384	Compiled Plan	Adhoc	89075101	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.external_file_formats t
10410	Compiled Plan	Prepared	945423080	1	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	812	"(@P0 int)with CT as ( select cast(1 + is_table_type + is_assembly_type * 2 as tinyint) as type_kind,
                    abs(cast(checksum(user_type_id, name) as bigint)) as c_s
                    from SchoolManagement.sys.types
                    where schema_id = @P0
                      and is_user_defined >= 1 )
select type_kind, sum(c_s) as check_sum
from CT
group by type_kind
order by type_kind        "
10580	Compiled Plan	Prepared	414703865	1	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	716	"(@P0 int,@P1 datetime2)select O.parent_object_id as parent_id,
       M.object_id,
       case when O.type = 'TR' or O.type = 'TA' then 1 else 0 end as is_trigger,
       M.definition as text
from SchoolManagement.sys.sql_modules M
     inner join SchoolManagement.sys.objects O on M.object_id = O.object_id
where O.schema_id = @P0
  and O.modify_date >= @P1                "
10586	Compiled Plan	Adhoc	126936985	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.column_type_usages t
10587	Compiled Plan	Adhoc	772235669	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.dm_exec_query_resource_semaphores t
10629	Compiled Plan	Adhoc	470127526	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.dm_os_latch_stats t
10643	Compiled Plan	Adhoc	426144301	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM SchoolManagement.sys.plan_persist_plan t
11167	Compiled Plan	Adhoc	816459047	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.change_tracking_databases t
11167	Compiled Plan	Adhoc	816459047	6	0	-2	2	2	23	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.change_tracking_databases t
11442	Compiled Plan	Adhoc	263581199	6	0	-2	2	1	24	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.crypt_properties t
11442	Compiled Plan	Adhoc	263581199	6	0	-2	2	2	24	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.crypt_properties t
11516	Compiled Plan	Adhoc	681141808	6	0	-2	2	3	14	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_exec_session_wait_stats t
11598	Compiled Plan	Adhoc	826348010	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.periods t
11732	Compiled Plan	Adhoc	992892163	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_db_index_usage_stats t
11756	Compiled Plan	Adhoc	603884469	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM SchoolManagement.dbo.CourseEnrollment t
11756	Compiled Plan	Adhoc	603884469	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM SchoolManagement.dbo.CourseEnrollment t
11888	Compiled Plan	Adhoc	745756596	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_exec_query_parallel_workers t
11939	Compiled Plan	Adhoc	101471482	6	0	-2	3	3	9	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.dm_tran_locks t
12228	Compiled Plan	Adhoc	856754955	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.remote_data_archive_databases t
12286	Compiled Plan	Prepared	849363347	1	0	-2	2	1	20	251	0	1	1024	0	0	0	0	0	1334	"(@P0 int)select sum(abs(cast(checksum(major_id, minor_id, cast(value as varchar(40))) as bigint))) as checksum
from SchoolManagement.sys.extended_properties X
     left join SchoolManagement.sys.all_objects O
        on O.object_id = X.major_id
       and O.type in ('U','S','IT','V','FN','IF','P','X','PC','TF','TT','C','F','D','PK','SN','SO','UQ','TR')
       and X.class <> 6
       and X.class <> 3
     left join SchoolManagement.sys.types T
        on T.user_type_id = X.major_id
       and X.class = 6
where coalesce(O.schema_id, T.schema_id, case when X.class = 3 then X.major_id else null end) = @P0
  and X.name = N'MS_Description'
  and X.value is not null        "
12363	Compiled Plan	Adhoc	802722823	6	0	-2	3	3	11	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_os_ring_buffers t
12405	Compiled Plan	Adhoc	555387001	6	0	-2	2	3	13	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_os_wait_stats t
12422	Compiled Plan	Adhoc	735514381	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.registered_search_properties t
12434	Compiled Plan	Adhoc	822493949	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_os_memory_broker_clerks t
12620	Compiled Plan	Adhoc	357389164	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_hadr_automatic_seeding t
12667	Compiled Plan	Adhoc	386482383	6	0	-2	2	1	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.server_audit_specifications t
12667	Compiled Plan	Adhoc	386482383	6	0	-2	2	1	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.server_audit_specifications t
12715	Compiled Plan	Adhoc	460258987	6	0	-2	2	1	39	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.foreign_keys t
12715	Compiled Plan	Adhoc	460258987	6	0	-2	2	2	39	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.foreign_keys t
13043	Compiled Plan	Adhoc	125757129	6	0	-2	2	1	170	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_uncontained_entities t
13043	Compiled Plan	Adhoc	125757129	6	0	-2	2	1	170	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_uncontained_entities t
13043	Compiled Plan	Adhoc	125757129	6	0	-2	2	1	170	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_uncontained_entities t
13121	Compiled Plan	Adhoc	46579331	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.sql_dependencies t
13170	Compiled Plan	Adhoc	859195661	6	0	-2	2	1	25	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.server_audits t
13170	Compiled Plan	Adhoc	859195661	6	0	-2	2	1	25	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.server_audits t
13291	Compiled Plan	Adhoc	891836357	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.selective_xml_index_namespaces t
13445	Compiled Plan	Adhoc	724892162	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_broker_activated_tasks t
13445	Compiled Plan	Adhoc	724892162	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_broker_activated_tasks t
13603	Compiled Plan	Adhoc	304544107	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_hadr_cluster_networks t
13647	Compiled Plan	Adhoc	794921282	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.fulltext_index_fragments t
13813	Compiled Plan	Adhoc	91056118	6	0	-2	2	3	13	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.fulltext_indexes t
13842	Compiled Plan	Adhoc	81660676	6	0	-2	2	3	17	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.filegroups t
13972	Compiled Plan	Adhoc	897497744	6	0	-2	2	1	20	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_db_partition_stats t
13972	Compiled Plan	Adhoc	897497744	6	0	-2	2	2	20	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_db_partition_stats t
14025	Compiled Plan	Adhoc	553506848	6	0	-2	2	2	10	251	0	1	1024	0	0	0	0	0	60	SELECT t.* FROM sys.services t
14180	Compiled Plan	Adhoc	771402747	6	0	-2	3	3	14	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_os_memory_cache_entries t
14259	Compiled Plan	Adhoc	885981868	6	0	-2	2	3	22	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.http_endpoints t
14468	Compiled Plan	Adhoc	523626867	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.availability_group_listeners t
14655	Compiled Plan	Adhoc	235435403	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.dm_resource_governor_workload_groups t
14780	Compiled Plan	Adhoc	490899557	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.extended_properties t
14800	Compiled Plan	Adhoc	140247348	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_os_memory_cache_hash_tables t
14829	Compiled Plan	Adhoc	435000324	6	0	-2	2	1	25	251	0	1	1024	0	0	0	0	0	60	SELECT t.* FROM sys.synonyms t
14829	Compiled Plan	Adhoc	435000324	6	0	-2	2	1	25	251	0	1	1024	0	0	0	0	0	60	SELECT t.* FROM sys.synonyms t
14838	Compiled Plan	Adhoc	391570556	6	0	-2	2	1	20	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.check_constraints t
14838	Compiled Plan	Adhoc	391570556	6	0	-2	2	2	20	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.check_constraints t
14866	Compiled Plan	Adhoc	319887769	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.database_permissions t
14866	Compiled Plan	Adhoc	319887769	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.database_permissions t
14901	Compiled Plan	Adhoc	662451501	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	114	SELECT t.* FROM sys.column_xml_schema_collection_usages t
15120	Compiled Plan	Adhoc	820227220	6	0	-2	2	3	25	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.extended_procedures t
15257	Compiled Plan	Adhoc	558854923	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.filetable_system_defined_objects t
15263	Compiled Plan	Adhoc	339965685	6	0	-2	2	2	21	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.partitions t
15325	Compiled Plan	Adhoc	376800648	6	0	-2	2	1	21	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.database_principals t
15325	Compiled Plan	Adhoc	376800648	6	0	-2	2	2	22	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.database_principals t
15447	Compiled Plan	Adhoc	457205422	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.dm_resource_governor_configuration t
15455	Compiled Plan	Adhoc	41578595	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_hadr_cluster_members t
15471	Compiled Plan	Adhoc	203348321	6	0	-2	2	3	13	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_exec_dms_workers t
15671	Compiled Plan	Adhoc	755379391	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_exec_sessions t
15961	Compiled Plan	Adhoc	774730459	6	0	-2	2	1	33	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.service_queues t
15961	Compiled Plan	Adhoc	774730459	6	0	-2	2	1	33	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.service_queues t
15968	Compiled Plan	Adhoc	796728742	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS t
15968	Compiled Plan	Adhoc	796728742	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS t
15968	Compiled Plan	Adhoc	796728742	6	0	-2	2	1	23	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS t
16064	Compiled Plan	Adhoc	85568592	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_exec_background_job_queue t
16069	Compiled Plan	Adhoc	98978276	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_xe_session_object_columns t
16073	Compiled Plan	Adhoc	617508253	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM sys.dm_hadr_database_replica_states t
16149	Compiled Plan	Adhoc	203308425	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.availability_replicas t
16149	Compiled Plan	Adhoc	203308425	6	0	-2	2	2	18	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.availability_replicas t
16172	Compiled Plan	Adhoc	988411895	6	0	-2	3	3	8	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_rda_migration_status t
16239	Compiled Plan	Adhoc	44272665	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM SchoolManagement.dbo.StudentGroup t
16265	Compiled Plan	Adhoc	681402658	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_os_memory_pools t
16315	Compiled Plan	Adhoc	354515800	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	122	SELECT t.* FROM sys.dm_hadr_database_replica_cluster_states t
16365	Compiled Plan	Adhoc	497934737	6	0	-2	2	1	33	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_db_script_level t
16365	Compiled Plan	Adhoc	497934737	6	0	-2	2	2	33	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_db_script_level t
16670	Compiled Plan	Adhoc	72725804	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM SchoolManagement.dbo.Student t
16691	Compiled Plan	Adhoc	636672667	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.module_assembly_usages t
16831	Compiled Plan	Adhoc	962252787	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.availability_groups t
16887	Compiled Plan	Adhoc	661371589	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_xtp_gc_queue_stats t
16943	Compiled Plan	Adhoc	336765245	6	0	-2	3	3	17	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_os_performance_counters t
16983	Compiled Plan	Prepared	71273012	1	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	1142	"(@P0 int,@P1 datetime2)select T.object_id as table_id,
       K.object_id as key_id,
       K.unique_index_id % 30000 as index_position,
       K.name,
       case when K.type = 'PK' then 1 else 0 end as is_primary,
       K.is_system_named,
       K.create_date,
       K.modify_date
from SchoolManagement.sys.all_objects T
     join SchoolManagement.sys.key_constraints K on T.object_id = K.parent_object_id and T.schema_id = K.schema_id
where T.schema_id = @P0
  and T.modify_date >= @P1
order by T.create_date, T.object_id, is_primary desc, K.create_date, K.object_id                "
17059	Compiled Plan	Adhoc	990779242	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_server_services t
17236	Compiled Plan	Adhoc	902939512	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_qn_subscriptions t
17258	Compiled Plan	Adhoc	413802627	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM INFORMATION_SCHEMA.TABLES t
17258	Compiled Plan	Adhoc	413802627	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM INFORMATION_SCHEMA.TABLES t
17428	Compiled Plan	Adhoc	625078035	1	0	-2	2	1	37	251	0	1	1024	0	0	0	0	0	438	"select database_id as id, name, cast(databasepropertyex(name,'collation') as char) as collation_name
from sys.databases
order by case when /* name = db_name() */database_id = db_id()  then 1 else 0 end desc, database_id"
17444	Compiled Plan	Adhoc	329623722	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.database_audit_specifications t
17475	Compiled Plan	Adhoc	195066792	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.destination_data_spaces t
17806	Compiled Plan	Adhoc	64670848	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_io_cluster_shared_drives t
17890	Compiled Plan	Adhoc	107720546	6	0	-2	2	3	19	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_exec_query_stats t
17965	Compiled Plan	Adhoc	714138606	1	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	278	"select schema_id as id, name
from SchoolManagement.sys.schemas
order by case when schema_id = schema_id() then 1 else 0 end desc, schema_id"
18052	Compiled Plan	Adhoc	226507294	6	0	-2	4	3	22	251	0	1	1024	0	0	0	0	0	60	SELECT t.* FROM sys.messages t
18087	Compiled Plan	Adhoc	345340698	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_exec_compute_node_status t
18101	Compiled Plan	Adhoc	492360439	6	0	-2	2	2	9	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.server_sql_modules t
18111	Compiled Plan	Adhoc	621162748	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_checkpoint_files t
18111	Compiled Plan	Adhoc	621162748	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_checkpoint_files t
18290	Compiled Plan	Adhoc	136660456	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_os_memory_node_access_stats t
18324	Compiled Plan	Adhoc	470508894	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.server_principal_credentials t
18324	Compiled Plan	Adhoc	705201688	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_fts_active_catalogs t
18377	Compiled Plan	Adhoc	418343835	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.linked_logins t
18533	Compiled Plan	Adhoc	558135307	6	0	-2	2	1	125	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.columns t
18533	Compiled Plan	Adhoc	558135307	6	0	-2	2	2	125	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.columns t
18583	Compiled Plan	Adhoc	489186472	6	0	-2	2	2	26	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.query_store_query t
18647	Compiled Plan	Adhoc	130839206	6	0	-2	2	2	20	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.procedures t
18780	Compiled Plan	Adhoc	887843040	6	0	-2	1	3	2	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.dm_fts_fdhosts t
18826	Compiled Plan	Adhoc	494527714	6	0	-2	3	3	8	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM SchoolManagement.dbo.Course t
18896	Compiled Plan	Adhoc	186991879	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.security_policies t
18896	Compiled Plan	Adhoc	186991879	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.security_policies t
18978	Compiled Plan	Adhoc	231575255	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.fulltext_stoplists t
19098	Compiled Plan	Adhoc	702961313	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.database_automatic_tuning_options t
19098	Compiled Plan	Adhoc	702961313	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.database_automatic_tuning_options t
19232	Compiled Plan	Adhoc	388597286	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_db_xtp_transactions t
19280	Compiled Plan	Adhoc	146102745	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM SchoolManagement.sys.trace_xe_action_map t
19337	Compiled Plan	Adhoc	367172484	6	0	-2	3	3	61	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM INFORMATION_SCHEMA.ROUTINES t
19342	Compiled Plan	Adhoc	670767445	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.dm_external_script_execution_stats t
19509	Compiled Plan	Adhoc	863017577	6	0	-2	2	1	17	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.soap_endpoints t
19509	Compiled Plan	Adhoc	863017577	6	0	-2	2	1	17	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.soap_endpoints t
19550	Compiled Plan	Adhoc	510864843	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM sys.resource_governor_configuration t
19589	Compiled Plan	Adhoc	498402046	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_os_buffer_descriptors t
19691	Compiled Plan	Adhoc	923417861	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_logpool_hashentries t
19771	Compiled Plan	Adhoc	663745937	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.external_data_sources t
19805	Compiled Plan	Adhoc	136440659	6	0	-2	2	3	15	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.key_constraints t
19892	Compiled Plan	Adhoc	570358283	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_db_mirroring_connections t
19892	Compiled Plan	Adhoc	570358283	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_db_mirroring_connections t
20040	Compiled Plan	Adhoc	798183081	6	0	-2	1	3	2	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_fts_memory_buffers t
20086	Compiled Plan	Adhoc	576986473	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_exec_valid_use_hints t
20124	Compiled Plan	Adhoc	572292090	6	0	-2	2	1	20	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.configurations t
20124	Compiled Plan	Adhoc	572292090	6	0	-2	2	2	20	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.configurations t
20213	Compiled Plan	Adhoc	852562009	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_exec_compute_node_errors t
20255	Compiled Plan	Adhoc	542932174	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_os_sys_memory t
20339	Compiled Plan	Adhoc	392778411	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	118	SELECT t.* FROM sys.dm_fts_semantic_similarity_population t
20360	Compiled Plan	Adhoc	686384461	6	0	-2	2	3	23	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.identity_columns t
20447	Compiled Plan	Adhoc	692285803	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.dm_cdc_errors t
20608	Compiled Plan	Adhoc	682650329	6	0	-2	2	2	10	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.server_event_session_events t
20717	Compiled Plan	Adhoc	664279548	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_db_task_space_usage t
20818	Compiled Plan	Adhoc	849488085	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_db_xtp_index_stats t
20818	Compiled Plan	Adhoc	849488085	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_db_xtp_index_stats t
20992	Compiled Plan	Adhoc	339173128	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_exec_query_optimizer_info t
21050	Compiled Plan	Adhoc	608206990	6	0	-2	2	3	17	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_db_xtp_table_memory_stats t
21056	Compiled Plan	Adhoc	966447768	6	0	-2	2	2	17	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.objects t
21150	Compiled Plan	Adhoc	218372647	6	0	-2	2	3	15	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_repl_articles t
21292	Compiled Plan	Adhoc	7098478	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_os_enumerate_fixed_drives t
21488	Compiled Plan	Adhoc	73846859	6	0	-2	2	3	19	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM sys.dm_db_missing_index_group_stats t
21505	Compiled Plan	Adhoc	661585740	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_os_sublatches t
21645	Compiled Plan	Adhoc	535464059	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.dm_xe_packages t
21707	Compiled Plan	Adhoc	597984800	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	124	SELECT t.* FROM sys.availability_group_listener_ip_addresses t
21769	Compiled Plan	Adhoc	797536557	6	0	-2	3	3	8	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM SchoolManagement.dbo.Department t
21874	Compiled Plan	Adhoc	78914730	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_hadr_auto_page_repair t
21979	Compiled Plan	Adhoc	90857434	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_os_dispatcher_pools t
22045	Compiled Plan	Adhoc	684310942	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_db_file_space_usage t
22147	Compiled Plan	Adhoc	579647415	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.memory_optimized_tables_internal_attributes t
22147	Compiled Plan	Adhoc	579647415	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.memory_optimized_tables_internal_attributes t
22160	Compiled Plan	Adhoc	128699310	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.database_scoped_credentials t
22160	Compiled Plan	Adhoc	128699310	6	0	-2	2	2	18	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.database_scoped_credentials t
22194	Compiled Plan	Adhoc	525081815	6	0	-2	1	3	2	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_fts_memory_pools t
22355	Compiled Plan	Adhoc	82829024	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.column_master_keys t
22355	Compiled Plan	Adhoc	82829024	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.column_master_keys t
22520	Compiled Plan	Adhoc	7512109	6	0	-2	2	3	14	251	0	1	1024	0	0	0	0	0	62	SELECT t.* FROM sys.all_views t
22558	Compiled Plan	Adhoc	34104764	6	0	-2	2	3	24	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.indexes t
22621	Compiled Plan	Adhoc	492187820	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_os_memory_cache_clock_hands t
22636	Compiled Plan	Adhoc	143569401	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.dm_exec_background_job_queue_stats t
22714	Compiled Plan	Adhoc	739703705	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_os_memory_nodes t
22827	Compiled Plan	Adhoc	94605085	6	0	-2	2	2	42	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.parameters t
22973	Compiled Plan	Adhoc	938421783	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	126	SELECT t.* FROM sys.resource_governor_external_resource_pools t
23003	Compiled Plan	Adhoc	250466842	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_os_worker_local_storage t
23030	Compiled Plan	Adhoc	845220827	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.parameter_type_usages t
23078	Compiled Plan	Adhoc	403481275	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	128	SELECT t.* FROM sys.dm_resource_governor_resource_pool_volumes t
23157	Compiled Plan	Adhoc	404114764	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.query_context_settings t
23173	Compiled Plan	Adhoc	956252494	6	0	-2	2	3	24	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.event_notifications t
23250	Compiled Plan	Adhoc	724607065	6	0	-2	2	3	17	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.index_columns t
23254	Compiled Plan	Adhoc	845607618	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.database_mirroring_witnesses t
23309	Compiled Plan	Adhoc	104033953	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.fulltext_index_catalog_usages t
23310	Compiled Plan	Adhoc	573012783	6	0	-2	3	3	9	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_xe_session_targets t
23367	Compiled Plan	Adhoc	77161251	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.column_encryption_keys t
23405	Compiled Plan	Adhoc	853242694	6	0	-2	2	1	26	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_db_fts_index_physical_stats t
23405	Compiled Plan	Adhoc	853242694	6	0	-2	2	2	26	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_db_fts_index_physical_stats t
23512	Compiled Plan	Adhoc	66352177	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	54	SELECT t.* FROM sys.stats t
23549	Compiled Plan	Adhoc	134280797	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.data_spaces t
23549	Compiled Plan	Adhoc	134280797	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.data_spaces t
23552	Compiled Plan	Adhoc	364952687	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_tran_session_transactions t
23911	Compiled Plan	Adhoc	708476689	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	114	SELECT t.* FROM sys.dm_resource_governor_resource_pools t
23915	Compiled Plan	Adhoc	243425410	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.dm_xtp_gc_stats t
23927	Compiled Plan	Prepared	745391597	1	0	-2	2	1	17	251	0	1	1024	0	0	0	0	0	894	"(@P0 int,@P1 datetime2)select T.object_id,
       I.index_id % 30000 as position,
       I.name,
       I.type,
       I.filter_definition, 
       I.is_unique,
       I.is_disabled
from SchoolManagement.sys.all_objects T,
     SchoolManagement.sys.indexes I
where T.schema_id = @P0
  and T.type in ('U','S','IT','V','TT')
  and T.modify_date >= @P1
  and T.object_id = I.object_id
  and I.type != 0
order by T.create_date, I.object_id, I.index_id                "
24328	Compiled Plan	Adhoc	55909964	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_tran_active_transactions t
24348	Compiled Plan	Adhoc	668194367	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.service_contracts t
24348	Compiled Plan	Adhoc	668194367	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.service_contracts t
24419	Compiled Plan	Adhoc	70986704	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_broker_queue_monitors t
24478	Compiled Plan	Adhoc	994961419	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.backup_devices t
24478	Compiled Plan	Adhoc	994961419	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.backup_devices t
24822	Compiled Plan	Adhoc	251460702	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	140	SELECT t.* FROM SchoolManagement.sys.filestream_tombstone_2073058421 t
24862	Compiled Plan	Adhoc	127766217	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_exec_connections t
24944	Compiled Plan	Adhoc	891991667	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.column_encryption_key_values t
24944	Compiled Plan	Adhoc	891991667	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.column_encryption_key_values t
25002	Compiled Plan	Adhoc	205890481	6	0	-2	2	3	13	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.key_encryptions t
25133	Compiled Plan	Adhoc	962867642	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.dm_hadr_name_id_map t
25278	Compiled Plan	Adhoc	872160595	6	0	-2	2	1	24	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM INFORMATION_SCHEMA.DOMAINS t
25346	Compiled Plan	Adhoc	423646189	6	0	-2	2	2	18	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.query_store_wait_stats t
25368	Compiled Plan	Adhoc	504717763	6	0	-2	3	3	9	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM sys.dm_tran_global_transactions_log t
25406	Compiled Plan	Adhoc	37959439	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	122	SELECT t.* FROM sys.dm_exec_query_optimizer_memory_gateways t
25543	Compiled Plan	Adhoc	966815265	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_tcp_listener_states t
25670	Compiled Plan	Adhoc	782367128	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.service_broker_endpoints t
25670	Compiled Plan	Adhoc	782367128	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.service_broker_endpoints t
25710	Compiled Plan	Adhoc	210331598	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_tran_current_snapshot t
25943	Compiled Plan	Adhoc	964708191	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_db_persisted_sku_features t
25976	Compiled Plan	Adhoc	768324020	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_db_session_space_usage t
26036	Compiled Plan	Adhoc	704549493	6	0	-2	3	3	8	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM SchoolManagement.dbo.Exam t
26056	Compiled Plan	Adhoc	147930952	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.schemas t
26063	Compiled Plan	Adhoc	169729190	6	0	-2	2	1	41	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.asymmetric_keys t
26063	Compiled Plan	Adhoc	169729190	6	0	-2	2	2	41	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.asymmetric_keys t
26127	Compiled Plan	Adhoc	76761621	6	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_xe_map_values t
26127	Compiled Plan	Adhoc	76761621	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_xe_map_values t
26295	Compiled Plan	Adhoc	333459393	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.dm_cryptographic_provider_properties t
26296	Compiled Plan	Adhoc	9099762	6	0	-2	2	3	13	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.hash_indexes t
26303	Compiled Plan	Adhoc	385617794	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.dm_tran_version_store_space_usage t
26330	Compiled Plan	Adhoc	661659894	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.dm_exec_distributed_request_steps t
26351	Compiled Plan	Adhoc	465115685	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.database_audit_specification_details t
26351	Compiled Plan	Adhoc	465115685	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.database_audit_specification_details t
26366	Compiled Plan	Adhoc	537632000	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_checkpoint_stats t
26377	Compiled Plan	Adhoc	283221439	6	0	-2	2	3	20	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM sys.dm_hadr_availability_group_states t
26633	Compiled Plan	Adhoc	161487431	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM sys.service_contract_message_usages t
26684	Compiled Plan	Adhoc	145383817	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_exec_compute_nodes t
26737	Compiled Plan	Prepared	71202748	1	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	628	"(@P0 int,@P1 datetime2)select object_id,
       name,
       rtrim(type) as type,
       create_date,
       modify_date,
       is_ms_shipped
from SchoolManagement.sys.all_objects
where type in ('U','S','IT','V','FN','IF','P','X','PC','TF','TT')
  and schema_id = @P0
  and modify_date >= @P1
order by create_date                "
26807	Compiled Plan	Adhoc	517127461	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_exec_query_profiles t
26831	Compiled Plan	Adhoc	69946872	6	0	-2	2	3	12	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_exec_procedure_stats t
26949	Compiled Plan	Adhoc	252761349	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	126	SELECT t.* FROM sys.dm_os_buffer_pool_extension_configuration t
26961	Compiled Plan	Adhoc	99046773	6	0	-2	2	1	18	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.database_credentials t
26961	Compiled Plan	Adhoc	99046773	6	0	-2	2	2	18	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.database_credentials t
27007	Compiled Plan	Adhoc	302825954	6	0	-2	2	3	16	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.assemblies t
27152	Compiled Plan	Adhoc	97813194	6	0	-2	2	3	18	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.internal_partitions t
27254	Compiled Plan	Adhoc	621290967	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.dm_io_backup_tapes t
27260	Compiled Plan	Adhoc	505945021	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM SchoolManagement.dbo.Classroom t
27349	Compiled Plan	Adhoc	796457244	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.dm_repl_schemas t
27409	Compiled Plan	Adhoc	295304329	6	0	-2	2	3	16	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.assembly_files t
27434	Compiled Plan	Adhoc	883190102	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.spatial_reference_systems t
27434	Compiled Plan	Adhoc	883190102	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.spatial_reference_systems t
27711	Compiled Plan	Adhoc	23389879	6	0	-2	2	3	22	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.dm_db_column_store_row_group_physical_stats t
27914	Compiled Plan	Prepared	917034194	1	0	-2	2	1	17	251	0	1	1024	0	0	0	0	0	570	"(@P0 int,@P1 datetime2)select T.object_id,
       C.name
from sys.all_objects T,
     sys.fulltext_index_columns X,
     sys.all_columns C
where T.schema_id = @P0
  and T.modify_date >= @P1
  and T.object_id = X.object_id
  and X.object_id = C.object_id
  and X.column_id = C.column_id                "
27972	Compiled Plan	Adhoc	4685715	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_tran_commit_table t
27998	Compiled Plan	Adhoc	112936737	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.securable_classes t
28007	Compiled Plan	Adhoc	827957773	6	0	-2	2	3	19	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.assembly_modules t
28008	Compiled Plan	Adhoc	903368070	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.remote_service_bindings t
28070	Compiled Plan	Adhoc	723074190	6	0	-2	2	1	11	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_tran_top_version_generators t
28070	Compiled Plan	Adhoc	723074190	6	0	-2	2	2	11	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_tran_top_version_generators t
28084	Compiled Plan	Adhoc	697334878	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_logpool_stats t
28084	Compiled Plan	Adhoc	697334878	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_logpool_stats t
28128	Compiled Plan	Adhoc	151358735	6	0	-2	2	2	43	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.query_store_runtime_stats t
28132	Compiled Plan	Adhoc	618160	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.fulltext_document_types t
28181	Compiled Plan	Adhoc	661160090	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.conversation_priorities t
28312	Compiled Plan	Adhoc	695534511	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_external_script_requests t
28579	Compiled Plan	Adhoc	828944757	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.dm_os_stacks t
28617	Compiled Plan	Adhoc	701502571	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_exec_query_memory_grants t
28771	Compiled Plan	Adhoc	909802978	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.fulltext_semantic_languages t
28854	Compiled Plan	Adhoc	150278613	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.server_triggers t
28854	Compiled Plan	Adhoc	150278613	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.server_triggers t
29028	Compiled Plan	Adhoc	126393269	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.dm_os_tasks t
29071	Compiled Plan	Adhoc	249334265	6	0	-2	2	1	16	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS t
29071	Compiled Plan	Adhoc	249334265	6	0	-2	2	2	10	251	0	1	1024	0	0	0	0	0	110	SELECT t.* FROM INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS t
29071	Compiled Plan	Adhoc	626099018	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	128	SELECT t.* FROM sys.dm_hadr_availability_replica_cluster_nodes t
29117	Compiled Plan	Adhoc	690806915	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_audit_actions t
29117	Compiled Plan	Adhoc	690806915	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_audit_actions t
29151	Compiled Plan	Adhoc	691180338	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM sys.dm_exec_distributed_sql_requests t
29153	Compiled Plan	Adhoc	334846848	6	0	-2	2	1	38	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM INFORMATION_SCHEMA.PARAMETERS t
29153	Compiled Plan	Adhoc	334846848	6	0	-2	2	2	38	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM INFORMATION_SCHEMA.PARAMETERS t
29193	Compiled Plan	Adhoc	100727523	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.dm_tran_transactions_snapshot t
29193	Compiled Plan	Adhoc	100727523	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.dm_tran_transactions_snapshot t
29249	Compiled Plan	Adhoc	409543667	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.default_constraints t
29249	Compiled Plan	Adhoc	409543667	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.default_constraints t
29336	Compiled Plan	Adhoc	593845140	6	0	-2	2	2	20	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.server_event_sessions t
29457	Compiled Plan	Adhoc	446525354	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_os_memory_allocations t
29601	Compiled Plan	Adhoc	121172190	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.endpoint_webmethods t
29679	Compiled Plan	Adhoc	708224260	6	0	-2	2	1	26	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.certificates t
29679	Compiled Plan	Adhoc	708224260	6	0	-2	2	2	26	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.certificates t
29689	Compiled Plan	Adhoc	290463620	6	0	-2	2	1	24	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.server_event_notifications t
29689	Compiled Plan	Adhoc	290463620	6	0	-2	2	1	24	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.server_event_notifications t
29814	Compiled Plan	Adhoc	17888992	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_os_memory_cache_counters t
29852	Compiled Plan	Adhoc	748960310	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_os_cluster_properties t
29852	Compiled Plan	Adhoc	748960310	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_os_cluster_properties t
29946	Compiled Plan	Adhoc	359325820	6	0	-2	2	2	14	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.sql_logins t
30027	Compiled Plan	Adhoc	617643942	6	0	-2	3	3	9	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_os_memory_objects t
30308	Compiled Plan	Adhoc	557597148	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.spatial_indexes t
30524	Compiled Plan	Adhoc	662020674	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.dm_tran_database_transactions t
30560	Compiled Plan	Adhoc	524269693	6	0	-2	3	3	11	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_xe_object_columns t
30561	Compiled Plan	Adhoc	378390211	6	0	-2	2	1	10	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.security_predicates t
30561	Compiled Plan	Adhoc	378390211	6	0	-2	2	1	10	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.security_predicates t
30570	Compiled Plan	Adhoc	53537137	6	0	-2	2	1	13	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.column_store_dictionaries t
30570	Compiled Plan	Adhoc	53537137	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.column_store_dictionaries t
30573	Compiled Plan	Adhoc	465649842	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.dm_resource_governor_resource_pool_affinity t
30589	Compiled Plan	Adhoc	868914083	6	0	-2	3	3	10	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_xe_session_events t
30666	Compiled Plan	Adhoc	41894534	6	0	-2	2	1	26	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.servers t
30666	Compiled Plan	Adhoc	41894534	6	0	-2	2	1	26	251	0	1	1024	0	0	0	0	0	58	SELECT t.* FROM sys.servers t
30727	Compiled Plan	Adhoc	92979369	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM SchoolManagement.sys.sysseobjvalues t
30740	Compiled Plan	Adhoc	895473416	6	0	-2	2	1	22	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.master_files t
30740	Compiled Plan	Adhoc	895473416	6	0	-2	2	2	22	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.master_files t
30756	Compiled Plan	Adhoc	405536350	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.dm_os_workers t
30762	Compiled Plan	Adhoc	98427267	6	0	-2	2	3	22	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM INFORMATION_SCHEMA.TABLE_PRIVILEGES t
30982	Compiled Plan	Adhoc	791556747	6	0	-2	2	3	20	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.cryptographic_providers t
31025	Compiled Plan	Adhoc	496243466	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.dm_os_threads t
31087	Compiled Plan	Adhoc	458101563	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.numbered_procedures t
31341	Compiled Plan	Adhoc	265282	6	0	-2	3	3	9	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_tran_global_transactions t
31367	Compiled Plan	Adhoc	859765488	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.dm_fts_index_population t
31371	Compiled Plan	Adhoc	13988374	6	0	-2	2	3	19	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM INFORMATION_SCHEMA.SEQUENCES t
31564	Compiled Plan	Adhoc	5539839	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_database_encryption_keys t
31613	Compiled Plan	Adhoc	519688838	6	0	-2	2	3	18	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM INFORMATION_SCHEMA.VIEW_TABLE_USAGE t
31636	Compiled Plan	Adhoc	306487549	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_exec_requests t
31694	Compiled Plan	Adhoc	140903644	6	0	-2	2	1	15	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.server_trigger_events t
31694	Compiled Plan	Adhoc	140903644	6	0	-2	2	1	15	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.server_trigger_events t
31712	Compiled Plan	Adhoc	176191585	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	130	SELECT t.* FROM sys.dm_hadr_availability_replica_cluster_states t
31730	Compiled Plan	Adhoc	916598333	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_fts_population_ranges t
31897	Compiled Plan	Adhoc	712678965	6	0	-2	3	3	11	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_os_loaded_modules t
31898	Compiled Plan	Adhoc	548435352	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.dm_tran_global_recovery_transactions t
31954	Compiled Plan	Adhoc	37347059	6	0	-2	2	2	13	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.stats_columns t
31977	Compiled Plan	Adhoc	107089418	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_os_process_memory t
32056	Compiled Plan	Adhoc	651765289	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.dm_repl_traninfo t
32070	Compiled Plan	Adhoc	460148854	6	0	-2	2	3	17	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.internal_tables t
32254	Compiled Plan	Adhoc	289123746	6	0	-2	2	1	46	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.server_file_audits t
32254	Compiled Plan	Adhoc	289123746	6	0	-2	2	1	46	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.server_file_audits t
32257	Compiled Plan	Adhoc	901241633	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.server_permissions t
32257	Compiled Plan	Adhoc	901241633	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	80	SELECT t.* FROM sys.server_permissions t
32298	Compiled Plan	Adhoc	206291787	6	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.filetables t
32298	Compiled Plan	Adhoc	206291787	6	0	-2	2	2	8	251	0	1	1024	0	0	0	0	0	64	SELECT t.* FROM sys.filetables t
32323	Compiled Plan	Adhoc	624179128	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.allocation_units t
32558	Compiled Plan	Adhoc	53084033	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_xtp_transaction_recent_rows t
32576	Compiled Plan	Prepared	265892381	1	0	-2	2	1	32	251	0	1	1024	0	0	0	0	0	1328	"(@P0 int,@P1 datetime2)select T.object_id,
       X.index_id % 30000 as index_position,
       C.name,
       X.is_descending_key as is_desc,
       X.is_included_column
from SchoolManagement.sys.all_objects T,
     SchoolManagement.sys.indexes I,
     SchoolManagement.sys.index_columns X,
     SchoolManagement.sys.all_columns C
where T.schema_id = @P0
  and T.type in ('U','S','IT','V','TT')
  and T.modify_date >= @P1
  and T.object_id = I.object_id
  and I.type != 0
  and I.object_id = X.object_id
  and I.index_id = X.index_id
  and X.object_id = C.object_id
  and X.column_id = C.column_id
order by T.create_date, X.object_id, X.index_id, X.index_column_id                "
32659	Compiled Plan	Adhoc	573927880	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	134	SELECT t.* FROM sys.dm_tran_active_snapshot_database_transactions t
32718	Compiled Plan	Adhoc	762297121	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.dm_exec_query_transformation_stats t
32802	Compiled Plan	Adhoc	438624134	6	0	-2	2	3	7	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.dm_xe_objects t
33035	Compiled Plan	Adhoc	508126474	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.fulltext_index_columns t
33096	Compiled Plan	Adhoc	692161216	6	0	-2	3	3	17	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.all_sql_modules t
33181	Compiled Plan	Adhoc	423934226	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_cdc_log_scan_sessions t
33181	Compiled Plan	Adhoc	423934226	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_cdc_log_scan_sessions t
33196	Compiled Plan	Adhoc	943151217	6	0	-2	2	2	19	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.server_assembly_modules t
33351	Compiled Plan	Adhoc	182226549	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	134	SELECT t.* FROM SchoolManagement.sys.filetable_updates_2105058535 t
33385	Compiled Plan	Adhoc	976818822	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	90	SELECT t.* FROM sys.service_contract_usages t
33419	Compiled Plan	Adhoc	493163172	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.database_filestream_options t
33677	Compiled Plan	Adhoc	745060070	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.server_audit_specification_details t
33677	Compiled Plan	Adhoc	745060070	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	112	SELECT t.* FROM sys.server_audit_specification_details t
33780	Compiled Plan	Adhoc	711605704	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.dm_xe_sessions t
33837	Compiled Plan	Adhoc	358946383	6	0	-2	2	1	19	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.column_store_segments t
33837	Compiled Plan	Adhoc	358946383	6	0	-2	2	2	19	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.column_store_segments t
33937	Compiled Plan	Adhoc	693715039	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_exec_dms_services t
33981	Compiled Plan	Adhoc	278888398	6	0	-2	2	3	20	251	0	1	1024	0	0	0	0	0	74	SELECT t.* FROM sys.external_tables t
34030	Compiled Plan	Adhoc	992442444	6	0	-2	4	3	110	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.all_columns t
34101	Compiled Plan	Adhoc	146818709	6	0	-2	2	2	12	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.sql_modules t
34254	Compiled Plan	Adhoc	107269838	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.dm_server_memory_dumps t
34261	Compiled Plan	Adhoc	466063883	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM SchoolManagement.sys.sqlagent_jobs t
34494	Compiled Plan	Adhoc	946578871	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM SchoolManagement.dbo.ExamResults t
34553	Compiled Plan	Adhoc	567340047	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.remote_logins t
34609	Compiled Plan	Adhoc	241773487	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	68	SELECT t.* FROM sys.dm_clr_tasks t
34734	Compiled Plan	Adhoc	197570231	6	0	-2	3	3	95	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.all_parameters t
34820	Compiled Plan	Adhoc	393480982	6	0	-2	2	2	35	251	0	1	1024	0	0	0	0	0	76	SELECT t.* FROM sys.query_store_plan t
34994	Compiled Plan	Adhoc	165229666	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.database_role_members t
34994	Compiled Plan	Adhoc	165229666	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.database_role_members t
35210	Compiled Plan	Adhoc	924000578	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	94	SELECT t.* FROM sys.dm_hadr_instance_node_map t
35350	Compiled Plan	Adhoc	678091760	6	0	-2	2	1	31	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.database_query_store_options t
35350	Compiled Plan	Adhoc	678091760	6	0	-2	2	2	31	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.database_query_store_options t
35373	Compiled Plan	Adhoc	913271525	6	0	-2	2	1	56	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_db_tuning_recommendations t
35373	Compiled Plan	Adhoc	913271525	6	0	-2	2	2	56	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_db_tuning_recommendations t
35398	Compiled Plan	Adhoc	603474983	6	0	-2	2	1	43	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE t
35398	Compiled Plan	Adhoc	603474983	6	0	-2	2	2	43	251	0	1	1024	0	0	0	0	0	106	SELECT t.* FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE t
35445	Compiled Plan	Adhoc	241000119	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.dm_xe_session_event_actions t
35592	Compiled Plan	Adhoc	167123525	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_os_child_instances t
35717	Compiled Plan	Adhoc	386459552	6	0	-2	2	3	8	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.availability_read_only_routing_lists t
35726	Compiled Plan	Adhoc	196636853	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.dm_xtp_threads t
36051	Compiled Plan	Adhoc	569754173	6	0	-2	2	2	27	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.remote_data_archive_tables t
36062	Compiled Plan	Adhoc	985734607	6	0	-2	2	2	16	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.server_event_session_targets t
36184	Compiled Plan	Adhoc	491546749	1	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	258	"select schema_id as id, name
from master.sys.schemas
order by case when schema_id = schema_id() then 1 else 0 end desc, schema_id"
36500	Compiled Plan	Adhoc	119379603	6	0	-2	2	3	11	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.external_library_files t
36568	Compiled Plan	Adhoc	283363169	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_clr_loaded_assemblies t
36583	Compiled Plan	Adhoc	551563503	6	0	-2	1	3	1	251	0	1	1024	0	0	0	0	0	136	SELECT t.* FROM SchoolManagement.sys.plan_persist_context_settings t
36664	Compiled Plan	Adhoc	303407694	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	116	SELECT t.* FROM sys.dm_filestream_non_transacted_handles t
36775	Compiled Plan	Adhoc	923367363	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_missing_index_groups t
36857	Compiled Plan	Adhoc	173171763	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM SchoolManagement.dbo.Professor t
37214	Compiled Plan	Adhoc	2313388	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.assembly_references t
37247	Compiled Plan	Adhoc	148686320	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.login_token t
37467	Compiled Plan	Adhoc	652693066	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.event_notification_event_types t
37524	Compiled Plan	Prepared	104981131	1	0	-2	2	1	8	251	0	1	1024	0	0	0	0	0	472	"(@P0 int,@P1 datetime2)select F.object_id,
       F.unique_index_id
from SchoolManagement.sys.all_objects T,
     SchoolManagement.sys.fulltext_indexes F
where T.schema_id = @P0
  and T.modify_date >= @P1
  and T.object_id = F.object_id                "
37602	Compiled Plan	Adhoc	400376330	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.service_message_types t
37602	Compiled Plan	Adhoc	400376330	6	0	-2	2	1	12	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.service_message_types t
37616	Compiled Plan	Adhoc	548676359	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	86	SELECT t.* FROM sys.dm_db_log_space_usage t
37621	Compiled Plan	Adhoc	131669221	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	88	SELECT t.* FROM sys.function_order_columns t
37627	Compiled Plan	Adhoc	781575609	6	0	-2	2	1	15	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.fulltext_catalogs t
37627	Compiled Plan	Adhoc	781575609	6	0	-2	2	2	15	251	0	1	1024	0	0	0	0	0	78	SELECT t.* FROM sys.fulltext_catalogs t
37651	Compiled Plan	Adhoc	487029164	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	92	SELECT t.* FROM sys.dm_db_xtp_gc_cycle_stats t
37721	Compiled Plan	Adhoc	954987967	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	102	SELECT t.* FROM sys.numbered_procedure_parameters t
37758	Compiled Plan	Adhoc	858319561	6	0	-2	2	1	6	251	0	1	1024	0	0	0	0	0	126	SELECT t.* FROM sys.message_type_xml_schema_collection_usages t
37758	Compiled Plan	Adhoc	858319561	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	126	SELECT t.* FROM sys.message_type_xml_schema_collection_usages t
37866	Compiled Plan	Adhoc	84545328	6	0	-2	2	1	5	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM SchoolManagement.dbo.DatabaseVersion t
37866	Compiled Plan	Adhoc	84545328	6	0	-2	2	2	5	251	0	1	1024	0	0	0	0	0	108	SELECT t.* FROM SchoolManagement.dbo.DatabaseVersion t
37882	Compiled Plan	Prepared	370146839	5	0	-2	2	1	5	4473	0	1	1156	0	0	0	0	0	318	"()
 select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [TestDB].[sys].[filetable_updates_2105058535] with (readpast) order by table_id"
38139	Compiled Plan	Adhoc	495057718	6	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_memory_consumers t
38139	Compiled Plan	Adhoc	495057718	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.dm_db_xtp_memory_consumers t
38212	Compiled Plan	Adhoc	29666374	6	0	-2	2	1	32	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.sql_expression_dependencies t
38212	Compiled Plan	Adhoc	29666374	6	0	-2	2	1	49	251	0	1	1024	0	0	0	0	0	98	SELECT t.* FROM sys.sql_expression_dependencies t
38227	Compiled Plan	Adhoc	490710088	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.dm_broker_forwarded_messages t
38262	Compiled Plan	Adhoc	174925725	6	0	-2	2	3	10	251	0	1	1024	0	0	0	0	0	96	SELECT t.* FROM sys.index_resumable_operations t
38284	Compiled Plan	Adhoc	835727900	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.partition_parameters t
38412	Compiled Plan	Adhoc	116192538	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	148	SELECT t.* FROM sys.dm_resource_governor_external_resource_pool_affinity t
38428	Compiled Plan	Adhoc	758150473	6	0	-2	2	3	16	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.database_files t
38710	Compiled Plan	Adhoc	69715466	6	0	-2	2	3	5	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_db_xtp_checkpoint_internals t
38759	Compiled Plan	Adhoc	785429998	6	0	-2	2	3	14	251	0	1	1024	0	0	0	0	0	56	SELECT t.* FROM sys.events t
38765	Compiled Plan	Adhoc	961949707	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_filestream_file_io_requests t
38897	Compiled Plan	Adhoc	980713950	6	0	-2	2	1	26	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.masked_columns t
38897	Compiled Plan	Adhoc	980713950	6	0	-2	2	2	26	251	0	1	1024	0	0	0	0	0	72	SELECT t.* FROM sys.masked_columns t
38906	Compiled Plan	Adhoc	572321893	6	0	-2	2	2	17	251	0	1	1024	0	0	0	0	0	66	SELECT t.* FROM sys.sysaltfiles t
39051	Compiled Plan	Adhoc	945759446	6	0	-2	2	3	6	251	0	1	1024	0	0	0	0	0	84	SELECT t.* FROM sys.dm_os_memory_brokers t
39152	Compiled Plan	Adhoc	119580090	6	0	-2	2	1	7	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.conversation_groups t
39152	Compiled Plan	Adhoc	119580090	6	0	-2	2	2	7	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.conversation_groups t
39163	Compiled Plan	Adhoc	27606069	6	0	-2	2	2	6	251	0	1	1024	0	0	0	0	0	82	SELECT t.* FROM sys.server_role_members t
39270	Compiled Plan	Adhoc	781982641	6	0	-2	2	3	9	251	0	1	1024	0	0	0	0	0	104	SELECT t.* FROM sys.dm_hadr_physical_seeding_stats t
39564	Compiled Plan	Adhoc	146479543	6	0	-2	2	1	19	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.database_mirroring_endpoints t
39564	Compiled Plan	Adhoc	146479543	6	0	-2	2	2	19	251	0	1	1024	0	0	0	0	0	100	SELECT t.* FROM sys.database_mirroring_endpoints t
39823	Compiled Plan	Adhoc	863594425	6	0	-2	2	1	14	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.server_events t
39823	Compiled Plan	Adhoc	863594425	6	0	-2	2	1	14	251	0	1	1024	0	0	0	0	0	70	SELECT t.* FROM sys.server_events t
